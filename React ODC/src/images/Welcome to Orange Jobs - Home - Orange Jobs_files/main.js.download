(function(){var c={};this.define=d;function d(e,f){c[e]=new a(f)}this.require=b;function b(e){var f=c[e];if(!f){throw new Error("Module '"+e+"' is not registered.")}return f.get()}function a(e){this.callback=e;this.module=null}a.prototype.get=function(){return this.module||(this.module=this.callback.call(window))}})();define("digital/StateManager",function(){var c=require("digital/LayoutManager");var e={};function z(I){return I.replace(/^http[s]?:\/\/[^\/]+/,"")}function i(I){return I.split(/[?#]/)[0].replace(/^http[s]?:\/\/[^\/]+/,"")}function j(I,J){if(!J){J=i(window.location.href)}if(I!=undefined){return I===J.substr(0,I.length)}else{return false}}function n(I,J){if(!J){J=i(window.location.href)}if(I!=undefined){I=i(I);return I===J.substr(0,I.length)}else{return false}}e.CONTENT_READY="digital:contentReady";e.PUSH_STATE="digital:pushState";e.POP_STATE="digital:popState";e.STATE_CHANGE="digital:stateChange";e.NEXT_PAGES_CHANGED="digital:nextPagesChanged";e.REFRESH_SOURCE="digital:refreshSource";e.DISPOSE="digital:dispose";e.APPLYSTATE="digital:applyState";var t=$(window);var F=$(document);var x,q,s;var B=false;var h={debug:false};e.init=y;function y(K){h.debug&&console.info("init");$.extend(true,h,K);k(q);var S=$("head title").text();$("#main .page").attr("data-title",S.replace(/[^A-zÀ-ÿ\_\-\ \&\/\']+/g,""));var J=D();var T=z(location.href);var N=c.getAvailableLayout();var P=N&&N.name==="MobileLayout";if(P&&J.length>1){var O=_.find(J,function(V){return n(V.url,T)},this);J=_.first(J,_.indexOf(J,O)+1)}if(Modernizr.history){var I=history.state?history.state:[];if(I.length>0){var U=false,M;J=_.filter(J,function(V){if(U){return true}if(V.url===T.substr(-V.url.length)){return U=true}return false})}I=I.concat(J);return o(I)}else{var L=(window.location.hash||"").replace(/^(#)/,"");if(L){var R=f(L);return p(R.url,R.pagesBefore,R.pagesBefore.length>0)}else{return o(J)}}}e.pushState=v;function v(K,N,J){if(_.indexOf(["self","after"],N)<0){N="root"}if(J===undefined){J=null}h.debug&&console.info("pushState(",K,N,J,")");if(B){return Q.reject("Impossible de charger du contenu tant que le précédent chargement n'est pas terminé.")}var L=[];if(N!=="root"){var I=D();$.each(I,function(O,P){if(N==="self"&&J===P.url){return false}L.push(P);if(N==="after"&&J===P.url){return false}})}t.trigger(e.PUSH_STATE,[J]);if(Modernizr.history){history.pushState(L,null,K);return p(K,L,N==="after").fail(function(O){console.error(O&&O.stack?O.stack:O)})}else{var M=b(L,K);window.location.hash=M;return Q.resolve()}}var a="|";function b(K,I){var L=[];var J=0;var M=K.length;for(;J<M;J++){L.push(K[J].url)}L.push(I);L=L.join(a);L=LZString.compressToBase64(L);return L}function f(J){var K={pagesBefore:[],url:false};J=LZString.decompressFromBase64(J);J=J||"";J=J.split(a);K.url=J.pop();var I=0;var L=J.length;for(;I<L;I++){K.pagesBefore.push({url:J[I]})}return K}e.popState=r;function r(){h.debug&&console.info("popState()");if(B){return Q.reject("Impossible de charger du contenu tant que le précédent chargement n'est pas terminé.")}var K=D();var I=K.pop();if(K.length<1){return Q.reject("Impossible remonter plus haut.")}var J=K.slice(-1)[0];history.pushState(K.slice(0,-1),null,J.url);t.trigger(e.POP_STATE,[K.slice(0)]);return o(K)}F.ready(u);function u(){x=$("body");q=$("#head");s=$("#main")}function C(I){h.debug&&console.info("window_popStateHander()");G();var J=I.originalEvent.state||[];p(z(location.href),J,J.length>0).fail(function(K){console.error(K&&K.stack?K.stack:K)})}function G(){var J=x.scrollLeft();var I=function(){x.scrollLeft(J)};t.on("scroll",I);setTimeout(function(){I();t.off("scroll",I)},1)}function E(I){h.debug&&console.info("window_hashChangeHander()");var J=(window.location.hash||"").replace(/^(#)/,"");var K=f(J);p(K.url,K.pagesBefore,K.pagesBefore.length>0)}if(Modernizr.history){t.on("popstate",C)}else{t.on("hashchange",E)}function p(J,I,K){K=!!K;h.debug&&console.info("loadAndApplyState(",J,I,K,")");B=true;return l(J,K?true:false,K?true:false).then(function(L){if($(document.body).data("layout")==="MobileLayout"){var M=0,O=L.length,N;for(;M<O;M++){N=L[M];if(J==N.url){L=L.slice(0,M+1);break}}}I=I.concat(L);return o(I)}).fin(function(L){B=false})}function o(I){h.debug&&console.info("applyState(",I,")");B=true;return A(I).then(w).then(m).then(d).fin(function(J){t.trigger(e.APPLYSTATE);B=false})}function A(L){h.debug&&console.info("applyState_makeDiff(",L,")");var K=D(true);var N=null;var J=0;var I=false;var M=true;$.each(L,function(O,P){N=K.length>J?K[J]:null;if(M&&N&&N.url===P.url){L[O]=N;if(P.source){N.$element.trigger(e.REFRESH_SOURCE,[P.source])}J++;I=true}else{if(I){M=false}}});return Q.resolve(L)}function w(I){h.debug&&console.info("applyState_loadPages(",I,")");var J=[];$.each(I,function(K,L){if(!L.$element&&L.source){L.$element=$(L.source)}if(!L.$element||L.$element.is(":empty")){J.push(H(L))}});return Q.all(J).then(function(){return I})}function m(M){h.debug&&console.info("applyState_updateDom(",M,")");var L=s.find("> .page");var I=null;var K;$.each(M,function(N,O){K=O.$element;if($.inArray(K.get(0),L)>=0){L=L.not(K)}else{if(I){K.insertAfter(I)}else{K.prependTo(s)}}I=K});try{$.each(M,function(N,O){k(O.$element)})}catch(J){console.error(J&&J.stack?J.stack:J)}try{L.trigger(e.DISPOSE)}catch(J){console.error(J)}L.remove();return Q.resolve(M)}function d(K){h.debug&&console.info("applyState_notifyChange()");var J=_.last(K);if(J&&J.title){document.title=$("<div></div>").html(J.title).text()}var I=K.slice(0).reverse();$.each(I,function(L,M){M.$element.trigger(e.NEXT_PAGES_CHANGED,[I.slice(0,L)])});q.trigger(e.NEXT_PAGES_CHANGED,[I.slice(0)]);t.trigger(e.STATE_CHANGE,[K.slice(0)]);return Q.resolve(K)}function H(I){h.debug&&console.info("loadStatePage(",I,")");return l(I.url,true).then(function(J){if(J.length<1){throw new Error("L'url '"+I.url+"' ne contient pas d'élement de page correspondant à extraire.")}I.$element=J[0].$element;return I})}function l(I,L,J){if(L!==true){L=false}if(J!==true){J=false}h.debug&&console.info("loadPage(",I,L,J,")");var K=Q.defer();$.ajax({url:I,type:"get",dataType:"text"}).done(function(O,P,N){var M=g(O,L?I:null,J);if(M.length>0){K.resolve(M)}else{K.reject("L'url '"+I+"' ne contient aucun élement de page à extraire.")}}).fail(function(N,R,P){var O=N.responseText;var M=g(O);if(M.length>0){K.resolve(M)}else{K.reject("Erreur durant le chargement de la page '"+I+'".')}});return K.promise}function g(I,X,V){if(X===undefined){X=null}if(V!==true){V=false}h.debug&&console.info("parseStateFromSource(",I.length,X,V,")");var J=[];var Z=z(window.location.href);var W=/<title>([\w\W]*?)<\/title>/i;var U=I.match(W);U=U?U[1]:"";var R=/<!--\[digital\.langs-->[\s\n\r]*([\w\W]*?)[\s\n\r]*<!--digital\.langs\]-->/gi;var L=I.match(R);if(L!=undefined&&L.length>0){$("#langs").html(L[0])}var T=/<!--\[digital\.page-->[\s\n\r]*([\w\W]*?)[\s\n\r]*<!--digital\.page\]-->/gi;var S=/<!--\[digital\.page-->[\s\n\r]*([\w\W]*?)[\s\n\r]*<!--digital\.page\]-->/i;var O=I.match(T);if(O){var N=0;var K=O.length;var Y,P,M;for(;N<K;N++){I=O[N];Y=I.match(S);if(Y){P=$(Y[1]);P.attr("data-title",U);M=P.data("url");if(!X||X==M||(V&&J.length)){J.push({url:M,title:U,source:Y[1],isCurrent:j(M,Z),$element:P})}}}}return J}e.getCurrentState=D;function D(K,I){if(K!==true){K=false}h.debug&&console.info("getCurrentState(",K,")");var M=[];var N=z(window.location.href);var J,L;s.find("> .page").each(function(P,O){J=$(O);L={url:J.data("url")};L.isCurrent=j(L.url,N);if(K){L.$element=J;L.title=J.data("title")}M.push(L);if(I&&I===L.url){return false}});return M}function k(I){if(I.length>1){I.each(function(J,K){k($(K))});return}if(I.data("__digital_contentInitialized")!==true){t.trigger(e.CONTENT_READY,[I.get(0)]);I.data("__digital_contentInitialized",true)}}return e});define("digital.StyleSheetManager",function(){var d={};var b={};d.add=c;function c(f){if(window.dontLoadCss){return Q.resolve()}if(!f){return Q.reject("Aucune feuille de style précisé.")}var g=b[f];if(g){g.get(0).disabled=false;return Q.resolve(g.get(0))}var e=Q.defer();b[f]=g=$("<link>",{rel:"stylesheet",href:f,media:"screen"}).on("load",function(){e.resolve(g.get(0))}).on("error",function(){delete(b[f]);e.reject("Erreur durant le chargement de la feuille de style '"+f+'".')}).appendTo("head");return e.promise}d.remove=a;function a(e){if(window.dontLoadCss){return Q.resolve()}console.log("StyleSheetManager.remove(",e,")");var f=b[e];if(f){f.get(0).disabled=true}return Q.resolve(f?f.get(0):null)}return d});define("digital/LayoutManager",function(){var a=function(){this._layouts=[];this._currentLayout=null;this._switchingLayout=false;this._started=false;this.$window=$(window)};$.extend(a,{CHANGE:"layout:change"});$.extend(a.prototype,{_resizeHandler:function(){this.invalidate()},start:function(){if(this._started){return Q.reject()}this._started=true;this.$window.on("resize",$.proxy(this._resizeHandler,this));return this.invalidate()},stop:function(){},setLayouts:function(b){this._layouts=b},getAvailableLayout:function(){var b=null;$.each(this._layouts,function(c,d){if(d.isAvailable()){b=d;return false}});return b},invalidate:function(){if(this._switchingLayout){return Q.resolve()}var c=this._currentLayout;var d=this.getAvailableLayout();if(c!==d){this._currentLayout=d;this._switchingLayout=true;var b=this;if(d&&!c){return d.activate().then(function(){b._switchingLayout=false;$(document.body).addClass(d.bodyClass).data("layout",d.name).trigger(a.CHANGE,[d.name])}).fail(function(e){console.error(e.stack?e.stack:e)})}else{if(d&&c){return c.deactivate().then(function(){$(document.body).removeClass(c.bodyClass);return d.activate()}).then(function(){b._switchingLayout=false;$(document.body).addClass(d.bodyClass).data("layout",d.name).trigger(a.CHANGE,[d.name])}).fail(function(e){console.error(e.stack?e.stack:e)})}else{if(c){return c.deactivate().then(function(){b._switchingLayout=false;$(document.body).removeClass(c.bodyClass).data("layout",null).trigger(a.CHANGE,[null])}).fail(function(e){console.error(e.stack?e.stack:e)})}}}}return Q.resolve()}});return new a()});define("digital/layouts/HorizontalLayout",function(){var e=require("digital.StyleSheetManager");var d=require("digital/StateManager");var b=function(i){this.options=_.defaults({},i,{leftWidth:60,rightWidth:40})};$.extend(b.prototype,{name:"HorizontalLayout",bodyClass:"lyt-ho",cssUrl:window.DIGITAL_CSS_URL.replace(/\/$/g,"")+"/dgt-layout-horizontal.css",cssUrlBrand:window.DIGITAL_CSS_URL.replace(/\/$/g,"")+"/"+window.DIGITAL_CSS_BRAND_PREFIX+"layout-horizontal.css",isAvailable:function(){return $(window).width()>860},activate:function(){this.scroll=new h(this);this.arrows=new f(this);this.head=new a(this);this.menu=new c(this);var i=this;return Q.all([e.add(this.cssUrl),e.add(this.cssUrlBrand),]).then(function(){i.scroll.activate();i.arrows.activate();i.head.activate();i.menu.activate()})},deactivate:function(){this.scroll.deactivate();this.arrows.deactivate();this.head.deactivate();this.menu.deactivate();this.scroll=null;this.arrows=null;this.head=null;this.menu=null;this.menuOverlay=null;return Q.all([e.remove(this.cssUrl),e.remove(this.cssUrlBrand),])}});var h=function(i){this.layout=i};$.extend(h.prototype,{activate:function(){this._scrollTarget=-1;this.$window=$(window);this.$scroller=$("html,body")},deactivate:function(){this.$scroller.stop(true)},to:function(n,m){if(m===undefined){m=600}if(n===this._scrollTarget){return}var k=0;var i=this.maxScrollLeft();var l=this.scrollLeft();if(n<k){n=k}if(n>i){n=i}if(n===l){this.$scroller.stop(true);return}this._scrollTarget=n;var j=this;this.$scroller.stop(true).animate({scrollLeft:this._scrollTarget},m,function(){j._scrollTarget=-1})},scrollLeft:function(){return this.$window.scrollLeft()},maxScrollLeft:function(){return this.documentWidth()-this.$window.width()},documentWidth:function(){var j=0;var m=[document.width,document.body.scrollWidth,document.documentElement.scrollWidth];var k=0;var o=m.length;var l;for(k;k<o;k++){l=parseInt(m[k]);if(l>j){j=l}}return j}});var a=function(i){this.layout=i;this._stateChangeHandler=_.debounce(this._stateChangeHandler)};$.extend(a.prototype,{activate:function(){this._headIsCollapsed=false;this.$window=$(window);this.$body=$(document.body);this.$head=$("#head");this.$main=$("#main");this.$menu=this.$head.find(".dgt-menu");this.menu=this.$menu.data("DigitalMenuController");window.__HorizontalLayout_preventNextAutoScroll=false;this.$head.find("a").on("click",$.proxy(this._linkClickHandler,this));this.$window.on("digital:pushState",$.proxy(this._pushStateHandler,this));this.$window.on("digital:stateChange",$.proxy(this._stateChangeHandler,this));this.$window.on("scroll",$.proxy(this._scrollPageHandler,this));this.$head.on("digital:nextPagesChanged",$.proxy(this._nextPagesChangedHandler,this));var i=this;setTimeout(function(){var j=d.getCurrentState(true);i.$head.addClass("animate");i._nextPagesChangedHandler(null,j);i._stateChangeHandler(null,j)},100)},deactivate:function(){this.$head.find("a").off("click",$.proxy(this._linkClickHandler,this));this.$window.off("digital:pushState",$.proxy(this._pushStateHandler,this));this.$window.off("digital:stateChange",$.proxy(this._stateChangeHandler,this));this.$head.off("digital:nextPagesChanged",$.proxy(this._nextPagesChangedHandler,this));this.$window.off("scroll",$.proxy(this._scrollPageHandler,this))},_linkClickHandler:function(i){},_pushStateHandler:function(i,j){},_stateChangeHandler:function(D,r){if(!r||!r.length){return}if(r.length>1){this.collapseFixedHeader()}else{$(window).scrollTop(0);this.expandFixedHeader()}if(window.__HorizontalLayout_preventNextAutoScroll){window.__HorizontalLayout_preventNextAutoScroll=false;return}var s=false;r=_.filter(r,function(i){return i.isCurrent?(s=true):!s},this);var u=_.first(r);var t=u.$element.offset().left;var I=this.layout.scroll.scrollLeft()+this.layout.options.leftWidth;var y=this.$window.width()-this.layout.options.leftWidth-this.layout.options.rightWidth;var F,j;var H=[];var G=0;_.each(r,function(i){H.push(i.$element.offset().left);if(i.$element.is(".is-home-page")){G++}if(i.$element.is(":has(.dgt-cover)")){H.push(i.$element.find(".dgt-section-body").offset().left);i.$element.find(".dgt-submenu").each(function(n,J){H.push($(J).offset().left)})}if(i.$element.is(":has(.has-form-left)")){H.push(i.$element.find(".dgt-list-items").offset().left)}},this);if(G&&G===r.length){this.layout.scroll.to(0);return}if(r.length==1){F=t;j=m(u.$element)}else{if(r.length>=2){var v=r[r.length-1];var o=m(v.$element);var z=r[r.length-2];var p,C;if(z.$element.is(":has(.dgt-cover)")){if(z.$element.is(":has(.dgt-submenu)")){var q=z.$element.find(".dgt-submenu").last();p=q.offset().left;C=q.outerWidth()}else{var x=z.$element.find(".dgt-section-body");p=x.offset().left;C=x.outerWidth()}}else{if(z.$element.is(":has(.has-form-left)")){var k=z.$element.find(".dgt-list-items");p=k.offset().left;C=k.outerWidth()}else{p=z.$element.offset().left;C=m(z.$element)}}F=p;j=C+o}}if(F+j>I+y){var E=0;var A=H.length;var l=0;var B,w;for(;E<A;E++){B=H[E];w=F-B;if(w<0){break}l=B;if(w+j<y){break}}this.layout.scroll.to(l-this.layout.options.leftWidth)}else{if(F<I){this.layout.scroll.to(F-this.layout.options.leftWidth)}else{if(r.length>1&&I<t){this.layout.scroll.to(t-this.layout.options.leftWidth)}}}function m(i){var J=0;var K,n;i.find(".section").each(function(L,M){K=$(M);if(K.is(":has(.dgt-content .dgt-section-body)")){J+=K.find(".dgt-content .dgt-section-body").outerWidth()}else{J+=K.outerWidth()}});return J}},_scrollPageHandler:function(i){var j=d.getCurrentState(true);if($(i.currentTarget).scrollTop()>0){this.collapseFixedHeader()}else{if(j&&j.length===1){this.expandFixedHeader()}}},_nextPagesChangedHandler:function(i,j){},isCollapsed:function(){return this._isCollapsed},collapseFixedHeader:function(){this.$body.addClass("has-collapsed-header")},expandFixedHeader:function(){this.$body.removeClass("has-collapsed-header")},expand:function(){if(!this._isCollapsed){return}this._isCollapsed=false;this.$head.removeClass("is-collapsed");this.$head.find("#root").off("click",$.proxy(this.expand,this));this.$head.trigger("digital:expand");this.menu.openCurrentState()},collapse:function(){if(this._isCollapsed){return}this._isCollapsed=true;this.$head.addClass("is-collapsed");this.$head.find("#root").on("click",$.proxy(this.expand,this));this.$head.trigger("digital:collapse");this.menu.closeAll()}});var g=function(i){this.layout=i};$.extend(g.prototype,{activate:function(){this._isOpened=false;this._isAnimating=false;this.$window=$(window);this.$body=$(document.body);this.$head=$("#head");this.$menu=this.$head.find(".dgt-menu");this.menu=this.$menu.data("DigitalMenuController");this.$overlay=$('<div id="overlay"></div>');this.$menu.on("submenuOpened",$.proxy(this._menu_submenuOpenHandler,this));this.$menu.on("allSubmenuClosed",$.proxy(this._menu_allSubmenuClosedHandler,this));this.$overlay.on("click",$.proxy(this._overlay_clickHandler,this));this.$window.on("digital:pushState",$.proxy(this._pushStateHandler,this))},deactivate:function(){this.$overlay.detach();this.$menu.off("submenuOpened",$.proxy(this._menu_submenuOpenHandler,this));this.$menu.off("allSubmenuClosed",$.proxy(this._menu_allSubmenuClosedHandler,this));this.$overlay.off("click",$.proxy(this._overlay_clickHandler,this));this.$window.off("digital:pushState",$.proxy(this._pushStateHandler,this))},_overlay_clickHandler:function(i){i.preventDefault();i.stopPropagation();this.hide();this.menu.openCurrentState()},_menu_submenuOpenHandler:function(){this.show();if(this.menu.isWalking){var j=this.menu.$sections.last();var i=j.find(".menu a:eq(0)");i.click()}},_menu_allSubmenuClosedHandler:function(){this.hide()},_pushStateHandler:function(){this.hide()},show:function(){return;if(this._isAnimating||this._isOpened){return}this._isAnimating=true;this._isOpened=true;this.$overlay.addClass("oj-enter").appendTo(this.$body);var i=this;setTimeout(function(){i.$overlay.addClass("oj-enter-active");setTimeout(function(){i.$overlay.removeClass("oj-enter oj-enter-active");i._isAnimating=false},350)},10)},hide:function(){return;if(this._isAnimating||!this._isOpened){return}this._isAnimating=true;this.$overlay.addClass("oj-leave");var i=this;setTimeout(function(){i.$overlay.addClass("oj-leave-active");setTimeout(function(){i.$overlay.detach().removeClass("oj-leave oj-leave-active");i._isOpened=false;i._isAnimating=false},350)},10)}});var c=function(i){this.layout=i};$.extend(c.prototype,{activate:function(){this.$window=$(window);this.$head=$("#head");this.$menu=this.$head.find(".dgt-menu");this.$menuSection=this.$menu.closest(".section");this.menu=this.$menu.data("DigitalMenuController");this.$window.on("scroll",$.proxy(this._scrollHandler,this))},deactivate:function(){this.$window.off("scroll",$.proxy(this._scrollHandler,this));this.$menuSection.add(this.menu.$sections.get()).off("click",$.proxy(this._sectionOverflow_clickHandler,this))},_scrollHandler:function(){var m=this.layout.scroll.scrollLeft();var o=_.union(this.$menuSection.get(),this.menu.$sections.get());var k=0;var j,n,i,l;_.each(o,function(q,p){j=$(q);n=j.outerWidth();i=m>k;l=m>k+n*0.5;if(q.__lytHo_isOverflow!==i){q.__lytHo_isOverflow=i;j.toggleClass("is-overflow",q.__lytHo_isOverflow);if(q.__lytHo_isOverflow){j.on("click",$.proxy(this._sectionOverflow_clickHandler,this))}else{j.off("click",$.proxy(this._sectionOverflow_clickHandler,this))}}if(q.__lytHo_isHalfOverflow!==l){q.__lytHo_isHalfOverflow=l;j.toggleClass("is-half-overflow",q.__lytHo_isHalfOverflow)}k+=n},this)},_sectionOverflow_clickHandler:function(){this.layout.scroll.to(0)}});var f=function(i){this.layout=i};$.extend(f.prototype,{activate:function(){this._leftIsVisible=false;this._rightIsVisible=true;this.$window=$(window);this.$body=$(document.body);this.$head=$("#head");this.$main=$("#main");this.$right=$('<div id="right" class="is-visible"></div>').appendTo(this.$head);this.$leftLogo=$('<a href="'+$("#logo").find("a").attr("href")+'" title="'+$("#logo").find("a").html()+'" id="left-logo"></a>').appendTo(this.$head);this.$leftArrow=$('<a href="#" title="Scroll Left" id="left-arrow"></a>').appendTo(this.$head);this.$leftToggle=$('<a href="#" title="Menu Left" id="left-toggle"></a>').appendTo(this.$head);this.$leftBackgd=$('<a href="#" title="Left" id="left-backgd"></a>').appendTo(this.$head);this.$scrollOverlay=$('<div id="scroll-overlay"></div>');this.$head.on("digital:expand",$.proxy(this.hideLeft,this));this.$head.on("digital:collapse",$.proxy(this.showLeft,this));this.$head.on("digital:nextPagesChanged",$.proxy(this._invalidateArrowsHandler,this));this.$window.on("scroll resize",$.proxy(this._invalidateArrowsHandler,this));this.$leftToggle.on("click",$.proxy(this._menuButtonClickHandler,this));this.$leftBackgd.on("click",$.proxy(this._prevButtonClickHandler,this));this.$leftArrow.on("click",$.proxy(this._prevButtonClickHandler,this));this.$right.on("click",$.proxy(this._nextButtonClickHandler,this));this._invalidateArrowsHandler()},deactivate:function(){this.$right.remove();this.$leftLogo.remove();this.$leftArrow.remove();this.$leftToggle.remove();this.$leftBackgd.remove();this.$scrollOverlay.remove();this.$head.off("digital:expand",$.proxy(this.hideLeft,this));this.$head.off("digital:collapse",$.proxy(this.showLeft,this));this.$head.off("digital:nextPagesChanged",$.proxy(this._invalidateArrowsHandler,this));this.$window.off("scroll resize",$.proxy(this._invalidateArrowsHandler,this))},_menuButtonClickHandler:function(i){i.preventDefault();i.stopPropagation();this.gotoMenu()},_prevButtonClickHandler:function(i){i.preventDefault();i.stopPropagation();this.gotoPrevPage()},_nextButtonClickHandler:function(i){i.preventDefault();i.stopPropagation();this.addScrollOverlay();this.layout.scroll.to(this.layout.scroll.scrollLeft()+this.$window.width()*0.6)},_invalidateArrowsHandler:function(j){if(!this.layout.scroll){return}var l=this.layout.scroll.scrollLeft();var k=this.layout.scroll.maxScrollLeft();var i=this.$main.find(".page:last-child .dgt-content:not(.is-overflow)").length>0;if(l<k-5&&!i){this.showRight()}else{this.hideRight()}},showLeft:function(){if(this._leftIsVisible){return}this._leftIsVisible=true},hideLeft:function(){if(!this._leftIsVisible||this.layout.head.isCollapsed()){return}this._leftIsVisible=false},showRight:function(){if(this._rightIsVisible){return}this._rightIsVisible=true;this.$right.addClass("is-visible")},hideRight:function(){if(!this._rightIsVisible){return}this._rightIsVisible=false;this.$right.removeClass("is-visible")},gotoMenu:function(){this.layout.scroll.to(0)},gotoPrevPage:function(){var m=this.layout.scroll.scrollLeft();if(m<=0){this.gotoMenu()}else{var l=this.$main.find(".page:not(:has(.section-cover))");l=$(l.get().reverse());var i=0;var j,k;_.find(l.get(),function(n){j=$(n);k=j.offset().left-this.layout.options.leftWidth;if(k<m){i=k;return true}},this);this.layout.scroll.to(i)}},addScrollOverlay:function(){var l=this.layout.scroll.scrollLeft();var k=this.$window.width();var j=this.layout.scroll.documentWidth();var i=this.$scrollOverlay;i.css({width:(j-k-l)+"px",marginLeft:l+k});i.removeClass("oj-leave oj-leave-active");i.appendTo(this.$body);setTimeout(function(){i.addClass("oj-leave");setTimeout(function(){i.addClass("oj-leave-active");setTimeout(function(){i.removeClass("oj-leave oj-leave-active").detach()},350)},1)},600)}});return b});define("digital/layouts/MobileLayout",function(){var f=require("digital.StyleSheetManager");var e=require("digital/StateManager");var c=function(){};$.extend(c.prototype,{name:"MobileLayout",bodyClass:"lyt-mo",cssUrl:window.DIGITAL_CSS_URL+"/dgt-layout-mobile.css",cssUrlBrand:window.DIGITAL_CSS_URL+"/"+window.DIGITAL_CSS_BRAND_PREFIX+"layout-mobile.css",isAvailable:function(){return $(window).width()<=860},activate:function(){this.mead=new b();this.pages=new a();var g=this;return Q.all([f.add(this.cssUrl),f.add(this.cssUrlBrand),]).then(function(){g.mead.activate();g.pages.activate()})},deactivate:function(){this.mead.deactivate();this.pages.deactivate();this.mead=null;this.pages=null;return Q.all([f.remove(this.cssUrl),f.remove(this.cssUrlBrand),])}});var d='<div id="mead"><a href="#" class="close"></a><a href="#" class="back"></a><a href="#" class="icon"></a><a href="#" class="logo"></a><a href="#" class="toggle"></a></div>';var b=function(){};$.extend(b.prototype,{isOpened:false,currentState:[],activate:function(){this.$window=$(window);this.$body=$(document.body);this.$head=$("#head");this.$headLogo=this.$head.find("#logo a");this.$menu=this.$head.find(".dgt-menu");this.menu=this.$menu.data("DigitalMenuController");this.$main=$("#main");this.$mead=$(d);this.$mead.find(".logo").text(this.$headLogo.text());this.$mead.prependTo(this.$body);this.$mead.find(".close").on("click",$.proxy(this._closeClickHandler,this));this.$mead.find(".back").on("click",$.proxy(this._backClickHandler,this));this.$mead.find(".icon").on("click",$.proxy(this._iconClickHandler,this));this.$mead.find(".logo").on("click",$.proxy(this._logoClickHandler,this));this.$mead.find(".toggle").on("click",$.proxy(this._toggleClickHandler,this));this.$window.on("digital:stateChange",$.proxy(this._stateChangeHandler,this));this.$menu.on("submenuOpened submenuClosed",$.proxy(this._menuChangeHandler,this));this.$main.on("click",$.proxy(this.main_clickHandler,this));this._stateChangeHandler(null,e.getCurrentState(true))},deactivate:function(){this.$mead.remove();this.$main.off("click",$.proxy(this.main_clickHandler,this));this.$menu.off("submenuOpened submenuClosed",$.proxy(this._menuChangeHandler,this));this.$window.off("digital:stateChange",$.proxy(this._stateChangeHandler,this))},closeMenu:function(){if(!this.isOpened){return}this.menu.closeAll();this.menu.setWalkingMode(false);this.isOpened=false;this.invalidate()},openMenu:function(g){if(g!==false){g=true}if(this.isOpened){return}if(g){this.menu.openCurrentState()}this.isOpened=true;this.invalidate()},toggleMenu:function(g){this.isOpened?this.closeMenu():this.openMenu(g)},invalidate:function(){this.$body.toggleClass("mobile-menu-opened",this.isOpened);var g=false;if(this.isOpened){g=this.menu.$sections.length>0}else{if(this.currentState.length>1){g=true}else{if(this.pageMenu){g=this.pageMenu.$sections.length>0}}}this.$mead.toggleClass("has-back",g)},_stateChangeHandler:function(h,i){this.currentState=i;if(this.$pageMenu){this.$pageMenu.off("submenuOpened submenuClosed",$.proxy(this._pageMenuChangeHandler,this))}this.$pageMenu=this.pageMenu=null;var g=$(this.currentState).get(-1);if(g){this.$pageMenu=g.$element.find(".dgt-menu");this.pageMenu=this.$pageMenu.data("DigitalMenuController");this.$pageMenu.on("submenuOpened submenuClosed",$.proxy(this._pageMenuChangeHandler,this))}this.isOpened?this.closeMenu():this.invalidate()},_menuChangeHandler:function(g){if(this.isOpened){this.invalidate()}this.$head.scrollTop(0)},_pageMenuChangeHandler:function(g){$("html,body").scrollTop(0);if(!this.isOpened){this.invalidate()}},_iconClickHandler:function(g){g.preventDefault();g.stopPropagation();this.toggleMenu(false)},_logoClickHandler:function(g){g.preventDefault();g.stopPropagation();this.$headLogo.click()},_toggleClickHandler:function(g){g.preventDefault();g.stopPropagation();this.toggleMenu();if(this.isOpened){this.menu.closeAll()}},main_clickHandler:function(g){if(this.isOpened){this.toggleMenu(false);g.preventDefault();g.stopPropagation()}},_backClickHandler:function(h){h.preventDefault();h.stopPropagation();if(this.isOpened){this.menu.closeLastSubmenu();this.invalidate()}else{var j=e.getCurrentState(true);var i=j.pop();if(i){var g=i.$element.find(".dgt-menu");if(g.length>0){var k=g.data("DigitalMenuController");if(k.closeLastSubmenu()){return}}}if(this.currentState.length>1){e.popState()}else{this.openMenu(true)}}},_closeClickHandler:function(g){g.preventDefault();g.stopPropagation();history.back()}});var a=function(){};$.extend(a.prototype,{currentState:null,currentStateIndex:-1,activate:function(){this.$window=$(window);this.$scroller=$("html, body");this.$main=$("#main");this.$head=$("#head");this.$window.on("digital:stateChange",$.proxy(this.stateChangeHandler,this));this.stateChangeHandler(null,e.getCurrentState(true))},deactivate:function(){this.$main.find(".page.is-mobile-hidden").removeClass("is-mobile-hidden");this.$head.off("click",$.proxy(this.prevClickHandler,this));this.$window.off("digital:stateChange",$.proxy(this.stateChangeHandler,this))},stateChangeHandler:function(g,j){this.$scroller.scrollTop(0);this.currentState=j;if(!j||!j.length){return}var i=j.slice(-1)[0];i.$element.removeClass("is-mobile-hidden");var h;_.each(j.slice(0,-1),function(k){k.$element.addClass("is-mobile-hidden")},this)}});return c});define("digital.Navigation",function(){var c=require("digital/StateManager");$(window).on(c.CONTENT_READY,a);function a(e,d){$(d).find(".dgt-nav").digitalNav()}$.fn.digitalNav=function(){this.each(function(d,e){new b(e)})};function b(d){this.$nav=$(d).addClass("dgt-nav");if(this.$nav.data("__digital_navInitialized")===true){return}this.$nav.data("__digital_navInitialized",true);this.$page=this.$nav.closest(".page, #head");this.pageUrl=!this.$page.is("#head")?this.$page.data("url"):null;this.$nav.on("itemsChanged",$.proxy(this.itemsChangedHandler,this));this.$page.on(c.NEXT_PAGES_CHANGED,$.proxy(this._nextPagesChangedHandler,this))}b.prototype._nextPagesChangedHandler=function(f,d){var e;this.nextPages=d;this.updateSelection()};b.prototype.updateSelection=function(){var d,e=this.$nav.find("a");$.each(this.nextPages,$.proxy(function(f,g){d=e.filter('[href$="'+g.url+'"]');if(d.length>0){d.addClass("current");return false}else{d=null}},this));e.not(d).removeClass("current");d&&this.bubbleSelection(d)};b.prototype.bubbleSelection=function(e){var d=e.closest("ul");var f=d.prev("a");if(f.length>0){f.addClass("current");this.bubbleSelection(f)}}});define("digital.ListForm",function(){var a=require("digital/StateManager");$(window).on(a.CONTENT_READY,function(d,c){$(c).find(".dgt-list:has(.dgt-list-form)").each(function(e,f){new b(f)})});function b(){this.initialize.apply(this,arguments)}$.extend(b.prototype,{initialize:function(d){this.uid=_.uniqueId("digital-");this.list=d;this.$list=$(d);this.$page=this.$list.closest(".page,#head");this.$page.on("digital:dispose",$.proxy(this.dispose,this));this.params=this.$list.data("digital-list-params");if(!this.params){this.$list.data("digital-list-params",this.params={})}this.$form=this.$list.find(".dgt-list-form");this.$filters=this.$list.find(".dgt-list-filters");this.$list.find(".dgt-list-filters").replaceWith(this.$filters);this.$filtersOverlay=this.$filters.find(".overlay");this.$filtersToggle=this.$filters.find(".toggle");this.$itemsWrap=this.$list.find(".dgt-list-items");this.isFormOnLeft=!this.$form.closest(".dgt-list-filters").length;this.defaultFormPosition=this.isFormOnLeft?"left":"filters";this.$list.toggleClass("has-form-left",this.isFormOnLeft);this.$filtersToggle.on("click",$.proxy(this.toggleOverlay,this));if(!this.$list.hasClass("dgt-list-mosaic")&&!this.$list.hasClass("dgt-list-search")&&this.$list.hasClass("has-form-left")){this.$form.on("change",":radio,:checkbox,input[type=text],select",$.proxy(this.form_submitHandler,this));if(!this.$form.hasClass("js-no-autocomplete")){this.$form.find(":radio,:checkbox,input[type=text],select").first().trigger("change")}}else{this.$form.on("submit",$.proxy(this.form_submitHandler,this))}var c=$(document.body);c.on("layout:change."+this.uid,$.proxy(this.invalidateLayout,this));this.invalidateLayout(null,c.data("layout"));this.list=this.$list.data("dgt-list");if(this.list){this.listReady()}else{this.$list.on("dgt-list",$.proxy(this.listReady,this))}},listReady:function(){this.list=this.$list.data("dgt-list");this.$form.trigger("submit")},dispose:function(){var c="."+this.uid;$(document.body).off(c)},invalidateLayout:function(d,c){if(!c){return}this.isMobile=c==="MobileLayout";this.invalidatePosition()},invalidatePosition:function(){if(this.defaultFormPosition=="left"){var c=!this.isMobile;if(c===this.isFormOnLeft){return}this.isFormOnLeft=c;if(this.isFormOnLeft){this.$form.prependTo(this.$list);this.$list.addClass("has-form-left")}else{this.$form.appendTo(this.$filtersOverlay);this.$list.removeClass("has-form-left")}}},toggleOverlay:function(c){c&&c.preventDefault();this.$filters.toggleClass("is-opened")},form_submitHandler:function(c){c.preventDefault();this.jqXHR&&this.jqXHR.abort();this.jqXHR=$.ajax({type:"get",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"text",context:this});this.jqXHR.done(this.jqXHR_doneHandler);this.jqXHR.fail(this.jqXHR_failHandler);this.jqXHR.always(this.jqXHR_alwaysHandler)},jqXHR_doneHandler:function(d,e,c){this.list.parseItems(d,true);this.$filters.removeClass("is-opened")},jqXHR_failHandler:function(c,e,d){},jqXHR_alwaysHandler:function(){this.jqXHR=null}})});define("digital.SearchForm",function(){var b=require("digital/StateManager");$(window).on(b.CONTENT_READY,function(d,c){$(c).find(".section:has(.dgt-search-form)").each(function(f,e){new a(e)})});function a(){console.log("new Digital_SearchForm()");this.initialize.apply(this,arguments)}$.extend(a.prototype,{initialize:function(c){this.uid=_.uniqueId("digital-");this.search=c;this.$search=$(c);this.$page=this.$search.closest(".page,#head");this.$page.on("digital:dispose",$.proxy(this.dispose,this));this.$form=this.$search.find(".dgt-search-form");this.$details=this.$search.find(".search-form-details");this.$icon=this.$search.find(".input-fulltext .icon");this.$itemsWrap=this.$search.find(".dgt-form-list");this.$form.on("submit",$.proxy(this.form_submitHandler,this));this.$form.on("focus","input[type=text]",$.proxy(this.toggleIn,this));this.$form.on("change",":radio,:checkbox,input[type=text]",$.proxy(this.form_submitHandler,this));var d=$(document.body);d.on("layout:change."+this.uid,$.proxy(this.invalidateLayout,this));this.invalidateLayout(null,d.data("layout"));this.search=this.$form.data("dgt-search");if(this.search){this.searchReady()}else{this.$search.on("dgt-search",$.proxy(this.searchReady,this))}},searchReady:function(){this.search=this.$search.data("dgt-search");this.$form.trigger("submit")},dispose:function(){var c="."+this.uid;$(document.body).off(c)},invalidateLayout:function(d,c){if(!c){return}this.isMobile=c==="MobileLayout";this.invalidatePosition()},invalidatePosition:function(){},toggleIn:function(c){this.$form.addClass("slide-in")},form_submitHandler:function(c){this.$itemsWrap.html('<span class="icon">');c.preventDefault();this.jqXHR&&this.jqXHR.abort();this.jqXHR=$.ajax({type:"get",url:this.$form.attr("action"),data:this.$form.serialize(),dataType:"text",context:this});this.jqXHR.done(this.jqXHR_doneHandler);this.jqXHR.fail(this.jqXHR_failHandler);this.jqXHR.always(this.jqXHR_alwaysHandler)},jqXHR_doneHandler:function(d,e,c){this.$itemsWrap.html(d)},jqXHR_failHandler:function(c,e,d){},jqXHR_alwaysHandler:function(){this.jqXHR=null}})});define("digital.ListSnap",function(){var a=require("digital/StateManager");$(window).on(a.CONTENT_READY,function(d,c){$(c).find(".dgt-list").each(function(e,f){new b(f)})});var b=function(){this.initialize.apply(this,arguments)};$.extend(b.prototype,{initialize:function(c){this.uid=_.uniqueId("digital-");this.$list=$(c).data("dgt-list",this);this.$page=this.$list.closest(".page,#head");this.$section=this.$list.closest(".section").addClass("full-height");this.$page.on("digital:dispose",$.proxy(this.dispose,this));this._invalidate=this.invalidate;this.invalidate=_.debounce(this._invalidate,100);this.params=this.$list.data("digital-list-params");if(!this.params){this.$list.data("digital-list-params",this.params={})}this.$viewport=this.$list.find(".dgt-list-items");this.$viewport.on("click",".dgt-list-more a",$.proxy(this.more_clickHandler,this));this.$items=this.$viewport.find("li");this.$visibleItems=this.$items.first();this.params.totalItems=parseInt(this.$viewport.data("total-items"))||this.$items.length;this.$prevButton=this.$list.find(".dgt-list-prev, .dgt-list-navbar .prev");this.$nextButton=this.$list.find(".dgt-list-next, .dgt-list-navbar .next");this.$count=this.$list.find(".dgt-list-count");this.countDefault=this.$count.html();this.$prevCount=this.$list.find(".dgt-list-prev .count");this.$nextCount=this.$list.find(".dgt-list-next .count");this.$progress=this.$list.find(".dgt-list-navbar .progress");this.$progressThumb=this.$progress.find(".thumb");this.preventInvalidate=false;this.$prevButton.on("click",$.proxy(this.$prevButton_clickHandler,this));this.$nextButton.on("click",$.proxy(this.$nextButton_clickHandler,this));this.$list.on("visibleRangeChanged",$.proxy(this.visibleRangeChangedHandler,this));this.$list.on("totalItemsChanged",$.proxy(this.totalItemsChangedHandler,this));this.$list.on("itemsChanged",$.proxy(this.itemsChangedHandler,this));this.$viewport.on("scroll",$.proxy(this.invalidate,this));this.$viewport.on("scroll",$.proxy(this.checkMorePosition,this));$(window).on("resize."+this.uid,$.proxy(this.invalidate,this));layout=$(document.body).on("layout:change."+this.uid,$.proxy(this.invalidateLayout,this)).data("layout");this.invalidateLayout(null,layout);this.totalItemsChangedHandler();setTimeout($.proxy(this.invalidate,this),20);this.$list.trigger("dgt-list",this)},dispose:function(){$(window).off("."+this.uid);$(document.body).off("."+this.uid)},invalidateLayout:function(d,c){this.isHorizontal=c==="HorizontalLayout";if(this.isHorizontal){this.$viewport.addClass("items-visibility-on");this.$viewport.on("click","li:not(.is-visible)",$.proxy(this.outboundsItem_clickHandler,this));this.invalidate()}else{this.$viewport.removeClass("items-visibility-on");this.$viewport.off("click","li:not(.is-visible)",$.proxy(this.outboundsItem_clickHandler,this))}},visibleRangeChangedHandler:function(e){var d=this.params.totalItems;var f=this.params.firstVisibleIndex;var c=this.params.lastVisibleIndex;if(this.$progressThumb.length){this.$progressThumb.css({left:Math.min(f/(d-1)*100,95)+"%",width:Math.max((c-f)/(d-1)*100,5)+"%"})}if(this.$prevCount.length){this.$prevCount.text(f>0?"1 - "+(f+1):"")}if(this.$nextCount.length){this.$nextCount.text(c+1<d?(c+1)+" - "+d:"")}},outboundsItem_clickHandler:function(h){h.preventDefault();h.stopPropagation();var g=h.currentTarget;var e=$(g);var c=this.$viewport.offset().top;var d=this.$viewport.outerHeight();var f=e.offset().top;if(f<c+d/2){this.gotoPrevPage()}else{this.gotoNextPage()}},totalItemsChangedHandler:function(e){var d=this.params.totalItems;var f=this.params.firstVisibleIndex;var c=this.params.lastVisibleIndex;if(this.$count.length){this.$count.html(this.countDefault.replace("#",d));this.$count.removeClass(function(g,h){return(h.match(/(^|\s)count--\S+/g)||[]).join(" ")}).addClass("count--"+d)}if(this.$nextCount.length){this.$nextCount.text(c+1<d?(c+1)+" - "+d:"")}},itemsChangedHandler:function(c){this.$items=this.$viewport.find("li");this.$more=this.$items.filter(".dgt-list-more").first();if(!this.$more.length){this.$more=null}this.invalidate();this.checkMorePosition()},$prevButton_clickHandler:function(c){c.preventDefault();c.stopPropagation();this.gotoPrevPage()},$nextButton_clickHandler:function(c){c.preventDefault();c.stopPropagation();this.gotoNextPage()},checkMorePosition:function(){if(!this.$more){return}var f=this.$more.offset().top;var e=this.$viewport.offset().top;var d=this.$viewport.outerHeight();var c=this.$viewport.scrollTop();if(f<e+d+d*0.5){this.more_clickHandler()}},more_clickHandler:function(c){if(c){c.preventDefault();c.stopPropagation()}var d=this.$more.find("a");if(d.is(".is-loading")){return}d.addClass("is-loading");this.more_jqXHR=$.ajax({type:"get",url:d.attr("href"),dataType:"text",context:this});this.more_jqXHR.$more=this.$more;this.more_jqXHR.done(this.more_jqXHR_doneHandler);this.more_jqXHR.fail(this.more_jqXHR_failHandler);this.more_jqXHR.always(this.more_jqXHR_alwaysHandler)},more_jqXHR_doneHandler:function(d,e,c){d=this.parseItems(d);if(d){c.$more.closest("li").replaceWith(d.$items);this.$list.trigger("itemsChanged")}},more_jqXHR_failHandler:function(c,e,d){this.$more.removeClass("is-loading")},more_jqXHR_alwaysHandler:function(c,e,d){this.more_jqXHR=null},setItems:function(d,c){if(!d){return}if(!c){c=d.length}this.params.totalItems=c;this.$list.trigger("totalItemsChanged");this.$viewport.html(d).trigger("itemsChanged").scrollTop(0)},parseItems:function(g,f){var c=/<!--\[dgt-list-items\((\d+)\)-->[\s\n\r]*([\w\W]*?)[\s\n\r]*<!--dgt-list-items\]-->/i;var e=g.match(c);if(!e){return null}var h=$(e[2]).filter("li");var d=parseInt(e[1])||0;if(f){this.setItems(h,d)}return{$items:h,total:d}},gotoPrevPage:function(){var e=this.$visibleItems.first();if(!e.length){return}var d=e.prev();e=d.length?d:e;var f=e.offset().top;var i=e.outerHeight();var g=this.$viewport.offset().top;var h=this.$viewport.scrollTop();var c=this.$viewport.height();this.scrollTo(f-g+h-c+i)},gotoNextPage:function(){var d=this.$visibleItems.last();if(!d.length){return}var c=d.next("li");d=c.length?c:d;var e=d.offset().top;var f=this.$viewport.offset().top;var g=this.$viewport.scrollTop();this.scrollTo(e-f+g)},scrollTo:function(d){var c=this.$viewport.get(0).scrollHeight-this.$viewport.height();d=Math.min(Math.max(0,d),c);this.preventInvalidate=true;this.$viewport.stop(true).animate({scrollTop:d},400,"swing",$.proxy(function(){this.preventInvalidate=false;this.invalidate()},this))},invalidate:function(){if(this.preventInvalidate||!this.isHorizontal){return}var f=this.$viewport;var h=this.$visibleItems.eq(0);if(!h.length||$.inArray(h.get(0),this.$items)<0){h=this.$items.first()}var i=$([]);if(!h.length){this.$visibleItems=i;return}var e=f.offset().top;var c=e+this.$viewport.height();e-=2;c+=2;var d=h.offset().top;var k=d+h.outerHeight();var l=d>=e&&k<=c;var g,j;if(e<=d){g=true;while(g){j=h.prev("li");if(j.length&&e<=j.offset().top){h=j}else{g=false}}}else{if(e>d){g=true;while(g){j=h.next("li");if(j.length){h=j;if(e<=j.offset().top){g=false}}else{g=false}}}}i=h;g=true;while(g){j=h.next("li");if(j.length&&c>=j.offset().top+j.outerHeight()){h=j;i=i.add(j)}else{g=false}}this.$visibleItems.removeClass("is-visible");this.$visibleItems=i;this.$visibleItems.addClass("is-visible");this.params.firstVisibleIndex=$.inArray(this.$visibleItems.get(0),this.$items);this.params.lastVisibleIndex=$.inArray(this.$visibleItems.last().get(0),this.$items);this.$list.trigger("visibleRangeChanged")}});return b});define("digital.ListLazyLoading",function(){var c=require("digital/StateManager");$(window).on(c.CONTENT_READY,function(e,d){$(d).find(".dgt-list").each(function(f,g){new a(g)})});function b(j){var d=[];var k=/<!--\[digital\.listItems\((\d+)\)-->[\s\n\r]*([\w\W]*?)[\s\n\r]*<!--digital\.listItems\]-->/gi;var h=/<!--\[digital\.listItems\((\d+)\)-->[\s\n\r]*([\w\W]*?)[\s\n\r]*<!--digital\.listItems\]-->/i;var g=j.match(k);if(g){var e=0;var l=g.length;var f;for(;e<l;e++){j=g[e];f=j.match(h);if(f){d.push({total:parseInt(f[1]),source:f[2]})}}}return d}function a(){this.initialize.apply(this,arguments)}$.extend(a.prototype,{initialize:function(d){this.uid=_.uniqueId("digital-");this.$list=$(d);this.$page=this.$list.closest(".page,#head");this.$page.on("digital:dispose",$.proxy(this.dispose,this));this.params=this.$list.data("digital-list-params");if(!this.params){this.$list.data("digital-list-params",this.params={})}this.$itemsWrap=this.$list.find(".dgt-list-items");this.$list.on("itemsChanged",$.proxy(this.itemsChangedHandler,this));this.limit=0;setTimeout($.proxy(this.itemsChangedHandler,this))},dispose:function(){},itemsChangedHandler:function(){var d=this.$itemsWrap.find(".load-more");this.$moreLink&&this.$moreLink.off();if(d.length){this.$more=d;this.$moreLink=d.find("a").on("click",$.proxy(this.listClickHandler,this))}},listClickHandler:function(d){d.preventDefault();d.stopPropagation();this.loadItems(d.currentTarget.href)},loadItems:function(f){var d=this.$more;var e=this.$list;$.ajax({url:f,type:"get",dataType:"text"}).done(function(i,j,h){var g=b(i);if(g.length){d.replaceWith(g[0].source)}e.trigger("itemsChanged")}).fail(function(g,i,h){})}});return a});define("digital.Tabs",function(){var b=require("digital/StateManager");$(window).on(b.CONTENT_READY,function(d,c){$(c).find(".dgt-tabs").each(function(f,e){new a(e)})});var a=function(){this.initialize.apply(this,arguments)};$.extend(a.prototype,{initialize:function(d){this.uid=_.uniqueId("digital-");this.$tabs=$(d).data("dgt-tabs",this);this.tabsId=this.$tabs.data("tabs");this.$page=this.$tabs.closest(".page,#head");this.$section=this.$tabs.closest(".section").addClass("full-height");this.$page.on("digital:dispose",$.proxy(this.dispose,this));this.params=this.$tabs.data("digital-tabs-params");if(!this.params){this.$tabs.data("digital-tabs-params",this.params={})}this.$viewport=this.$tabs.find(".dgt-tabs-items");this.$items=this.$viewport.find("li");this.dontSaveTab=false;var c=this;this.$items.find("a").on("click",function(){$.proxy(c.clickOnTab,c,this)()});$(window).one("digital:stateChange."+this.uid,$.proxy(this.openSavedTab,this));this.$tabs.trigger("dgt-tabs",this)},dispose:function(){$(window).off("."+this.uid);$(document.body).off("."+this.uid)},clickOnTab:function(d){var c=$(d).data("tab");if(c&&!this.dontSaveTab){this.saveSavedTab(c)}this.dontSaveTab=false},saveSavedTab:function(c){var c=localStorage.setItem("tab-"+this.tabsId,c)},openSavedTab:function(){var c=localStorage.getItem("tab-"+this.tabsId);if(c){this.openTab(c)}},openTab:function(c){var d=this.$items.find('[data-tab="'+c+'"]');if(d.length){this.dontSaveTab=true;setTimeout(function(){d.trigger("click",[{dontAutoScroll:true}])},1)}}});return a});define("digital.Content",function(){var b=require("digital/StateManager");$(window).on(b.CONTENT_READY,function(d,c){$(c).find(".dgt-content").each(function(e,f){new a(f)})});$(window).on(b.APPLYSTATE,function(c){$("body").toggleClass("has-dgt-content",$(".dgt-content").length>0);const d=b.getCurrentState(true);$("body").toggleClass("has-multiple-pages",d.length>1)});function a(){this.initialize.apply(this,arguments)}$.extend(a.prototype,{initialize:function(d){this.uid=_.uniqueId("digital-");var c="."+this.uid;this.el=d;this.$el=$(d);this.$elBody=this.$el.find(".dgt-section-body");this.$page=this.$el.closest(".page");this.$page.on("digital:dispose"+c,$.proxy(this.dispose,this));this.$overlay=$('<div class="dgt-content-overlay"></div>');this.$overlay.appendTo(this.el);this.$overlay.on("click",function(e){e.preventDefault();$(window).trigger("digital:stateChange",[b.getCurrentState(true)])});this.$page.addClass("has-dgt-content");this.$main=$("#main");this.$window=$(window);this.$body=$(document.body);this.$body.on("layout:change"+c,$.proxy(this.invalidateLayout,this));this.invalidateLayout(null,this.$body.data("layout"))},dispose:function(){var c="."+this.uid;this.$window.off(c);this.$body.off(c);this.$page.off(c)},invalidateLayout:function(e,d){if(!d){return}var c="."+this.uid;if(d==="HorizontalLayout"){this.$window.on("scroll"+c,$.proxy(this.window_scrollHandler,this));this.$window.on("resize"+c,$.proxy(this.window_resizeHandler,this));this.$page.on("digital:nextPagesChanged"+c,$.proxy(this.invalidatePosition,this));this.invalidatePosition()}else{this.$window.off(c);this.$page.off("digital:nextPagesChanged"+c);this.$el.css("width","");this.$el.removeClass("is-overflow")}},window_scrollHandler:function(c){this.invalidatePosition()},window_resizeHandler:function(c){this.invalidatePosition()},invalidatePosition:function(){var f=this.$elBody.outerWidth();if(!f){return}var d=this.$window.width();var h=this.$window.scrollLeft();var e=this.$page.offset().left-h;var g=this.$el.offset().left-this.$page.offset().left;var c=Math.max(0,d-e)-g;c=Math.min(c,this.$main.width());this.$el.css("width",c);this.$el.toggleClass("is-overflow",c<f)},})});define("digital.Menu",function(){var c=require("digital/StateManager");var b=$(window);b.on("digital:contentReady",function(e,d){$(d).find(".dgt-menu").each(function(f,g){new a(g)})});function a(d){this.$menu=$(d);this.uid=_.uniqueId("digital-");this.$menu.data("DigitalMenuController",this);this.config={submenu:{enterDuration:400,leaveDuration:300,scrollEventOnProgress:true}};this.isWalking=false;this.$sections=$();this.$page=this.$menu.closest(".page,#head");this.$page.addClass("dgt-menuwrap");this.$section=this.$menu.closest(".section");this.$section.addClass("dgt-rootmenu");this.$submenuLinks=this.$menu.find("li:has(> ul) > a");this.$page.on("digital:dispose",$.proxy(this.dispose,this));b.on("digital:stateChange."+this.uid,$.proxy(this.stateChangeHandler,this));this.$submenuLinks.on("click",$.proxy(this.submenuLinkClickHandler,this));this.$menu.find("a").not(this.$submenuLinks).on("click",$.proxy(this.linkClickHandler,this))}$.extend(a.prototype,{dispose:function(){b.off("."+this.uid)},setWalkingMode:function(d){if(d!==false){d=true}this.isWalking=d;this.$menu.toggleClass("doing-walk",d).toggleClass("doing-nav",!d);this.$sections.find("> ul").toggleClass("doing-walk",d).toggleClass("doing-nav",!d)},stateChangeHandler:function(d){this.setWalkingMode(false);this.openCurrentState()},submenuLinkClickHandler:function(e){e.preventDefault();e.stopPropagation();var d=$(e.currentTarget);this.setWalkingMode(true);d.addClass("current-walk");d.closest("ul").find("li > a").not(d).removeClass("current-walk");d.closest("ul").find("li").removeClass("current-channel");d.closest("li").addClass("current-channel");this.openSubmenu(d.next("ul"),true,true);$("#main").find(".page3").html("");$("#main").find(".page4").html("")},linkClickHandler:function(e){var d=$(e.currentTarget);var f=d.closest(".section");this.closeSubmenu(f.nextAll(".dgt-submenu:not(.is-closed)"),true)},openSubmenu:function(e,i,f){i=i!==undefined?!!i:true;f=f!==undefined?!!f:false;var h=e.closest(".section");var g=h.next(".dgt-submenu:not(.is-closed)");if(g.length){if(g.data("__dgtMenuRelatedTo")===e.get(0)){return g.find("> :first")}g.empty();g.finish("dgtMenuEnter").finish("dgtMenuLeave");f=false;this.closeSubmenu(g.nextAll(".dgt-submenu:not(.is-closed)"))}else{g=$('<div class="section dgt-submenu"></div>');this.$sections=this.$sections.add(g)}$submenu=e.clone(true).show();$submenu.toggleClass("doing-walk",this.isWalking);$submenu.toggleClass("doing-nav",!this.isWalking);$submenu.appendTo(g);g.addClass($submenu.data("class-submenu"));g.data("__dgtMenuRelatedTo",e.get(0));g.insertAfter(h);if(this.$menu.is(".dgt-nav")){$submenu.digitalNav()}if(f){g.addClass("enter");g.animate({dgtMenu:0},{queue:"dgtMenuEnter",duration:this.config.submenu.enterDuration,start:function(){g.addClass("enter-active")},progress:this.config.submenu.scrollEventOnProgress?function(){b.trigger("scroll")}:null,complete:function(){b.trigger("scroll");g.removeClass("enter enter-active")}});setTimeout(function(){g.dequeue("dgtMenuEnter")})}i&&this.$menu.trigger("submenuOpened",g.get(0));var d=this.$sections.length;this.$page.removeClass("dgt-menuwrap-at-"+this.$page.data("dgt-menuwrap-at"));this.$page.addClass("dgt-menuwrap-at-"+d).data("dgt-menuwrap-at",d);return $submenu},closeSubmenu:function(f,e){if(!f||!f.length){return}e=e!==undefined?!!e:false;if(e){f.addClass("is-closed leave");f.animate({dgtMenu:0},{queue:"dgtMenuLeave",duration:this.config.submenu.leaveDuration,start:function(){f.addClass("leave-active")},progress:this.config.submenu.scrollEventOnProgress?function(){b.trigger("scroll")}:null,complete:function(){b.trigger("scroll");f.removeClass("leave leave-active").remove()}});setTimeout(function(){f.dequeue("dgtMenuLeave")})}else{f.remove()}this.$sections=this.$sections.not(f);var d=this.$sections.length;this.$page.removeClass("dgt-menuwrap-at-"+this.$page.data("dgt-menuwrap-at"));this.$page.addClass("dgt-menuwrap-at-"+d).data("dgt-menuwrap-at",d);this.$menu.trigger("submenuClosed");this.$sections.length<=0&&this.$menu.trigger("allSubmenuClosed")},openCurrentState:function(f){var e=!f;if(!f){f=this.$menu}var d=f.find("ul a.current:eq(0)");if(d.length){f=this.openSubmenu(d.closest("ul"));this.openCurrentState(f)}else{if(e){this.closeAll(true)}}},closeLastSubmenu:function(){if(this.$sections.length<1){return false}this.closeSubmenu(this.$sections.last());return true},closeAll:function(d){this.closeSubmenu(this.$sections,d)}});return a});(function(){$(window).on("digital:contentReady",function(c,b){$(b).find(".dgt-tiles").each(function(d,e){new a(e)})});function a(){console.log("new Digital_Tiles()");this.initialize.apply(this,arguments)}$.extend(a.prototype,{initialize:function(b){this.uid=_.uniqueId("digital-");this.view=b;this.$view=$(b);this.$wrap=this.$view.find(".dgt-tiles-body");this.$page=this.$view.closest(".page,#head");this.$page.on("digital:dispose",$.proxy(this.dispose,this));this.invalidate=_.debounce(this.invalidate,20);this.$tiles=this.$view.find(".tile");this.tileWidth=parseInt(this.$wrap.data("tile-width"))||100;this.tileHeight=parseInt(this.$wrap.data("tile-height"))||100;this.tileMargin=parseInt(this.$wrap.data("tiles-margin"))||0;this.wrapMargin=0;$(window).on("resize."+this.uid,$.proxy(this.invalidate,this));this.$view.on("tilesChanged",$.proxy(this.invalidateChildren,this));var d=$(document.body);d.on("layout:change."+this.uid,$.proxy(this.invalidateLayout,this));var c=d.data("layout");if(c){this.invalidateLayout(null,c)}},dispose:function(){var b="."+this.uid;$(window).off(b);$(document.body).off(b)},invalidateChildren:function(){this.$tiles=this.$view.find(".tile");this.invalidate()},invalidateLayout:function(c,b){this.isMobile=b==="MobileLayout";this.isHorizontal=b==="HorizontalLayout";if(!this.isHorizontal){this.$wrap.css({"margin-top":"","margin-left":"",width:""});this.$tiles.css({position:"",top:"",left:""});this.tilesPerCol=0}this.invalidate()},invalidate:function(){if(this.isHorizontal&&this.$tiles.length>0){var e=this.$page.height();var j=this.tileWidth+this.tileMargin;var g=this.tileHeight+this.tileMargin;var b=parseInt((e-this.wrapMargin*2)/g);var h=e-b*g;var d=parseInt(h/2);if(this.tilesPerCol!==b){this.tilesPerCol=b;this.$wrap.width(Math.ceil(this.$tiles.length/b)*j);var f,i,c;_.each(this.$tiles.get(),function(l,k){f=$(l);i=(k%b)*g;c=parseInt(k/b)*j;f.css({position:"absolute",top:i+"px",left:c+"px"})},this)}}this.$idclick=window.location.hash;if(this.$idclick&&this.$idclick.length>1){this.$idclick=this.$idclick.substring(1);this.$view.find("a.tile[data-id='"+this.$idclick+"']").click()}}})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".dgt-ajax").each(function(s,u){var c=$(u);var A=c.attr("id")||"";var q=c.attr("data-width")||"";var p=c.attr("data-height")||"";var f=c.attr("data-type")||"";var g=c.attr("data-url")||"";var j=c.attr("data-param")||"";var r=c.attr("data-error")||"";var z=c.attr("data-template")||"";var n=c.attr("data-selfie")||"";var h=c.attr("data-callback")||"";var k=c.data("success-event")||"";var o=(c.attr("data-cache")&&c.attr("data-cache")=="true")?true:false;var t=(c.attr("data-sessioncache")&&c.attr("data-sessioncache")=="true")?true:false;var e=c.data("data-sessioncacheid")||"";var w=c.attr("data-sessioncacheduration")||"0";var w=0;var m=parseInt(w);if((typeof(Storage)=="undefined")||(m<=0)||(e.length()==0)){t=false}else{t=true}var d=Date.now();var l=d;if(t){l-=w;var y=sessionStorage.cache.getItem(e).cachestamp;if(y){}}switch(f){case"iframe":$("<iframe />",{name:A+"iframe",id:A+"iframe",src:g,width:q,height:p,frameborder:0}).appendTo(c);break;case"json":var v=Handlebars.compile($("#"+z).html());var x=$.ajax({type:"get",url:g,data:j,dataType:"json",cache:o,success:function(C){c.html(v(C));k&&c.trigger(k);if(c.is(".dgt-list-items")){c.trigger("itemsChanged");var B=c.closest(".dgt-list");var i=B.data("digital-list-params");if(i){i.totalItems=c.find("li").length;B.trigger("totalItemsChanged")}}$(window).trigger("digital:contentReady",c)},error:function(i){if(r.length>0){c.html(r)}else{c.html(v({}));$(window).trigger("digital:contentReady",c)}}});case"updateformvalues":var x=$.ajax({type:"get",url:g,data:j,dataType:"json",cache:o,success:function(i){$.each(i.items,function(B,C){$field=c.find("#"+C.code).first();if(!$field.prop("disabled")){$field.prop("checked",C.value)}})},error:function(i){}});break;default:var x=$.ajax({type:"get",url:g,data:j,cache:o,dataType:"html",success:function(C){if(n=="yes"){c.replaceWith(C)}else{c.html(C);if(c.is(".dgt-list-items")){c.trigger("itemsChanged");var B=c.closest(".dgt-list");var i=B.data("digital-list-params");if(i){i.totalItems=c.find("li").length;B.trigger("totalItemsChanged")}}}$(window).trigger("digital:contentReady",c);k&&c.trigger(k)},error:function(i){c.html(r)}})}})})})();if(!window.console){window.console={log:function(){},info:function(){},warn:function(){},error:function(){},debug:function(){}}}(function(){require("digital.Navigation");require("digital.ListForm");require("digital.ListSnap");require("digital.ListLazyLoading");require("digital.Tabs");require("digital.Menu");require("digital.Content");var d=require("digital/StateManager");var b=require("digital/LayoutManager");var a=require("digital/layouts/HorizontalLayout");var c=require("digital/layouts/MobileLayout");b.setLayouts([new a(),new c(),]);$(document).ready(function(){var i=$(document.body);var f=$("#wrap");var e=$("#head");var h=$("#main");if(!f.length){f=$('<div id="wrap"></div>').prependTo(i);e.appendTo(f);h.appendTo(f)}var g=e.find("#menu > .menu");$urlmenu=g.data("url");if($urlmenu&&$urlmenu!=""){$.ajax({url:$urlmenu,cache:false,dataType:"html",success:function(k){g.html(k);j()},error:function(k){j()}})}else{j()}function j(){d.init().then(function(){b.start()}).fail(function(k){console.error(k&&k.stack?k.stack:k)})}})})();define("digital/PopupManager",function(){if(!$.fancybox){return}$.extend(true,$.fancybox.defaults,{padding:0,openEffect:"none",closeEffect:"none",scrollOutside:false,helpers:{overlay:{locked:false}}});var a=function(){};a.prototype.handleLink=function(h){var e=$(h);var d=e.attr("href");var c=e.data("container");var g=parseInt(e.data("width"));var b=parseInt(e.data("height"));var f=e.data("modal")||false;if(c&&c==="iframe"){if(window.location.href.indexOf("https")==0){d=d.replace(/^http\:\/\//i,"https://")}var i=$("<iframe />").attr({frameborder:0,src:d,width:g,height:b});this.openInline(i,{width:"100%",maxWidth:800,autoSize:false,autoHeight:true})}else{$.fancybox.showLoading();$.ajax({url:d,dataType:"html"}).done($.proxy(function(j){this.openInline($(j),{maxWidth:800,autoSize:false,autoHeight:true,modal:f})},this)).fail($.proxy(function(){},this))}};a.prototype.handleModale=function(b){$.fancybox.showLoading();$.ajax({url:b,dataType:"html"}).done($.proxy(function(c){if(c!="NOK"){this.openInline($(c),{maxWidth:800,autoSize:false,autoHeight:true,modal:true})}else{$.fancybox.hideLoading()}},this)).fail($.proxy(function(){},this))};a.prototype.handleHtmlContent=function(c){var b=$(c);$.fancybox.showLoading();this.openInline($(c),{maxWidth:800,autoSize:false,autoHeight:true})};a.prototype.handleVideoLink=function(f){var e=$(f);var c=e.attr("href");var i=e.data("host");var d=parseInt(e.data("width"));var g=parseInt(e.data("height"));var j=$('<div class="iframe-wrap"></div>');var h=$("<iframe />").attr({frameborder:0,src:getVideoUrl(c),width:d,height:g,allow:"autoplay; fullscreen"}).appendTo(j);var b=e.parent().find(".boxlink").children();if(b.length){j=j.get().concat(b.clone().get())}this.openInline(j,{width:"100%",maxWidth:800,autoSize:false,autoHeight:true})};a.prototype.openInline=function(c,b){$.fancybox.open($.extend({content:c,afterShow:function(){$(window).trigger("digital:contentReady",[this.inner.get(0)])}},b))};return new a()});jQuery(document).ready(function($){var StateManager=require("digital/StateManager");var PopupManager=require("digital/PopupManager");$(document.body).on("click","a",linkClickHander);function linkClickHander(event,options){var $link=$(event.currentTarget);var isMobile=$link.closest(".lyt-mo").length==1?true:false;var href=$link.attr("href")||"";var classes=$link.attr("class");var target=$link.attr("target");var dataTarget=$link.attr("data-target");var dataHeight=$link.attr("data-height")||(parseInt($(window).height()*0.9));var dataWidth=$link.attr("data-width")||Math.min(parseInt(($(window).width()*0.9)),768);var callback=$link.attr("data-callback")||null;var nocache=$link.attr("data-nocache")||false;var isNewsgangInnerLink=false;if(window.location.pathname.indexOf("/site/"==0)&&(typeof dataTarget==="undefined")){if(href.indexOf(window.location.protocol+"//"+window.location.hostname+"/site/")==0){isNewsgangInnerLink=true}}if(nocache&&nocache=="true"){var param="_="+Math.floor(Math.random()*1000000);if(href.indexOf("?")>0){href+="&"+param}else{href+="?"+param}}if(callback&&(callback!="")){eval(callback)}if($link.closest(".dgt-blank").length){target="_blank";$link.attr("target","_blank")}if(target==="_blank"){}else{if(dataTarget==="homepage"){event.preventDefault();$("#menu a.homepage:first").click()}else{if(classes==="search-preset"){}else{if(dataTarget==="inline"){event.preventDefault();if(window.AGREEMENTS_AGREEYOUTUBE){var framewidth=$link.width();var frameheight=$link.height();if(frameheight<10){frameheight=framewidth*0.57}var $iframe=$("<iframe />").attr({frameborder:0,src:getVideoUrl(href),width:framewidth,height:frameheight,allowfullscreen:true,allow:"autoplay","class":"yt_player"});$link.replaceWith($iframe)}else{PopupManager.handleModale(COOKIES_POLICIES_URL)}}else{if(dataTarget==="popup"){event.preventDefault();if($link.is(".video, .js-video, .tile")){if(AGREEMENTS_AGREEYOUTUBE){PopupManager.handleVideoLink($link)}else{PopupManager.handleModale(COOKIES_POLICIES_URL)}}else{PopupManager.handleLink($link)}}else{if(dataTarget==="zoom"){event.preventDefault();PopupManager.openInline("<div class='zoom "+classes+"'>"+$link.html()+"</div>")}else{if(dataTarget==="open"){event.preventDefault();var _w_properties="toolbar=yes,location=yes,directories=no,status=yes,menubar=yes,scrollbars=yes,resizable=yes,copyhistory=no";if(dataHeight>0){_w_properties+=",height="+dataHeight}if(dataHeight>0){_w_properties+=",width="+dataWidth}var _w=window.open(href,"openwindow",_w_properties);if(_w){_w.focus()}}else{if($link.closest(".dgt-nav").length||isNewsgangInnerLink){if(isMobile&&!window.IsMobileDevice&&$link.closest(".oj-jobslist").length&&(dataTarget==="after")){target="_blank";$link.attr("target","_blank")}else{event.preventDefault();var pageUrl=$link.closest("#head,.page").data("url");$link.addClass("is-loading");if(options&&options.dontAutoScroll){window.__HorizontalLayout_preventNextAutoScroll=true}StateManager.pushState(href,dataTarget,pageUrl).fin(function(){$link.removeClass("is-loading")})}}else{if(href==="#"){event.preventDefault()}else{}}}}}}}}}}});var digital_utils_listenTo$=function(e,a,d,b){if(b===undefined){b=this}var c="."+this.uid;a=a.split(/\s+/);a=a.join(c+" ")+c;if(!this.listenedTo$){this.listenedTo$=[]}if($.inArray(e,this.listenedTo$)<0){this.listenedTo$.push(e)}$(e).on(a,$.proxy(d,b))};(function(){$(window).on("digital:contentReady",function(c,b){$(b).find(".dgt-cover").each(function(d,e){new a(e)})});function a(){this.initialize.apply(this,arguments)}$.extend(a.prototype,{initialize:function(b){this.uid=_.uniqueId("digital-");this.view=b;this.$view=$(b);this.$page=this.$view.closest(".page,#head");this.$page.on("digital:dispose",$.proxy(this.dispose,this));this.src={mobile:this.$view.data("cover-mobile"),horizontal:this.$view.data("cover-horizontal"),horizontalBlur:this.$view.data("cover-horizontal-blur"),horizontalBack:this.$view.data("cover-horizontal-back")};this.listenTo$(document.body,"layout:change",this.invalidateLayout);this.invalidateLayout(null,$(document.body).data("layout"))},dispose:function(){var b="."+this.uid;_.each(this.listenedTo$,function(c){$(c).off(b)},this)},listenTo$:digital_utils_listenTo$,invalidateLayout:function(c,b){if(!b){return}this.$imgMobile&&this.$imgMobile.remove();this.$imgHorizontal&&this.$imgHorizontal.remove();this.$imgHorizontalBlur&&this.$imgHorizontalBlur.remove();this.$view.css({"background-image":""});if(b==="HorizontalLayout"){if(this.src.horizontal){if(!this.$imgHorizontal){this.$imgHorizontal=$('<div class="dgt-cover-photo"></div>');this.$imgHorizontal.append($('<img alt="" />').attr("src",this.src.horizontal))}this.$view.prepend(this.$imgHorizontal);if(this.src.horizontalBlur){if(!this.$imgHorizontalBlur){this.$imgHorizontalBlur=$('<div class="dgt-cover-photo dgt-cover-photo-blur"></div>');this.$imgHorizontalBlur.append($('<img alt="" />').attr("src",this.src.horizontalBlur))}this.$imgHorizontalBlur.insertAfter(this.$imgHorizontal)}}if(this.src.horizontalBack){this.$view.css({"background-image":"url("+this.src.horizontalBack+")"})}}if(b==="MobileLayout"&&this.src.mobile){if(!this.$imgMobile){this.$imgMobile=$('<div class="dgt-cover-photo"></div>');this.$imgMobile.append($('<img alt="" />').attr("src",this.src.mobile))}this.$view.prepend(this.$imgMobile)}}})})();(function(){if(Modernizr.flexbox||Modernizr.flexboxlegacy){return}$(window).on("digital:contentReady",function(c,b){$(b).find(".dgt-list, .dgt-flex").each(function(d,e){new a(e)})});function a(){console.log("new Digital_Flex()");this.initialize.apply(this,arguments)}$.extend(a.prototype,{initialize:function(b){this.uid=_.uniqueId("digital-");this.view=b;this.$view=$(b);this.$page=this.$view.closest(".page,#head");this.$page.on("digital:dispose",$.proxy(this.dispose,this));this.invalidate=_.debounce(this.invalidate,20);this.listenTo$(window,"resize layout:change",this.invalidate);this.invalidate()},dispose:function(){var b="."+this.uid;_.each(this.listenedTo$,function(c){$(c).off(b)},this)},listenTo$:digital_utils_listenTo$,invalidate:function(){var j=this.$view.height();var e=parseInt(this.$view.css("padding-top"));var h=this.$view.children(":visible");var i=e;var c=[];var f=0;var b,g;h.each(function(k,l){b=$(l);if(b.css("position")==="absolute"){return}g=b.outerHeight(false);childMarginBottom=parseInt(b.css("margin-bottom"))||0;if(b.is(".dgt-list-items, .dgt-flex-fill")){f++;c.push({$:b,size:"auto",marginBottom:childMarginBottom})}else{i+=g+childMarginBottom;c.push({$:b,size:g,marginBottom:childMarginBottom})}});var d=(j-i)/f;i=e;g=0;_.each(c,function(k){g=k.size==="auto"?d:k.size;k.$.css({height:k.size==="auto"?(g-childMarginBottom)+"px":""});i+=g+childMarginBottom},this)}})})();$(document).keyup(function(a){if(a.keyCode==27){$(".current-channel").removeClass("current-channel").find(".current-walk").first().focus();$(".current-dropdown").removeClass("current-dropdown").focus()}});document.onclick=function(a){$(".current-channel").removeClass("current-channel").find(".current-walk").first().focus();$(".current-dropdown").removeClass("current-dropdown").focus()};var OPTAGREEMENT=false;var AGREEMENTS_AGREEGA=false;var AGREEMENTS_AGREEYOUTUBE=false;var COOKIES_POLICIES_URL="/jobs/flux/policies";$.ajaxSetup({error:function(a,c,b){if(a.status===401){self.location="/jobs/logout.do"}}});(function(a){a.fn.bkValidation=function(){var e={failedClass:"validation-failed",passedClass:"validation-passed",divClass:"validation-advice",};a("."+e.divClass).remove();var d=true;for(var c=0;c<=validationRules.length-1;c++){if(a("."+validationRules[c][0]).length>0){a("."+validationRules[c][0]).each(function(h){var g=a(this);var j=g.val();if(!validationRules[c][2](j,g)){if(!g.hasClass(e.failedClass)){g.addClass(e.failedClass)}var k="advice-"+validationRules[c][0]+"-"+g.attr("id");var f=g.hasClass("form-container")?g:g.parents(".form-row").find(".field-label");f.append('<span class="'+e.divClass+'" id="'+k+'">'+validationRules[c][1]+"</span>");if(d){$section=f.closest(".dgt-content");$section.animate({scrollTop:f.offset().top,},500)}d=false;g.on("focus",function(){a("#"+k).remove()});g.on("change",function(){a("#"+k).remove()});g.on("click",function(){a("#"+k).remove()})}else{if(!g.hasClass(e.passedClass)){g.addClass(e.passedClass)}if(g.hasClass(e.failedClass)){g.removeClass(e.failedClass)}}})}}if(!d){a("."+e.divClass).on("click",function(){a(this).remove()})}if(!d){$section=a(".dgt-content");$firsterror=$section.find(".validation-failed").first();if(typeof $firsterror!=="undefined"&&typeof $firsterror.offset()!=="undefined"){var b=$firsterror.offset().top+$firsterror.height();$section.animate({scrollTop:b,},500)}}return d}})(jQuery);function simpleString(a){return a.replace(/[^A-zÀ-ÿ\_\-\ \&\/\']+/g,"")}function simpleID(a){return a.replace(/[^a-zA-Z0-9]+/g,"")}function nonHTML(a){return a.replace(/[\>\<\"]+/g," ")}function autocomplete(f,c,e,a){if($("#"+f).length==0){return}if(!a){a=1}var b="/jobs/autocomplete.do";if(e==null){e=""}else{if(typeof e=="string"){e="product="+e}}var d=$("#lang").length>0?$("#lang").html():"";if(e!=""){e+="&"}e+="lang="+d;$("body").click(function(){$("#"+f).fadeOut()});$("#"+c).keyup(function(){$("#id_"+$(this).attr("id")).val("");if($(this).val().length>=a){dataAjax=e+"&token="+$(this).val();$.ajax({url:b,contentType:"application/html;charset=UTF-8",data:dataAjax,dataType:"html",complete:function(g){},success:function(g){$("#"+f).width($("#"+c).outerWidth(false));$("#"+f).fadeIn();$("#"+f).html(g);$("#"+f).find("li").click(function(){$("#"+c).val($(this).html());getSelectionId($("#"+c),$(this));$("#"+f).fadeOut()})},error:function(g){},})}else{$("#"+f).fadeOut()}})}function localAutocomplete(e,d,c,a){if($("#"+e).length==0||!c){return}var b=c.items;if(!$.isArray(b)){return}if(!a){a=1}$("body").click(function(){$("#"+e).fadeOut()});$("#"+d).keyup(function(){$("#id_"+$(this).attr("id")).val("");if($(this).val().length>=a){var m=$(this).val().toLowerCase();var g="";var j=0;var k=false;for(var f=0;f<b.length;f++){var h=b[f];var l=h.title;if(l.toLowerCase().indexOf(m)==0){k=true;g+="<li id="+h.id+">"+l+"</li>"}else{if(k){break}}}g="<ul>"+g+"</ul>";$("#"+e).width($("#"+d).outerWidth(false));$("#"+e).fadeIn();$("#"+e).html(g);$("#"+e).find("li").click(function(){$("#"+d).val($(this).html());getSelectionId($("#"+d),$(this));$("#"+e).fadeOut()})}else{$("#"+e).fadeOut()}})}function getSelectionId(d,b){var a=$("#id_"+d.attr("id"));if(a.length>0&&b.length>0){try{a.val(b.attr("id"))}catch(c){throw c}}}jQuery.fn.exists=function(){return this&&this.length>0};function getPubLang(){return NGInfos?NGInfos.substring(0,2):"FR"}function openZoomWindow(a){var b=require("digital/PopupManager");b.handleLink(a)}function openExtWindow(b,c,a,e){var d=require("digital/PopupManager");d.handleLink(b)}function openExtModal(b,a){$.ajax({contentType:"application/html;charset=UTF-8",url:b,success:function(c){digital.utils.openPopup(c,a)},})}function openNGWindow(a){window.open(a)}function Onglets(){this.settings=new Array()}Onglets.prototype.init=function(a){this.settings=a};Onglets.prototype.getParam=function(b,a){var c=typeof this.settings[b]=="undefined"?a:this.settings[b];if(c=="true"||c=="false"){return c=="true"}return c};Onglets.prototype.Show=function(a,b){$tab_id=$("#"+a);$tab_id.siblings().removeClass("current");$tab_id.addClass("current");$panel_id=$("#"+b);$panel_id.siblings().removeClass("current");$panel_id.addClass("current")};Onglets.prototype.getAnchor=function(){var b,a=document.location.href;if((b=a.lastIndexOf("#"))!=-1){return a.substring(b+1)}return""};var Onglets=new Onglets();function expandZone(e,a,f,c){e=$("#"+e);a=$("#"+a);if(e&&a){e.toggle();var b=e.css("display")=="none"?f:c;var d=e.css("display")!="none"?"icoPlus":"icoMinus";a.html("<img src='../images2/interface/"+d+".gif'>"+b)}}function gotoSearch(a){return gotoUrl("/jobs/search.do"+(a?"?"+a:""))}function gotoProfile(){gotoUrl("/jobs/cv.do","all")}function gotoOffer(a){openExtWindow(getOfferUrl(a)+"&wmode=light")}function getOfferUrl(a){return"/jobs/offer.do?joid="+a}function addUrl(a,b){if(b&&a){a+=a.indexOf("?")==-1?"?":"&";a+=b}return a}function printUrl(a,c){a=addUrl(a,c?"wmode="+c:false);var b=window.open(a,"w_print","toolbar=yes,location=yes,directories=no,status=yes,menubar=yes,scrollbars=yes,resizable=yes,copyhistory=no");if(b){b.focus()}}function printoffer(a){if(ieVersion===9||ieVersion===8||ieVersion===7){var c=a.replace("/offer.do","/printoffer.do")+document.location.search;var b=window.open(c,"w_print","width=620px,toolbar=yes,location=yes,directories=no,status=yes,menubar=yes,scrollbars=yes,resizable=yes,copyhistory=no");if(b){b.focus()}}else{window.print()}}function gotoUrl(a,b){a=addUrl(a,b?"wmode="+b:false);if(top.opener){window.close();top.opener.location=a}else{top.location=a}}function getUrl(b){var c=self.location.host.indexOf("localhost:8080")!=-1;var a="";if(c){a="http://localhost:8080/orangecorp/jobs/"+b.requestName;if(b.action){a+=b.action}a+=".jsp"}else{a="/jobs/ajaxRequest.do";a+="?lang="+getPubLang();a+="&requestName="+b.requestName;a+="&do="+(b.action?b.action:"select");a+="&mod_out="+(b.mod_out?b.mod_out:"XHTML");if(b.params&&b.params!=""){a+="&"+b.params}}return a}function updateCheck(b){var a=$(b).parent();var c=a.find("input").first();c.click();c.prop("checked")?$(b).removeClass("cb_off").addClass("cb_on"):$(b).removeClass("cb_on").addClass("cb_off")}function updateRadio(b){var a=$(b).parent("li").parent("ul");a.find("input").each(function(){if($(this).prop("checked")){$(this).click()}});a.find("a").each(function(){$(this).removeClass("cb_on").addClass("cb_off")});updateCheck(b)}function updateCheckFromA(b){var a=$(b).parent();var c=a.find("input").first();c.prop("checked")?$(b).removeClass("cb_off").addClass("cb_on"):$(b).removeClass("cb_on").addClass("cb_off")}function checkbox(a){this.jobApp.controller.toggleCheckbox(a)}function detectQT(){if(navigator.plugins){for(i=0;i<navigator.plugins.length;i++){if(navigator.plugins[i].name.indexOf("QuickTime")>=0){return true}}}return false}(function(b){var a={init:function(c){var d=b.extend({params:"",formParams:"",formValid:true,type:"GET",formName:false,NOKredirect:"orange.jobs",},c);return this.each(function(){var e=b(this);$formName=b("#"+c.formName);if($formName.exists()){if(c.formValid&&!$formName.bkValidation()){return}c.formParams=$formName.serialize();c.type=c.type?c.type:"POST"}this.xhr=b.ajax({url:getUrl(c),data:c.formParams,dataType:c.mod_out&&c.mod_out=="JSON"?"json":"html",type:c.type,cache:isIE()?false:true,success:b.proxy(c.success?c.success:this.success,this),error:b.proxy(c.error?c.error:this.error,this),})})},success:function(d,e,c){return this.each(function(){var f=b(this);if(d&&d!="NOK"){f.html(d)}else{f.error()}})},error:function(){return this.each(function(){var c=b(this);self.location=this.NOKredirect})},};b.fn.getFlux=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}else{b.error("Method "+c+" does not exist on jQuery.tooltip")}}}})(jQuery);function initLogin(){var a="";if(document.referrer&&document.referrer.indexOf("http")==0){url=document.referrer;a=url.match(/:\/\/(.[^/]+)/)[1]}$("#session").getFlux({requestName:"Logged",mod_out:"JSON",params:"ref="+a,success:loginSuccess,})}function loginSuccess(j,d,m){var e=require("digital/PopupManager");if(j&&ojSession){ojSession=j.items[0]}if(j&&j.items&&j.items.length>0&&j.items[0].email!=""){$("body").addClass("connected");if(j.items[0].firstname&&j.items[0].firstname.length>0){$("header").find(".header_user > span").html(simpleString(j.items[0].firstname))}if(typeof j.items[0].avatar!=="undefined"){if(j.items[0].avatar.length>0){$("header").find(".header_user > img").attr("src","/images/profile/jobs-avatar-"+simpleID(j.items[0].avatar)+".svg")}}}else{$("body").removeClass("connected")}var b=window.location.hostname.indexOf("jobsmap.")>=0?false:true;var f=window.location.hostname.indexOf("jobsmap2")>=0?true:false;var c=window.location.href.indexOf("frommobi")<0&&window.location.href.indexOf("mobi.do?")<0?false:true;var g=f||c?false:true;var a=$.cookie("consent")&&$.cookie("consent")=="bypass"?true:false;var k=typeof j.items[0].agreements!=="undefined"&&j.items[0].agreements.length>0?false:true;var l=false;var n=j.items[0].agreements;for(var h=0;h<n.length;++h){if(n[h].agreement==false){l=true;break}}if(g){if(b){if(l){if(a){AGREEMENTS_AGREEGA=false;AGREEMENTS_AGREEYOUTUBE=false}else{$.removeCookie("consent",{path:"path: '/; SameSite=Strict; Secure'"});e.handleModale(COOKIES_POLICIES_URL)}}else{window.OPTAGREEMENT=true;$.removeCookie("consent",{path:"path: '/; SameSite=Strict; Secure'"});for(var h=0;h<n.length;++h){switch(n[h].code){case"AGREEGA":if(window.GAACCOUNT!=undefined&&window.GAACCOUNT.length>0){window.AGREEMENTS_AGREEGA=n[h].value;if(window.AGREEMENTS_AGREEGA==true){$(window).trigger("AgreementManager:AGREEGA",window.GAACCOUNT)}else{var o="."+window.location.hostname;$.removeCookie("__utma",{domain:o,path:"/"});$.removeCookie("__utmb",{domain:o,path:"/"});$.removeCookie("__utmc",{domain:o,path:"/"});$.removeCookie("__utmt",{domain:o,path:"/"});$.removeCookie("__utmz",{domain:o,path:"/"})}}break;case"AGREEYOUTUBE":window.AGREEMENTS_AGREEYOUTUBE=n[h].value;break}}}}else{if(window.AGREEMENTS_AGREEGA==false){window.AGREEMENTS_AGREEGA=true;$(window).trigger("AgreementManager:AGREEGA",window.GAACCOUNT)}window.AGREEMENTS_AGREEYOUTUBE=true}}}function profileElements(a){a.find(".block-profiled").each(function(g,j){var c=$(j);var h=[];var f=[];var e=[];if(c.data("profile-in")!=undefined){h=c.data("profile-in").split(",")}if(c.data("profile-out")!=undefined){f=c.data("profile-out").split(",")}var d=ojSession.profilegroupcode||null;if(d==null||d.length==0){e=["NEW"]}else{e=ojSession.profilegroupcode.split(",")}var b=true;$.each(h,function(l,k){if($.inArray(k,e)<0){b=false}});$.each(f,function(l,k){if($.inArray(k,e)>=0){b=false}});if(b){c.show()}else{c.hide()}})}function oldProfileElements(a){a.find(".profil_").each(function(c,e){var b=$(e);var d=ojSession.profilegroupcode;if(d==null||d==""){d="NEW"}if(b.hasClass("profil_"+d)){b.show()}else{b.hide()}})}function profileSuccess(b,c,a){if(b&&ojSession){ojSession=b.items[0]}profileElements($("#main"))}function homeRedirect(){if(top.opener){window.close()}top.location="/jobs/search.do"}function logout(){var a=$("<div/>");a.getFlux({requestName:"Logout",mod_out:"JSON",success:logoutSuccess,})}function logoutSuccess(b,c,a){location.reload(true)}function recommendationLogout(){$("<div/>").getFlux({requestName:"DisableRecommendation",action:"update",success:recommendationLogoutSuccess,})}function recommendationLogoutSuccess(b,c,a){homeRedirect()}function forgottenPassword(){$("#messagePasswordSent").getFlux({requestName:"Password",formName:"passwordForm",formValid:false,success:forgottenPasswordSuccess,})}function forgottenPasswordSuccess(b,c,a){$(this).show();$("#loginPasswordProcess").hide();$("#forgottenpassword").hide()}function basket_toggle(a){$("#basket_toggle").getFlux({requestName:"Basket",action:"update",params:"joid="+a,success:basket_toggle_success,})}function basket_toggle_success(e,f,c){var d="addtobasket";var a="deletefrombasket";var b=$("#basket_toggle");if(e&&e!="NOK"){if(b.hasClass(d)){b.removeClass(d).addClass(a);b.find("a").attr("title",b.data("title-delete"))}else{if(b.hasClass(a)){b.removeClass(a).addClass(d);b.find("a").attr("title",b.data("title-add"))}}}}function alert_delete(a){$("#"+a).getFlux({requestName:"Alert",action:"delete",params:"aid="+a,success:alert_delete_success,})}function alert_delete_success(b,c,a){$("#alert_list_"+this.id).remove();$(this).remove()}function alert_emulate(a){$("#"+a).click()}function alert_create(b,a){$.ajax({url:"/jobs/flux/alert/edit",type:"POST",data:b,processData:false,contentType:"application/json",success:alert_create_success,}).done(alert_create_success).fail(console.log)}function alert_create_success(b,d,a){var c=require("digital/PopupManager");console.log(b);c.handleHtmlContent(b)}function getSearchParams(){return $("#main").find(".section.jobform").find("form").serialize()}function sendfriend(a){$("#sendfriend").getFlux({requestName:"Sendfriend",action:"edit",params:"joid="+a,success:sendfriend_success,})}function sendfriend_success(b,d,a){var c=require("digital/PopupManager");c.handleHtmlContent(b)}function rss(){$("#rss").getFlux({requestName:"Rss",action:"select",success:rss_success,})}function rss_success(b,d,a){var c=require("digital/PopupManager");c.handleHtmlContent(b)}function formSubmit(a){$("#waiting").removeClass("disabled");$(".inprogress").show();$formName=$("#"+a);if($formName.bkValidation()){$("#waiting").siblings(".tobehideOLD").hide();$formName.submit()}else{$("#waiting").addClass("disabled");$(".inprogress").hide()}}function thisFormSubmit(a){$myForm=$(a);return $myForm.bkValidation()}function openWindowApplication(a,b){openZoomWindow(a,600,900,"applywindow");storeApplication(b)}function storeApplication(b){var a="/jobs/storeApplication.do";$.ajax({contentType:"application/html;charset=UTF-8",url:a,data:"id="+b,success:function(c){},})}function componentOpen(g,c){if(!g){return}var b=g.split("_");var a=b?b.length:0;var e=b[0];if(e!="LatestJob"&&$("#profileitemEmpty").exists()){$("#profileNeeded").show();return}$("#profileNeeded").hide();var f="";if(a>1){f="id="+b[1]}if(c&&c.params){if(f!=""){f+="&"}f+=c.params}var d=c&&c.action?c.action:"edit";$("#"+g).append($("#waiting").removeClass("disabled"));$("#"+g).getFlux({requestName:e,formName:"componentForm",action:d,params:f,success:componentOpenSuccess,})}function componentOpenSuccess(b,d,a){var c=require("digital/PopupManager");$("#waiting").addClass("disabled");c.handleHtmlContent(b);$(".autocomplete").each(function(){var h=$(this).attr("id");if(h){var g=h.indexOf("_choices");if(g!=-1){var e=h.substring(0,g);var f=$(this).attr("data-base");autocomplete(h,e,f?f:e,2)}}})}function modifClassRemove(){$(".modif").each(function(){$(this).removeClass("modif")})}function componentIDCreate(b,c){var a=b;if(c){a+="_"+c}return a}function componentUpdate(f,b){var d=$("<div/>").html(b);var g=d.find("div").attr("id");g=componentIDCreate(f,g);var c=$("#"+g);modifClassRemove();if(b!="NOK"){if(c.length==0){var e=$("<a/>").attr("href",'javascript:componentOpen("'+g+'");');var a=$("<div/>").attr("id",g).addClass("editButton modif").html(b);a.appendTo(e);$("#"+f+"List").append(e)}else{c.html(b);if(!c.hasClass("nomodif")){c.addClass("modif")}}}closeExtModal()}function componentRemove(a,b){b=componentIDCreate(a,b);modifClassRemove();if($("div[id='"+b+"']").length>0){$("div[id='"+b+"']").remove()}closeExtModal()}function closeExtModal(){formClose()}function formClose(){$.fancybox.close()}function formDelete(d,g,b,f){if($("#"+b).length>0&&confirm(g)){var e=$("#"+b).serialize();var a=getUrl({requestName:d,action:"delete",params:"id="+f,});if(e.indexOf("id")==-1&&f){e+="&id="+f}var c=$.ajax({url:a,type:"POST",data:e,success:function(){componentRemove(d,f)},});closeExtModal()}}function formSave(c,b){$formName=$("#"+b);if(!$formName.exists()){return}var e=$formName.bkValidation();if(e){var d=$formName.serialize();var a=getUrl({requestName:c,action:"update",params:"redirect=select",});$.ajax({type:"POST",url:a,data:d,success:function(f){componentUpdate(c,f)},error:function(f){},})}}function submitFriendEmailAddress(h,c,j,g){$formName=$("#"+h);if(!$formName.exists()){return}var f=$formName.bkValidation();if(f){var b=$formName.serialize();var a="/jobs/captchaSubmit";var d=$("label[for='ckoictzig']").parent();var e=$.ajax({type:"POST",url:a,data:b,success:function(l){if(l.length>1&&l.charAt(0)=="O"&&l.charAt(1)=="K"){var k=getUrl({requestName:"Sendfriend",action:"update",mod_out:"JSON",});$.ajax({type:"POST",url:k,data:b,success:function(m){closeExtModal()},error:function(m){closeExtModal()},})}else{d.append('<span class="validation-advice">'+g+"</span>")}},error:function(k){d.append('<span class="validation-advice">'+g+"</span>")},})}}$(document).on("keypress","input[type='text'].shownEditInPlace",function(a){if(a.keyCode==13){formSubmit2()}});function toModePub(){$(".shownEditInPlace").each(function(){$(this).hide();$("#"+$(this).attr("id")+"_pub").show();$(this).removeClass("shownEditInPlace")});$("#validation_set").hide()}function editField(f,a){toModePub();var e=$("#"+f);var d=$("#"+f+"_pub");var c=$("#validation_set");d.hide();var b=d.html().replace(/^\s+|\s+$/g,"");e.val(b.charAt(0)=="<"?"":b);e.show().addClass("shownEditInPlace");e.parent().append(c);c.show()}function formSubmit2(){var c=$(".shownEditInPlace");var e=$("#"+c.attr("id")+"_pub");var a=c.val().replace(/</g,"(").replace(/>/g,")");if(c[0].nodeName.toLowerCase()==="select"){a=c.find(":selected").text()}var d=a==""?e.attr("title"):a;var b=getUrl({requestName:"Account",action:"update"});var f=$("#accountForm").serialize();$.ajax({url:b,type:"POST",data:f,success:function(g){if(g=="OK"){e.html(d)}toModePub()},error:function(){toModePub()},})}function removeAccount(d,a){if(confirm(d)){var b="/jobs/userprofile.do?do=delete";var c=$("#accountForm").serialize();$.ajax({url:b,type:"POST",data:c,dataType:"html",success:function(e){if(e=="OK"){gotoSearch()}else{alert("pb")}},})}}function validateRemoveAccount(d,a){if(confirm(d)){var b="/jobs/userprofile.do?do=validatedelete";var c=$("#removeaccountForm").serialize();$.ajax({url:b,type:"POST",data:c,dataType:"html",success:function(e){if(e=="OK"){alert(a);gotoSearch()}else{alert("pb")}},})}}function sharePage(d,a,e){var c="";a=self.location.protocol+"//"+self.location.host+escape(a);switch(d.toLowerCase()){case"twitter":c="https://twitter.com/intent/tweet?url="+a;break;case"facebook":c="http://www.facebook.com/sharer.php?u="+a;break;case"linkedin":c="http://www.linkedin.com/shareArticle?mini=true&url="+a;break}if(c!=""){var b=window.open(c,"w_share","toolbar=yes,location=yes,directories=no,status=yes,menubar=yes,scrollbars=yes,resizable=yes,copyhistory=no");if(b){b.focus()}}}function searchfieldblur(b,a){$search=$(b);if($search.val()==""){$search.val(a)}$search.parent().removeClass("focus")}function searchfieldfocus(b,a){$search=$(b);if($search.val()==a){$search.val("")}$search.parent().addClass("focus")}function submitsomething(b,a){$search=$(b).find("#s");if($search.val()==a){$search.val("")}}function faqquestion(a){window.location=window.location+"&faqsubjectid="+a}function faqquestion_success(b,c,a){digital.utils.openPopup(b)}function submitFaqSubject(b,a){$formName=$("#"+b);if(!$formName.exists()){return}var c=$formName.bkValidation();if(c){if($formName.find('[name*="faqsubjectid"]').val()){subject=$formName.find('[name*="faqsubjectid"]').val();if(subject=="0"){alert(a)}else{faqquestion(subject)}}else{alert(a)}}}function submitFaqQuestion(h,c,j,g){$formName=$("#"+h);if(!$formName.exists()){return}var f=$formName.bkValidation();if(f){var b=$formName.serialize();var a="/jobs/captchaSubmit";var d=$("label[for='ckoictzig']").parent();var e=$.ajax({type:"POST",url:a,data:b,success:function(k){if(k.length>1&&k.charAt(0)=="O"&&k.charAt(1)=="K"){$formName.submit()}else{d.append('<span class="validation-advice">'+g+"</span>")}},error:function(k){d.append('<span class="validation-advice">'+g+"</span>")},})}}function myalert(a){if(self.location.href.indexOf("debug=true")!=-1){alert(a)}}function isIE(){if(this._isIE!==undefined){return this._isIE}return(this._isIE=navigator.appName=="Microsoft Internet Explorer")}var ieVersion=(function(){var a=navigator.userAgent.match(/MSIE ([0-9]{1,}[\.0-9]{0,})/i);if(a!==null){return parseFloat(a[1])}return 0})();function menuInit(){this.$menu=$("#menu");var a=this.$menu.find("a.callmenu").attr("href");if(a){$menu.addClass("loading").find(".dgt-nav").load(a)}}function mapInit(){if($("#jobmap").length){}}(function(a){a.fn.bkSlider=function(b){var c={duration:400,maxWidthMultiplier:1.5,};if(b){a.extend(c,b)}return this.each(function(){var h=a(this);var y=a("<div></div>").addClass("slider slider-on").css({"z-index":"1",overflow:"hidden",position:"relative",});var f=a("<div></div>").addClass("slides").css({position:"absolute",top:"0",left:"0",width:"100%",height:"100%",}).appendTo(y);var v=a('<span><span class="icon"></span></span>').addClass("prev").appendTo(y).click(o);var e=a('<span><span class="icon"></span></span>').addClass("next").appendTo(y).click(r);var x=h.find("li > img"),l=x.length,B=0;var t=a(x.get(0)).clone().addClass("bounds").css({visibility:"hidden","z-index":"1",}).prependTo(y);if(c.maxWidthMultiplier>0){y.css("max-width",parseInt(t.attr("width"))*c.maxWidthMultiplier+"px")}x.each(function(D,E){var C=a(E).css({"z-index":"1",position:"absolute",top:"0",left:D*100+"%",width:"100%",height:"100%",}).appendTo(f)});function r(F){var D=y.width(),C=f.position().left,G=Math.round(C/D)*100,E=Math.max(Math.min(0,G-100),w);j(E)}function o(F){var D=y.width(),C=f.position().left,G=Math.round(C/D)*100,E=Math.max(Math.min(0,G+100),w);j(E)}function j(C){f.stop(true).animate({left:C+"%"},c.duration)}function m(){f.stop(true).animate({left:"-"+B*100+"%"},c.duration)}var w=-(l-1)*100,u,A=false,q=-1,s=0,d=0,p=false;function g(C){p=C.touches.length==1;if(p){A=false;u=C.touches[0].pageX;s=y.width();d=parseInt(f.css("left"))}else{f.css({left:d+"%",})}}function z(D){if(p){D.preventDefault();D.stopPropagation();A=true;q=D.touches[0].pageX;var C=d+((q-u)/s)*100;if(C>0){C*=0.2}if(C<w){C=w+(C-w)*0.2}f.css("left",C+"%")}}function n(D){if(p&&A){var C=parseInt(f.css("left"))/100;f.stop(true).animate({left:Math.max(Math.min(0,Math.round(C)*100),w)+"%",})}}var k=y[0];if(k.addEventListener){k.addEventListener("touchstart",g,false);k.addEventListener("touchmove",z,false);k.addEventListener("touchend",n,false);k.addEventListener("touchcancel",n,false)}h.replaceWith(y)})}})(jQuery);jQuery.fn.highlight=function(b){function a(e,j){var l=0;if(e.nodeType==3){var k=e.data.toUpperCase().indexOf(j);if(k>=0){var h=document.createElement("span");h.className="highlight";var f=e.splitText(k);var c=f.splitText(j.length);var d=f.cloneNode(true);h.appendChild(d);f.parentNode.replaceChild(h,f);l=1}}else{if(e.nodeType==1&&e.childNodes&&!/(script|style)/i.test(e.tagName)){for(var g=0;g<e.childNodes.length;++g){g+=a(e.childNodes[g],j)}}}return l}return this.length&&b&&b.length?this.each(function(){a(this,b.toUpperCase())}):this};jQuery.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;with(this.parentNode){replaceChild(this.firstChild,this);normalize()}}).end()};$(window).on("initHideOverflow",function(){$(this).find(".dgt-hide-overflow").children().each(function(a,b){if($(b).visible(true)){$(b).show()}else{$(b).hide()}})});function submitJoinus(b){$myform=$(b);var c=$myform.attr("action");var f=$myform.serialize();var h=$myform.data("successmessage")||"";var g=$myform.data("errormessage")||"";function d(){$.ajax({type:"POST",url:c,data:f,dataType:"json",success:function(m){var l=m.status||"";if(l=="OK"){$myform.html("<div class='form-ok-message'>"+h+"</div>")}else{if(l=="NOK"){if(m.errorMsg!=""){g=m.errorMsg}$myform.find(".form-error-message").remove();$myform.prepend("<div class='form-error-message'>"+g+"</div>")}}},error:function(l){$myform.html("<div class='form-error-message'>"+g+"</div>")},})}if($myform.bkValidation()){if($myform.data("ckoictzig")){var e=$myform.data("ckoictzig");var k=$myform.data("errormessageckoictzig");var a=k+" ("+$myform.find('[name*="ckoictzig"]').val()+")";var j=$.ajax({type:"POST",url:e,data:f,success:function(l){if(l.length>1&&l.charAt(0)=="O"&&l.charAt(1)=="K"){d()}else{$myform.find(".form-error-message").remove();$myform.prepend("<div class='form-error-message'>"+a+"</div>")}},error:function(l){$myform.find(".form-error-message").remove();$myform.prepend("<div class='form-error-message'>"+a+"</div>")},})}else{d()}}return false}function isascii(d){var b=d.length;var c=[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g,},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g,},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g,},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g,},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g,},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g,},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g,},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g,},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g,},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g,},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g,},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g,},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g,},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g,},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g,},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g,},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g,},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g,},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g,},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g,},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g,},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g,},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g,},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g,},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g,},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g,},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g,},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g,},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g,},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g,},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g,},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g,},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g,},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g,},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g,},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g,},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g,},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g,},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g,},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g,},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g,},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g,},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g,},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g,},];for(var a=0;a<c.length;a++){d=d.replace(c[a].letters,c[a].base)}d=d.replace(/[^a-z0-9+]+/gi,"");return b==0||d.length>0}function westernOnly(a){a.find('input[type="text"].validate-required').each(function(b,c){$elem.value(removeDiacritics($elem.value))})}function callRest(a,b){$node=this.$node;if(!a){return}if(!b){b="GET"}$.ajax({type:b,url:a,success:function(c){if(c.status=="OK"){updateRels($node)}},error:function(c){},})}function updateRels(node){node.find(".dgt-ajax").each(function(i,elem){var $elem=$(elem);var url=$elem.attr("data-url")||"";var param=$elem.attr("data-param")||"";var error=$elem.attr("data-error")||"";var cache=eval($elem.attr("data-cache"))||false;var ajaxRequest=$.ajax({type:"get",url:url,data:param,cache:cache,dataType:"html",success:function(request){$elem.html(request)},error:function(request){$elem.html(error)},})})}function clCookies(){var e=new Date();e.setTime(e.getTime()+180*60*1000);var f=document.cookie.split(";");var d={};for(var c=0;c<f.length;c++){var g=f[c].split("=");var a=$.trim(g[0]);var b=$.trim(g[1]);if(a.indexOf("questionnaire")==0){$.cookie(a,b,{path:"/",expires:e})}}}(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){module.exports=a(require("jquery"))}else{a(jQuery)}}})(function(f){var a=/\+/g;function d(j){return b.raw?j:encodeURIComponent(j)}function g(j){return b.raw?j:decodeURIComponent(j)}function h(j){return d(b.json?JSON.stringify(j):String(j))}function c(j){if(j.indexOf('"')===0){j=j.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")}try{j=decodeURIComponent(j.replace(a," "));return b.json?JSON.parse(j):j}catch(k){}}function e(k,j){var l=b.raw?k:c(k);return f.isFunction(j)?j(l):l}var b=(f.cookie=function(q,p,v){if(arguments.length>1&&!f.isFunction(p)){v=f.extend({},b.defaults,v);if(typeof v.expires==="number"){var r=v.expires,u=(v.expires=new Date());u.setMilliseconds(u.getMilliseconds()+r*86400000)}return(document.cookie=[d(q),"=",h(p),v.expires?"; expires="+v.expires.toUTCString():"",v.path?"; path="+v.path:"",v.domain?"; domain="+v.domain:"",v.secure?"; secure":"",].join(""))}var w=q?undefined:{},s=document.cookie?document.cookie.split("; "):[],o=0,m=s.length;for(;o<m;o++){var n=s[o].split("="),j=g(n.shift()),k=n.join("=");if(q===j){w=e(k,p);break}if(!q&&(k=e(k))!==undefined){w[j]=k}}return w});b.defaults={};f.removeCookie=function(k,j){f.cookie(k,"",f.extend({},j,{expires:-1}));return!f.cookie(k)}});function getParameterByName(b,a){if(!a){a=window.location.href}b=b.replace(/[\[\]]/g,"\\$&");var d=new RegExp("[?&]"+b+"(=([^&#]*)|&|#|$)"),c=d.exec(a);if(!c){return null}if(!c[2]){return""}return decodeURIComponent(c[2].replace(/\+/g," "))}function getVideoUrl(a){if(window.location.href.indexOf("https")==0){a=a.replace(/^http\:\/\//i,"https://")}if(a.indexOf("://dai.ly")>0){return a.replace(/\/dai\.ly\//i,"/www.dailymotion.com/embed/video/")}if(a.indexOf("://www.dailymotion.com/video/")>0){return a.replace(/\/video\//i,"/embed/video/")}if(a.indexOf("://youtu.be")>0||a.indexOf("://www.youtube.com")>0||a.indexOf("://youtube.com")>0){var c=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/;var b=a.match(c);if(b&&b[7].length==11){return"https://www.youtube.com/embed/"+b[7]+"?autoplay=1&rel=0"}}else{return a}}window.mobileCheck=function(){var a=false;(function(b){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,4))){a=true}})(navigator.userAgent||navigator.vendor||window.opera);return a};window.IsMobileDevice=mobileCheck();var ojSession={};if(window.location.pathname.indexOf("/app/")){$("body").addClass("app")}if(getParameterByName("frommobi")){$("html").addClass("nomenu")}(function(){$(window).on("digital:stateChange",function(b,a){var f=_.last(a);if(f){var g=f.$element;var c=g.data("url");var e=((typeof _gaq!="undefined")&&(c!=null));if(e){var h=g.data("site")||false;var l=g.data("channel")||false;var k=g.data("subject")||false;var d=g.data("chapter")||false;var i=g.data("alias")||false;if(h){_gaq.push(["_setCustomVar",1,"ga_w",h,3])}if(l){_gaq.push(["_setCustomVar",2,"ga_c",l,3])}if(k){_gaq.push(["_setCustomVar",3,"ga_s",k,3])}if(d){_gaq.push(["_setCustomVar",4,"ga_r",d,3])}if(i){_gaq.push(["_setCustomVar",5,"ga_p",i,3])}_gaq.push(["_trackPageview"],c)}var j=((typeof _paq!="undefined")&&(c!=null));if(j){var h=g.data("site")||false;var l=g.data("channel")||false;var k=g.data("subject")||false;var d=g.data("chapter")||false;var i=g.data("alias")||false;if(h){_paq.push(["setCustomVariable",1,"ga_w",h,"page"])}if(l){_paq.push(["setCustomVariable",2,"ga_c",l,"page"])}if(k){_paq.push(["setCustomVariable",3,"ga_s",k,"page"])}if(d){_paq.push(["setCustomVariable",4,"ga_r",d,"page"])}if(i){_paq.push(["setCustomVariable",5,"ga_p",i,"page"])}if(c){_paq.push(["setCustomUrl",c])}_paq.push(["trackPageView"])}}});$(window).on("digital:stateChange",function(e,g){var f=_.last(g);if(f){var b=f.$element;var a=b.data("url");var d=((typeof window.intrametrics!="undefined")&&(a!=null));if(d){var c=b.data("title")||"";var h="//collecteur-imc.si.francetelecom.fr/cgi-bin/witbe_tag.pl?wc="+intrametrics+"&tag="+intrametrics+"&Rdm="+Math.random()+"&Referrer=&NomSite=Jobsmap&Page="+escape(c)+"&Rubrique="+escape("jobsmap");b.append('<img class="intrametrics" src="'+h+'" width="1" height="1" />')}}});$(window).on("digital:contentReady",function(b,a){var c=$(a);c.on("mouseup","a",function(e){var h=(typeof _gaq!="undefined");var j=$(this);var f=j.attr("href");if(!f||f==""||f.indexOf("javascript")!=-1||f[0]=="#"){return}var k=f.toLowerCase();var d=false;var m=false;var n=location.host;if(k.length>=6&&k.substr(0,6)=="mailto"){d="Mail";m=f.substring(7)}if(k.length>=4&&k.substr(0,4)=="http"){var g=document.domain.replace("www.","");if(k.indexOf(g)==-1){d="External";m=f}if((j.hasClass("video"))||j.hasClass("tile")){d="Video";m=f}var l=k.match(/(?:pdf|xls|doc|ppt|eps|vsd|csv|zip|rar)($|\&)/);if(l){d="Documents"}if(l){m=k;var i=m.lastIndexOf("/");if(i!=-1){m=m.substring(0,i);i=m.lastIndexOf("/");m=m.substring(i+1)}}else{if(!d){d="link"}m=f}if(d){if(h){_gaq.push(["_trackEvent",d,m])}}}});c.find('[data-track="social"]').each(function(e,d){var f=(typeof _gaq!="undefined");$(d).on("click",function(){if(f){_gaq.push(["_trackSocial",$(d).data("track-code"),"share"])}})})})})();(function(){$(window).on("digital:contentReady",function(b,a){if($(a).find("#session:not(.connected)").length){initLogin()}})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find("#tools .dropdown > a").each(function(c,d){$elem=$(d);$drop=$elem.closest(".dropdown");$elem.on("click",function(f){f.preventDefault();f.stopPropagation();$drop.toggleClass("current-dropdown")})})})})();$(window).on("AgreementManager:AGREEGA",function(b,c){var d=document.createElement("script");d.type="text/javascript";d.async=true;d.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)});(function(){$(window).on("digital:contentReady",function(b,a){$(a).find("a.js-consent-button").each(function(c,d){$elem=$(d);$currenttogglebox=$elem.closest(".js-consent-boxes");if(window.OPTAGREEMENT){$currenttogglebox.find(".bypass-button-container").remove()}$elem.on("click",function(f){f.preventDefault();f.stopPropagation();$currenttogglebox.find(".js-consent-box").each(function(e,g){$(g).toggleClass("js-consent-box-hide")});$.fancybox.update()})});$(a).find(".js-consent-all-submit").each(function(c,d){$elem=$(d);$form=$elem.closest("form");$elem.on("click",function(f){f.preventDefault();f.stopPropagation();window.OPTAGREEMENT=true;$.removeCookie("consent",{path:"/"});$form.find("input:checkbox").prop("checked",true);$form.submit();if(window.AGREEMENTS_AGREEGA==false){$(window).trigger("AgreementManager:AGREEGA",window.GAACCOUNT);setTimeout(function(){var i=$("body").find(".page").last();var h=i.data("url");var m=((typeof _gaq!="undefined")&&(h!=null));if(m){var g=i.data("site")||false;var k=i.data("channel")||false;var j=i.data("subject")||false;var e=i.data("chapter")||false;var l=i.data("alias")||false;if(g){_gaq.push(["_setCustomVar",1,"ga_w",g,3])}if(k){_gaq.push(["_setCustomVar",2,"ga_c",k,3])}if(j){_gaq.push(["_setCustomVar",3,"ga_s",j,3])}if(e){_gaq.push(["_setCustomVar",4,"ga_r",e,3])}if(l){_gaq.push(["_setCustomVar",5,"ga_p",l,3])}_gaq.push(["_trackPageview"],h)}},100)}window.AGREEMENTS_AGREEGA=true;window.AGREEMENTS_AGREEYOUTUBE=true;$.fancybox.close()})});$(a).find(".js-consent-bypass-button").each(function(c,d){$elem=$(d);$elem.on("click",function(f){f.preventDefault();f.stopPropagation();$.cookie("consent","bypass",{expires:7,path:"/; SameSite=Strict; Secure"});window.AGREEMENTS_AGREEGA=false;window.AGREEMENTS_AGREEYOUTUBE=false;$.fancybox.close()})});$(a).find(".js-consent-submit").each(function(c,d){$elem=$(d);$form=$elem.closest("form");$elem.on("click",function(f){f.preventDefault();f.stopPropagation();window.OPTAGREEMENT=true;$.removeCookie("consent",{path:"/"});$form.submit();setTimeout(function(){location.reload()},800)})})})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".profileComponent").each(function(e,d){var c=$(d);if(c.find("#profileitemEmpty").length){c.removeClass("hasTitle")}else{c.addClass("hasTitle")}})})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find("#quest_window").each(function(d,c){init_questionnaire($(c))})})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find("#menu").each(function(d,f){if($(f).find("a.callmenu").length){var c=$(f).find("a.callmenu").attr("href");var e=$(f).find("ul.dgt-menu li").eq(0);e.load(c)}})})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".ajaxform").each(function(c,d){$(d).submit(function(k){k.preventDefault();k.stopPropagation();var h=k.attr("action");var l=k.serialize();var g=true;if(k.bkValidation()){if(k.data("ckoictzig")&&k.data("ckoictzig").length()){var f=k.data("ckoictzig");var j=k.data("errormessageckoictzig");var m=j+" ("+$myform.find('[name*="ckoictzig"]').val()+")";var i=$.ajax({type:"POST",url:f,data:l,success:function(e){if(e.length>1&&e.charAt(0)=="O"&&e.charAt(1)=="K"){}else{alert(m);g=false}},error:function(e){g=false;alert(m)}})}if(g){$.ajax({type:"POST",url:h,data:l,success:function(e){closeExtModal()},error:function(e){closeExtModal()}})}}})})})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".dgt-disclose").each(function(c,d){$elem=$(d);$button=$elem.find(".dgt-disclose-button").first();$disclose=$elem.find(".dgt-disclose-value").first();$value=$elem.find(".dgt-disclose-value input").first();$link=$button.find("a").first();$url=$link.data("url");$before=$elem.find(".dgt-disclose-before").first();$after=$elem.find(".dgt-disclose-after").first();$link.one("click",function(g){$link.addClass("button-disabled").removeClass("button-orange");g.preventDefault();g.stopPropagation();var f=$.ajax({contentType:"application/json;charset=UTF-8",url:$url,data:"",success:function(e){if(e.status="OK"){$button.remove();$before.hide();$after.show();$value.val(e.items[0]);$disclose.show()}else{$elem.html(e.errorMgs)}},error:function(e){$elem.html(e.errorMgs)}})})})})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".dgt-list .dgt-section-body, .dgt-tiles .dgt-section-body").each(function(c,d){$elem=$(d);$elem.find(".block").each(function(e,f){$(f).contents().unwrap()});$elem.contents().unwrap()});$(a).find(".dgt-flex .dgt-section-body").each(function(c,d){$(d).contents().unwrap()})})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".dgt-tabs-head").each(function(d,e){$elem=$(e);var c=true;$elem.find("a").each(function(g,h){var h=$(h);if($("#"+h.data("id")).length){var j=$("#"+h.data("id")).eq(0);var f=h.closest("li");if(c){j.show();f.addClass("selected");c=false}h.click(function(){j.siblings().hide();j.show();f.siblings("li").removeClass("selected");f.addClass("selected")})}})})})})();(function(){$(window).on("digital:contentReady",function(b,a){if($(a).find(".twitter-component").length){if(window.twttr){window.twttr.widgets.load()}}})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".video-auto").each(function(d,e){console.log("video:");$elem=$(e);var c=window.location.hash;console.log("hash:"+c);if(c&&c.length>1){c=c.substring(1);console.log("hash2:"+c);$elem.closest("ul").find("a.video[data-id='"+c+"']").click()}return false})})})();(function(){$(window).on("digital:contentReady",function(e,d){var c=$(d);c.find(".alert-map").each(function(f,g){new b(g)})});var a={log:function(){},info:function(){},warn:function(){},error:function(){},debug:function(){}};var b=function(){a.log("new Dgt_MapAlertContainer()");this.initialize.apply(this,arguments)};$.extend(b.prototype,{initialize:function(c){this.uid=_.uniqueId("digital-");this.$view=$(c).data("Dgt_MapAlertContainer",this);this.$zoom=this.$view.data("zoom")||13;this.$latmin=this.$view.attr("data-latmin");this.$latmax=this.$view.attr("data-latmax");this.$lngmin=this.$view.attr("data-lngmin");this.$lngmax=this.$view.attr("data-lngmax");var e=L.latLng(this.$latmin,this.$lngmin);var f=L.latLng(this.$latmax,this.$lngmax);var g=L.latLngBounds(f,e);if(window.OSMSELECTED){var d={zoom:1,center:new L.LatLng(0,0),attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',};var h=new L.Map(this.$view.get(0),d);setTimeout(function(){h.invalidateSize();L.rectangle(g,{color:"#ff7800",weight:1}).addTo(h);h.fitBounds(g)},500);L.tileLayer(window.MAPSTILEURL,{}).addTo(h)}},dispose:function(){$(document.body).off("."+this.uid)},})})();(function(){$(window).on("digital:contentReady",function(e,d){var c=$(d);c.find(".map-container").each(function(f,g){new b(g)})});var a={log:function(){},info:function(){},warn:function(){},error:function(){},debug:function(){}};var b=function(){a.log("new Dgt_MapContainer()");this.initialize.apply(this,arguments)};$.extend(b.prototype,{initialize:function(c){this.uid=_.uniqueId("digital-");this.$view=$(c).data("Dgt_MapContainer",this);this.$lat=this.$view.data("lat")||0;this.$lng=this.$view.data("lng")||0;this.$zoom=this.$view.data("zoom")||13;if(window.OSMSELECTED){var d={zoom:this.$zoom,minZoom:this.$zoom,maxZoom:this.$zoom,zoomControl:false,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',center:new L.LatLng(this.$lat,this.$lng),scrollWheelZoom:false};var e=new L.Map(this.$view.get(0),d);setTimeout(function(){e.invalidateSize()},500);L.tileLayer(window.MAPSTILEURL,{}).addTo(e)}},dispose:function(){$(document.body).off("."+this.uid)},})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".maproute").each(function(k,h){var e=$(h);var f=e.find("#mapcontent")[0];var m=e.data("lat");var o=e.data("lng");var q;var d;var c=false;if(window.BINGMAPSSELECTED){var g={credentials:window.BING_MAPS_KEY,mapTypeId:Microsoft.Maps.MapTypeId.road,zoom:15,center:new Microsoft.Maps.Location(m,o)};var d=new Microsoft.Maps.Map(f,g);d.entities.clear();var l=new Microsoft.Maps.Pushpin(d.getCenter(),null);d.entities.push(l);Microsoft.Maps.loadModule("Microsoft.Maps.Directions")}else{if(window.OSMSELECTED){var g={zoom:15,minZoom:1,maxZoom:16,zoomControl:false,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',center:new L.LatLng(m,o),};var d=new L.Map(f,g);L.tileLayer(window.MAPSTILEURL,{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(d);new L.Control.Zoom({position:"bottomleft"}).addTo(d);var j=L.marker([m,o],{icon:L.divIcon({className:"orange-jobs-marker",iconAnchor:[13,13],iconSize:[26,26]}),opacity:1}).addTo(d)}else{var p=new google.maps.DirectionsService();q=new google.maps.DirectionsRenderer();c=new google.maps.LatLng(m,o);var g={zoom:17,minZoom:1,maxZoom:21,mapTypeControl:false,panControl:false,streetViewControl:false,center:c,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"administrative.province",elementType:"geometry",stylers:[{visibility:"off"}]}],};d=new google.maps.Map(f,g);q.setMap(d);var j=new google.maps.Marker({map:d,position:c,draggable:false,clickable:false,icon:"../images2/map/1mini-goutte.png",width:36,height:35})}}$("#showroute").click(function(){n()});$("#getdirections").submit(function(){n();return false});function n(){var w=e.find("#directionsStart")[0].value;var r=e.find("#directionsStop")[0].value;if(window.BINGMAPSSELECTED){var v=new Microsoft.Maps.Directions.DirectionsManager(d);v.clearDisplay();v.clearAll();v.setRequestOptions({distanceUnit:Microsoft.Maps.Directions.DistanceUnit.kilometers,routeMode:Microsoft.Maps.Directions.RouteMode.driving});var u=new Microsoft.Maps.Directions.Waypoint({address:w});v.addWaypoint(u);var s=new Microsoft.Maps.Directions.Waypoint({location:new Microsoft.Maps.Location(m,o)});v.addWaypoint(s);Microsoft.Maps.Events.addHandler(v,"directionsUpdated",i);v.calculateDirections();function i(x){$("#directions_panel").html("<strong>Distance: </strong>"+parseInt(x.routeSummary[0].distance)+" km | <strong>Temps: </strong>"+parseInt(x.routeSummary[0].time/60)+" minutes")}}else{if(window.OSMSELECTED){}else{var t={origin:w,destination:c,travelMode:google.maps.DirectionsTravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC};p.route(t,function(z,x){if(x==google.maps.DirectionsStatus.OK){q.setDirections(z);var y=z.routes[0];var B=e.find("#directions_panel")[0];B.innerHTML="";for(var A=0;A<y.legs.length;A++){var C=A+1;B.innerHTML+=y.legs[A].start_address+" -> ";B.innerHTML+=y.legs[A].end_address+" -> ";B.innerHTML+=y.legs[A].distance.text+"<br><br>"}}})}}}})})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".file-container").each(function(u,y){var s=$(y);var c=s.find(".file-upload");var t=s.find(".file-view");var o=s.find(".file-preview");var x=c.find(".validation-advice-single");var d=t.find(".info");var e=d.find(".date");var f=d.find(".origin");var n=s.find(".writeinline");var l=$("#progressbar");var q=$("#_errors");l.hide();var k=l.find(".content");var v=k.html();var C=s.attr("data-fieldname");var D=s.attr("data-name");var g=s.find("input[name="+D+"]");var r=$("#origin");var j=$("#cvorigin");var h="/jobs/jobapply.do?filetype="+C;var m="NOK";var A=new Date();var B=A.getDate();var w=A.getMonth()+1;var p=A.getFullYear();if(B<10){B="0"+B}if(w<10){w="0"+w}var z=B+"/"+w+"/"+p;s.find("input[type=file]").fileupload({dataType:"json",progressall:function(F,E){var i=parseInt((E.loaded/E.total)*100,10);k.css("width",i+"%").html(v)},change:function(E,i){l.appendTo(s);l.show();c.hide();i.url=h+"&do=upload"},add:function(E,i){i.submit()},done:function(I,G){k.css("width","0%");l.hide();var E=G&&G.result&&G.result.status?G.result.status:m;if(E==m){var F="";if(q){var H=G.result.errorCode;var i=q.find("."+H);if(i.length){F=i.html()}}if(F==""){if(G&&G.result&&G.result.errorMsg){F=G.result.errorMsg}else{F="upload error"}}c.show();x.show();console.log(F)}else{t.show();x.hide();e.html(z);$sizeInBytes=(G.result.size/1000000).toFixed(2);f.html(G.result.name+" ["+$sizeInBytes+" M]");g.val(G.result.name);r.val("")}},error:function(i,E){t.hide();c.show();l.hide();x.show();console.log("myerror="+i)}});s.find(".file-change").on("click",function(i){i.preventDefault();i.stopPropagation();t.hide();c.show();x.hide();e.html("");f.html("");g.val("");var E=s.attr("data-textname");if(E){s.find("textarea[name="+E+"]").html("")}l.hide();k.css("width","0%");$.ajax({url:h+"&do=delete",dataType:"json",success:function(F){},error:function(F){}})});o.on("click",function(E){E.preventDefault();E.stopPropagation();var i="preview error";$.ajax({url:h+"&do=view",type:"POST",dataType:"json",data:$("#applyForm").serialize(),success:function(G){var F=G&&G.status?G.status:m;if(G&&G.errorMsg){i=G.errorMsg}if(F==m||!G.url){alert(i)}else{self.location=G.url}},error:function(F){alert(i)}})});n.on("click",function(i){i.preventDefault();i.stopPropagation();$(this).hide();s.find(".filetext").show()});s.find(".cvgenerate").on("click",function(F){F.preventDefault();F.stopPropagation();c.hide();var i=$(this).attr("data-origin");var E="La publication de votre CV n'a pas pu s'effectuer - Sorry, Your CV publication has failed";$.fancybox('<div class="message-loading"><span class="loading mini"></span><p>'+$(".inprogress").html()+"</p></div>",{width:"450",height:"30",autoSize:false});$.ajax({url:h+"&do=generate&origin="+i+"&joid="+$("#joid").val(),dataType:"json",type:"POST",data:$("#applyForm").serialize(),success:function(I){var H=I&&I.status?I.status:m;var J=I&&I.errorCode?I.errorCode:"";if(J!=""){J=J.toLowerCase()}if(I&&I.errorMsg){E=I.errorMsg+" ["+J+"]"}if(H==m){if(q){var G=q.find("."+J);if(G.length){E=G.html()}}if(i=="linkedin"||i=="orangecloud"||i=="googledrive"||i=="dropbox"){self.location=I.url}else{if(J=="authenticationneeded"&&I.url){if(confirm(E)){self.location=I.url}else{$.fancybox.close();c.show()}}else{if(J=="alreadyauthenticated"&&I.url){$.fancybox.close();self.location=I.url}else{if(q){var G=q.find("."+J);if(G.length){E=G.html()}}$.fancybox.close();c.show();console.log(E)}}}}else{$.fancybox.close();t.show();e.html(z);if(I.reference&&I.reference!=""){f.html(I.reference);j.val(I.reference)}else{f.html(I.name+" ["+I.size+" o]")}g.val(I.name);r.val(i)}},error:function(G){if(i=="linkedin"){self.location="/jobs/jobapply.do?do=testpage"}else{$.fancybox.close();c.show();console.log(E)}}})});s.find(".cloudletter").on("click",function(F){F.preventDefault();F.stopPropagation();c.hide();var i=$(this).attr("data-origin");var E="Le telechargement de votre lettre n'a pas pu s'effectuer - Sorry, the downloading of your letter has failed";$.fancybox('<div class="message-loading"><span class="loading mini"></span><p>'+$(".inprogress").html()+"</p></div>",{width:"450",height:"30",autoSize:false});$.ajax({url:h+"&do=cloudletter&origin="+i+"&joid="+$("#joid").val(),dataType:"json",type:"POST",data:$("#applyForm").serialize(),success:function(I){var H=I&&I.status?I.status:m;var J=I&&I.errorCode?I.errorCode:"";if(J!=""){J=J.toLowerCase()}if(I&&I.errorMsg){E=I.errorMsg+" ["+J+"]"}if(H==m){if(q){var G=q.find("."+J);if(G.length){E=G.html()}}if(i=="linkedin"||i=="orangecloud"||i=="googledrive"||i=="dropbox"){self.location=I.url}else{if(J=="authenticationneeded"&&I.url){if(confirm(E)){self.location=I.url}else{$.fancybox.close();c.show()}}else{if(J=="alreadyauthenticated"&&I.url){$.fancybox.close();self.location=I.url}else{if(q){var G=q.find("."+J);if(G.length){E=G.html()}}$.fancybox.close();c.show();console.log(E)}}}}else{$.fancybox.close();t.show();e.html(z);f.html(I.name+" ["+I.size+" o]");g.val(I.name);r.val(i)}},error:function(G){if(i=="linkedin"){self.location="/jobs/jobapply.do?do=testpage"}else{$.fancybox.close();c.show();console.log(E)}}})})})})})();(function(){$(window).on("digital:contentReady",function(d,c){var b=$(c);var e=b.data("read-tag");if(e){var a=b.find(".dgt-content").first();setTimeout(function(){var f=($("body").hasClass("lyt-mo")?true:false);if(f){a=$(window)}a.one("scroll",function(){a.xhr=$.ajax({url:e})})},1000)}})})();(function(){$(window).on("digital:contentReady",function(h,g){var f=$(g);f.find(".dgt-quest").each(function(j,k){new b(k)})});function d(f){$(f).find(":input").each(function(){if(this.type=="text"||this.type=="textarea"){this.value=""}else{if(this.type=="radio"||this.type=="checkbox"){this.checked=false}else{if(this.type=="select-one"||this.type=="select-multiple"){this.value=""}}}})}function e(f){$(f).find(".dgt-quest-next").each(function(g,h){$(h).addClass("visible")})}function c(f){$(f).find(".dgt-quest-next").each(function(g,h){$(h).removeClass("visible")})}function a(j){var f=$(j);var k={failedClass:"validation-failed",passedClass:"validation-passed",divClass:"validation-advice",};f.find("."+k.divClass).remove();var g=true;for(var h=0;h<=validationRules.length-1;h++){f.find("."+validationRules[h][0]).each(function(m){var l=$(this);var n=l.val();if(!validationRules[h][2](n,l)){if(!l.hasClass(k.failedClass)){l.addClass(k.failedClass)}var o="advice-"+validationRules[h][0]+"-"+l.attr("id");var i=l.closest(".form-row");i.prepend('<span class="'+k.divClass+'" id="'+o+'">'+validationRules[h][1]+"</span>");g=false;l.on("focus",function(){$("#"+o).remove()});l.on("change",function(){$("#"+o).remove()});l.on("click",function(){$("#"+o).remove()})}else{if(!l.hasClass(k.passedClass)){l.addClass(k.passedClass)}if(l.hasClass(k.failedClass)){l.removeClass(k.failedClass)}}})}if(!g){$("."+k.divClass).on("click",function(){$(this).remove()})}return g}var b=function(){console.log("new Dgt_Quest()");this.initialize.apply(this,arguments)};$.extend(b.prototype,{initialize:function(f){this.uid=_.uniqueId("digital-");this.$view=$(f).data("Dgt_Quest",this);this.$page=this.$view.closest(".page,#head");this.$questions=this.$view.find(".dgt-quest-question");this.nbq=this.$questions.length;this.$paginate=!this.$view.data("qtype")||this.$view.data("qtype")==="multiple";if(!this.$paginate){this.$view.find(".dgt-quest-next").last().removeClass("dgt-quest-next").addClass("dgt-quest-submit")}if(ieVersion===8||ieVersion===7){this.$page.addClass("ie8");this.$page.on("click","label",$.proxy(function(i){var j=$(i.currentTarget).attr("for");var h=this.$view.find(":checkbox#"+j+":eq(0),:radio#"+j+":eq(0)");if(h.length&&!h.is(":visible")){h.trigger("click").trigger("change")}},this))}this.$form=this.$view.find("form");this.$form.on("submit",$.proxy(this.form_submitHandler,this));this.$form.on("change",":checkbox",$.proxy(this.check_changeHandler,this));this.$form.on("change",":radio",$.proxy(this.redio_changeHandler,this));this.$form.on("change","select",$.proxy(this.select_changeHandler,this));this.$form.on("keyup","input[type=text],textarea",$.proxy(this.inputText_changeHandler,this));this.$form.on("click",".dgt-quest-next a",$.proxy(this.button_nextHandler,this));this.$form.on("click",".dgt-quest-submit a",$.proxy(this.form_submitHandler,this));this.initSelect();this.initDate();this.initRating();this.initShowQuestions();var g=$(document.body).on("layout:change."+this.uid,$.proxy(this.invalidateLayout,this)).data("layout");if(g){this.invalidateLayout(null,g)}},dispose:function(){$(document.body).off("."+this.uid)},invalidateLayout:function(g,f){this.isMobile=f==="MobileLayout";this.isHorizontal=f==="HorizontalLayout"},initShowQuestions:function(){this.$paginate?this.$questions.first().addClass("visible"):this.refresh_questions()},form_submitHandler:function(f){f.preventDefault();var g=true;this.$form.find(".dgt-quest-question.visible").each(function(h,j){if(a($(j))===false){g=false}});if(g){this.loadData()}},getFormUrl:function(){return this.$form.attr("action")},getFormData:function(f){var g=this.$form.serializeArray();if(f){_.each(f,function(i,h){var j=_.findWhere(g,{name:h});if(!j){g.push((j={name:h}))}j.value=i},this)}return g},loadData:function(){if(this.jqXHR){this.jqXHR.abort()}this.jqXHR=$.ajax({url:this.getFormUrl(),type:"post",dataType:"json",data:this.getFormData(),context:this,beforeSend:function(g,f){g.__settings=f},});this.jqXHR.done(this.loadData_doneHandler);this.jqXHR.fail(this.loadData_failHandler);this.jqXHR.always(this.loadData_alwaysHandler)},loadData_doneHandler:function(g,j,f){this.$redirect=this.$view.find(".dgt-quest-epilog a.dgt-quest-redirect").first();if(this.$redirect.length>0&&this.$redirect.attr("href").length>0){document.location=this.$redirect.attr("href")}else{if(g.status&&(g.status=="OK")){this.$view.find(".dgt-quest-question").not(".dgt-quest-epilog").removeClass("visible");if(g.qaid&&(g.qaid.length>0)){$mylink=this.$view.find(".dgt-quest-epilog a.apply").first();var i=$mylink.attr("href");var h=i.indexOf("?")>0?"&":"?";i+=(h+"qaid="+encodeURIComponent(g.qaid));$mylink.attr("href",i)}this.$view.find(".dgt-quest-epilog").addClass("ok").removeClass("ko")}else{this.$view.find(".dgt-quest-question").not(".dgt-quest-epilog").removeClass("visible");this.$view.find(".dgt-quest-epilog").addClass("ko").removeClass("ok")}}},loadData_failHandler:function(f,h,g){console.log(h)},loadData_alwaysHandler:function(f){this.jqXHR=null},initSelect:function(){this.$form.find("select").each(function(h,j){$s=$(j);var g=$s.find("option");if(g.length>9){var f=g.map(function(i,k){return{t:$(k).text(),v:k.value,c:$(k).data("code"),}}).get();f.sort(function(k,i){return k.t>i.t?1:k.t<i.t?-1:0});g.each(function(k,l){l.value=f[k].v;$(l).text(f[k].t);$(l).attr("data-code",f[k].c)})}$s.prepend("<option class='init-option' value='' selected>--------</option>");$s.val("")})},initDate:function(){this.$form.find(".date input").each(function(g,h){var j=$(h);j.pickadate({format:"dd mmm, yyyy",formatSubmit:"yyyymmdd",hiddenName:true,})})},initRating:function(){this.$form.find(".rating select").each(function(g,h){var j=$(h);j.barrating({theme:"css-stars",})})},button_applyHandler:function(f){f.preventDefault();f.stopPropagation();var g=$(f.currentTarget)},button_nextHandler:function(f){f.preventDefault();f.stopPropagation();var g=$(f.currentTarget);var i=g.closest(".dgt-quest-question");$f=this.$form;if(a(i)===true){var h=i.nextAll(".dgt-quest-question");if(this.$paginate&&h.length>0){i.removeClass("visible");$f=this.$form;h.each(function(n,m){$question=$(m);$conditions=$question.data("condition");var r=false;if($conditions&&$conditions.length>0&&$conditions.charAt(0)!="$"){var q=$conditions.split("|");for(var n=0,k=q.length;n<k;n++){$condition=q[n];var l=$condition.split("=");var p=l[0];var s=l[1];if(s&&s.length&&p&&p.length){var o=$f.find("#"+p);var j=o.find("[data-code='"+s+"']");r=j.is("option:selected,input[type='radio']:checked,input[type='checkbox']:checked")?true:false}if(r===true){break}}}else{r=true}if(r){$question.addClass("visible");if($question.hasClass("dgt-quest-epilog")){$.proxy($f.trigger("submit"),this)}return false}else{$question.removeClass("visible")}})}}},check_changeHandler:function(i,h){var f=$(i.currentTarget);var g=f.closest(".dgt-quest-question");if(f.data("code")==="NA"){$others=g.find('input:checkbox:checked:not([data-code="NA"])')}else{$others=g.find('input:checkbox:checked[data-code="NA"]')}if($others.length){$others.prop("checked",false)}if(this.$paginate){g.find(":checkbox:checked").length>0?e(g):c(g)}else{this.refresh_questions()}},redio_changeHandler:function(i,h){var f=$(i.currentTarget);var g=f.closest(".dgt-quest-question");if(this.$paginate){g.find(":radio:checked").length>0?e(g):c(g)}else{this.refresh_questions()}},select_changeHandler:function(i,h){if(this.$paginate){var f=$(i.currentTarget);var g=f.closest(".dgt-quest-question");f.val()?e(g):c(g)}else{this.refresh_questions()}},inputText_changeHandler:function(h){if(this.$paginate){h.stopPropagation();var f=$(h.currentTarget);var g=f.closest(".dgt-quest-question");f.val().length>0?e(g):c(g)}},refresh_questions:function(){if(!this.$paginate){$f=this.$form;this.$questions.each(function(k,j){$question=$(j);$conditions=$question.data("condition");if($conditions&&$conditions.length>0&&$conditions.charAt(0)!="$"){var n=$conditions.split("|");var o=false;for(var k=0,g=n.length;k<g;k++){$condition=n[k];var h=$condition.split("=");var m=h[0];var p=h[1];if(p&&p.length&&m&&m.length){var l=$f.find("#"+m);var f=l.find("[data-code='"+p+"']");o=f.is("option:selected,input[type='radio']:checked,input[type='checkbox']:checked")?true:false}}if(o){$question.addClass("visible").addClass("sub")}else{$question.removeClass("visible");d($question)}}else{$question.addClass("visible")}})}},})})();(function(){$(window).on("digital:contentReady",function(d,c){var b=$(c);b.find(".js-restAjaxForm").each(function(e,f){new a(f)})});var a=function(){this.initialize.apply(this,arguments)};$.extend(a.prototype,{initialize:function(g){console.log("init : AjaxForm ");$f=$(g);var i=$f.attr("method")||"post";var j=$f.attr("action");var k=$f.data("csrf")||"";var e=$f.data("redirect")||"";var l=$f.data("remove")||"";var h=$f.data("select2strip")||"";var c=$f.closest(".page");var b=c.prev(".page");var d=$f.attr("enctype");$f.submit(function(m){m.preventDefault();if($f.bkValidation()){var f=new FormData(this);if(d=="multipart/form-data"){$.ajax({url:j,type:i,data:f,headers:{"x-csrf-token":k},success:function(n){},error:function(n){},cache:false,contentType:false,processData:false})}else{$.ajax({url:j,type:i,data:$f.serialize(),headers:{"x-csrf-token":k},success:function(n){if(e.length>0){window.location=e}else{if(n.status="OK"){if((i=="put")&&(h.length>0)){$st=simpleID($f.find(h).val());b.find(".current").attr("class","current status_"+$st);$f.find(".row-status_"+$st).show();$f.find(".status-removable").remove()}}}},error:function(n){}})}}})}})})();(function(){$(window).on("digital:contentReady",function(d,c){var b=$(c);b.find(".js-validationForm").each(function(e,f){new a(f)})});var a=function(){this.initialize.apply(this,arguments)};$.extend(a.prototype,{initialize:function(b){$f=$(b);console.log("new ValidationForm");$f.submit(function(c){if($f.bkValidation()){return}c.preventDefault()})}})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".block-background").each(function(c,d){$elem=$(d);$url=$elem.data("url")||false;$classe=$elem.data("class")||false;$elem.closest(".dgt-section-body").each(function(e,f){$content=$(f);if($url){$content.addClass("page-fixed-background");$content.css("background-image","url("+$url+")")}if($classe){$content.addClass("page-background-"+$classe)}$elem.remove()})})})})();var ScrollMagicController=(typeof ScrollMagic!="undefined")?new ScrollMagic.Controller({loglevel:3}):false;(function(){$(window).on("digital:contentReady",function(b,a){if(ScrollMagicController){$(a).find(".planning-block, .steps-block").each(function(c,d){$elem=$(d);$idPlanning="scpb_"+c;$elem.attr("id",$idPlanning);var e=new $.ScrollMagic.Scene({triggerElement:"#"+$idPlanning,triggerHook:0.9,duration:"90%",offset:50}).setClassToggle("#"+$idPlanning,"visible").addTo(ScrollMagicController)})}})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".offer_block").each(function(c,d){$elem=$(d);$elem.find("p").filter(function(){return $.trim(this.innerHTML)==="&nbsp;"}).remove()})})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".offer-content").each(function(c,d){if((document.referrer.indexOf(location.protocol+"//"+location.hostname)==0)&&(history.length==1)){console.log("hello:"+$(document).find("#mead .close").first().attr("class"));$(document).find("#mead .close").first().show()}})})})();(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".block-video video").each(function(c,d){$(d)[0].play()})})})();(function(){$(window).on("digital:contentReady",function(k,j){var i=$(j);i.find(".oj-jobsapp").each(function(l,m){new g(m)});i.find(".oj-jobslist").each(function(l,m){new h(m)})});var f={log:function(){},info:function(){},warn:function(){},error:function(){},debug:function(){}};function e(j,i){j.url=i;j.nextPageUrl=null;if(j.index<j.pages){j.nextPageUrl=j.url}}var h=function(){f.log("new Digital_JobsList()");this.initialize.apply(this,arguments)};$.extend(h.prototype,{initialize:function(j){this.uid=_.uniqueId("digital-");this.$list=$(j);this.$page=this.$list.closest(".page,#head");this.$page.on("digital:dispose",$.proxy(this.dispose,this));this.$jobsapp=this.$page.prev(".page").find(".oj-jobsapp");if(!this.$jobsapp.length){return}this.jobsapp=this.$jobsapp.data("Digital_JobsApp");this.$jobsapp.on("jobsapp:data."+this.uid,$.proxy(this.jobsapp_dataHandler,this));this.$jobsapp.on("filters:change."+this.uid,$.proxy(this.jobsapp_filtersChangedHandler,this));this.params=this.$list.data("digital-list-params");if(!this.params){this.$list.data("digital-list-params",this.params={})}this.$items=this.$list.find(".dgt-list-items");this.$items.on("click",".oj-joblist-more",$.proxy(this.more_clickHandler,this));this.$items.on("scroll",$.proxy(this.checkMorePosition,this));this.$tools=this.$list.find(".oj-jobslist-tools");this.$list.find(".oj-jobslist-tools").replaceWith(this.$tools);this.$tools.find(".do-alert").on("click",$.proxy(this.createAlert_clickHandler,this));this.$tools.find(".toggle, .filters").on("click",$.proxy(this.toolsToggle_clickHandler,this));this.$tools.find(".filters").on("mouseenter",".filter[data-tooltip]",$.proxy(this.toolsTooltip_enterHandler,this));this.$tools.find(".filters").on("mouseleave",".filter[data-tooltip]",$.proxy(this.toolsTooltip_leaveHandler,this));this.$tools.find(".do-clear .remove").on("click",$.proxy(this.filtersClear_clickHandler,this));this.$tools.find(".overlay").on("click",".btn-filter .remove",$.proxy(this.filterRemove_clickHandler,this));var k='{{#each items}} <a class="filter type-{{type}}" href="#" {{#xif " this.tooltip "}}data-tooltip="{{tooltip}}"{{/xif}} data-id="{{id}}">{{value}}</a> {{/each}}';var i='{{#each items}} <span class="btn btn-filter type-{{type}}" data-id="{{id}}">{{value}} <a class="remove" href="#"></a></span> {{/each}}';this.filtersBarTemplate=Handlebars.compile(k);this.filtersListTemplate=Handlebars.compile(i);this.jobsapp_filtersChangedHandler(null,this.jobsapp.getFilters());this.$items=this.$list.find(".dgt-list-items");this.$items.on("click",".oj-joblist-more",$.proxy(this.more_clickHandler,this));this.$items.on("scroll",$.proxy(this.checkMorePosition,this));this.itemTemplate=Handlebars.compile($("script#oj-joblist-item-template").html());this.moreTemplate=Handlebars.compile($("script#oj-joblist-more-template").html());if(this.jobsapp.lastResult){this.jobsapp_dataHandler(null,this.jobsapp.lastResult)}},dispose:function(){f.log("Digital_JobsList.dispose()");this.$jobsapp.off("."+this.uid)},jobsapp_dataHandler:function(i,j){this.params.totalItems=j.total;this.$list.trigger("totalItemsChanged");this.$items.empty().scrollTop(0);this.addItemsFromData(j)},checkMorePosition:function(){if(!this.$more){return}var l=this.$more.offset().top;var k=this.$items.offset().top;var j=this.$items.outerHeight();var i=this.$items.scrollTop();if(l<k+j+j*0.5){this.more_clickHandler()}},addItemsFromData:function(j){if(this.$more){this.$more.remove();this.$more=null}this.$items.append(this.itemTemplate(j));if(j.nextPageUrl){this.$more=$(this.moreTemplate(j));this.$items.append(this.$more);this.checkMorePosition();var i=this.jobsapp.$form.find('input[name="index"]');i.val(parseInt(i.val())+1)}this.$items.trigger("itemsChanged")},more_clickHandler:function(i){if(i){i.preventDefault();i.stopPropagation()}if(this.$more.is(".is-loading")){return}this.$more.addClass("is-loading");this.jqXHR=$.ajax({url:this.$more.find("a").attr("href"),type:"post",data:this.jobsapp.getFormData(),dataType:"json",context:this,beforeSend:function(k,j){k.__settings=j}});this.jqXHR.$more=this.$more;this.jqXHR.done(this.loadMore_doneHandler);this.jqXHR.fail(this.loadMore_failHandler);this.jqXHR.always(this.loadMore_alwaysHandler)},loadMore_doneHandler:function(j,k,i){e(j,i.__settings.url);this.addItemsFromData(j)},loadMore_failHandler:function(i,k,j){i.$more.removeClass("is-loading")},toolsToggle_clickHandler:function(i){i.preventDefault();i.stopPropagation();this.$tools.toggleClass("is-opened")},toolsTooltip_enterHandler:function(l){f.log("## enter");var o=$(l.currentTarget);var i=o.offset();var n=o.outerWidth();var k=o.outerHeight();var j=o.data("tooltip-$el");if(!j){j=$('<span class="oj-jobsapp-filter-tooltip">'+o.data("tooltip")+"</span>");j.css("opacity",0);o.data("tooltip-$el",j)}$(document.body).append(j);var m=j.stop(true).outerWidth();j.css({top:i.top+k,left:i.left+n/2-m/2}).animate({opacity:1},200)},toolsTooltip_leaveHandler:function(j){f.log("## leave");var k=$(j.currentTarget);var i=k.data("tooltip-$el");if(i){i.stop(true).animate({opacity:0},200,function(){i.remove()})}},createAlert_clickHandler:function(i){i.preventDefault();i.stopPropagation();alert_create(this.jobsapp.getFormData())},filtersClear_clickHandler:function(i){i.preventDefault();i.stopPropagation();this.jobsapp.clearFilters();this.$tools.removeClass("is-opened")},filterRemove_clickHandler:function(i){i.preventDefault();i.stopPropagation();var j=$(i.currentTarget).closest(".btn-filter");this.jobsapp.removeFilter(j.data("id"))},jobsapp_filtersChangedHandler:function(l,k){this.$tools.toggleClass("has-filters",k.length>0);var j=this.$tools.find(".filters");var i=this.$tools.find(".overlay");j.find(".filter").remove();i.find(".btn-filter").remove();if(k.length<=0){return}j.prepend(this.filtersBarTemplate({items:k}));i.append(this.filtersListTemplate({items:k}))}});var g=function(){f.log("new Digital_JobsApp()");this.initialize.apply(this,arguments)};$.extend(g.prototype,{initialize:function(i){this.uid=_.uniqueId("digital-");this.$view=$(i).data("Digital_JobsApp",this);this.$page=this.$view.closest(".page,#head");this.$page.on("digital:dispose",$.proxy(this.dispose,this));this.isMobileMap=(window.Microsoft&&window.Microsoft.Maps)?false:true;this.loadData=_.debounce(this.loadData,100);if(ieVersion===8||ieVersion===7){this.$page.addClass("ie8");this.$page.on("click","label",$.proxy(function(l){var m=$(l.currentTarget).attr("for");var k=this.$page.find(":checkbox#"+m+":eq(0)");if(k.length&&!k.is(":visible")){k.trigger("click").trigger("change")}},this))}this.$form=this.$view.find("form");this.$form.on("submit",$.proxy(this.form_submitHandler,this));this.$form.on("change",":checkbox",$.proxy(this.checkbox_changeHandler,this));this.$form.on("change","select",$.proxy(this.select_changeHandler,this));this.$form.on("change","input[type=text]",$.proxy(this.inputText_changeHandler,this));this.$form.find(":checkbox, select, input[type=text]").trigger("change");this.$menu=this.$view.find(".dgt-menu").addClass("oj-jobsmenu");this.menu=this.$menu.data("DigitalMenuController");this.$menu.on("submenuOpened",$.proxy(this.menu_submenuOpenedHandler,this));this.$menu.on("allSubmenuClosed",$.proxy(this.menu_allSubmenuClosedHandler,this));this.$menubar=this.$page.find(".oj-jobsmenu-bar").detach();this.$menubarCount=this.$menubar.find(".count");this.menubarCountText=this.$menubarCount.text();this.$menubarRoot=this.$menubar.find(".back-root");this.$menubarRoot.on("click",$.proxy(this.menubarRoot_clickHandler,this));this.$jobsmap=this.$view.find(".oj-jobsmap").detach();var j=$(document.body).on("layout:change."+this.uid,$.proxy(this.invalidateLayout,this)).data("layout");if(j){this.invalidateLayout(null,j)}_.each(this.$form.find("input:checkbox:checked"),function(k){$(k).trigger("change")},this);_.each(this.$form.find('input:text[value!=""]'),function(k){$(k).trigger("change")},this);this.$menubar.addClass("is-at-root");this.$form.trigger("submit")},dispose:function(){f.log("Digital_JobsApp.dispose()");$(document.body).off("."+this.uid)},invalidateLayout:function(j,i){this.isMobile=i==="MobileLayout";this.isHorizontal=i==="HorizontalLayout";if(this.isHorizontal){this.$menu.hide();this.menu.closeAll();this.$jobsmap.appendTo(this.$view);if(!this.jobsmap){if(window.BINGMAPSSELECTED){if(window.BINGMAPSLOADED&&window.Microsoft&&window.Microsoft.Maps){this.jobsmap=new d(this.$jobsmap,this);f.log("BingMaps Selected")}else{return;f.log("BingMaps Already Selected")}}else{if(window.OSMSELECTED){this.jobsmap=new b(this.$jobsmap,this);f.log("OpenStreetMap Selected")}else{this.jobsmap=new c(this.$jobsmap,this);f.log("Googlemaps Selected")}}}if($(window).scrollTop()!=0){window.scrollTo(0,0)}}else{this.$menu.show();if(this.$jobsmap&&!this.isMobileMap){this.$jobsmap.detach()}if(this.isMobileMap){$map_mo=$('<div class="map_mo"/>').appendTo(this.$view);var k=50;$map_mo.height($(window).height()-$map_mo.position().top-k);this.$jobsmap.appendTo($map_mo);if(!this.jobsmap){if(window.BINGMAPSSELECTED){if(window.BINGMAPSLOADED&&window.Microsoft&&window.Microsoft.Maps){this.jobsmap=new d(this.$jobsmap,this)}else{return}}else{if(window.OSMSELECTED){this.jobsmap=new b(this.$jobsmap,this);f.log("OpenStreetMap Selected")}else{this.jobsmap=new c(this.$jobsmap,this)}}}}}if(this.isMobile){if(this.lastResult){this.$menubarCount.text(this.menubarCountText.replace("#",this.lastResult.total))}this.$menubar.prependTo(this.$page)}else{if(this.$menubar){this.$menubar.detach()}}},form_submitHandler:function(i){i.preventDefault();this.loadData()},getFormUrl:function(){return this.$form.attr("action")},getFormData:function(i){var j={};this.$form.find(":input, select").each(function(k,l){var m=$(l).val();if(m!==null&&!($(l).is('[type="checkbox"]')&&!$(l).prop("checked"))){if(typeof j[l.name]!=="undefined"){j[l.name]=[$(l).val()].concat(j[l.name])}else{j[l.name]=$(l).val()}}});if(i){j=$.extend(j,i)}f.log(j);return JSON.stringify(j)},updateNumChildrenChecked:function(){var k,j,i;_.each(this.$menu.find("a[href^=#]"),function(l){k=$(l);j=k.next("ul");if(!j.length){return}i=j.find("input:checked").length||null;if(i==k.attr("data-num-children-checked")){return}this.$page.find('a[href="'+k.attr("href")+'"]').attr("data-num-children-checked",i);if(this.$mapMenu&&!this.$mapMenu.parent().length){this.$mapMenu.find('a[href="'+k.attr("href")+'"]').attr("data-num-children-checked",i)}},this)},loadData:function(){f.log("Digital_JobsApp.loadData()");this.$form.find('input[name="index"]').val(1);if(this.jqXHR){this.jqXHR.abort()}this.jqXHR=$.ajax({url:this.getFormUrl(),type:"POST",dataType:"json",data:this.getFormData(),context:this,processData:false,contentType:"application/json",beforeSend:function(j,i){j.__settings=i}});this.jqXHR.done(this.loadData_doneHandler);this.jqXHR.fail(this.loadData_failHandler);this.jqXHR.always(this.loadData_alwaysHandler)},loadData_doneHandler:function(j,k,i){f.log("Digital_JobsApp.loadData_doneHandler()");e(j,i.__settings.url);this.lastResult=j;this.$view.trigger("jobsapp:data",this.lastResult);if(this.isMobile){this.$menubarCount.text(this.menubarCountText.replace("#",this.lastResult.total))}if(this.isHorizontal||this.isMobileMap){this.jobsmap.loadMarkers()}},loadData_failHandler:function(i,k,j){f.log(k)},loadData_alwaysHandler:function(i){this.jqXHR=null},getFilters:function(){return this.filters?this.filters.slice(0):[]},clearFilters:function(){_.each(this.filters,this.removeFilter,this)},removeFilter:function(m){if(_.isString(m)){m=_.findWhere(this.filters,{id:m})}if(!m||!m.id||!m.type){return}if(m.type==="checkbox"){var l=this.$form.find("input:checkbox#"+m.id);if(l.length&&l.is(":checked")){l.attr("checked",false).trigger("change")}}else{if(m.type==="text"){var n=this.$form.find("input#"+m.id);if(n.length&&n.val()!==""){n.val("").trigger("change")}}else{if(m.type==="select"){var k=m.id.split("_");var i=this.$form.find('[name="'+k[0]+'"]');if(typeof i.attr("data-autocomplete")!=="undefined"){i.find('option[value="'+k[1]+'"]').remove()}else{i.find('option[value="'+k[1]+'"]').prop("selected",false)}i.trigger("change");var j=this.$view.find(".js-oj-chatbot").data("chatbot");j.generateList()}else{if(m.type==="map"){this.jobsmap.boundsFilter(false);this.jobsmap.zoomAll();this.loadData()}else{this.updateFilter(m.id,false)}}}}this.$form.submit()},updateFilter:function(n,k,m,j,l){f.log(n,k,m,j,l);if(!this.filters){this.filters=[]}if(j==="text"&&m!==""){m='"'+m+'"'}var i=_.findWhere(this.filters,{id:n});f.log(i);if(!!i!==k){if(k){i={id:n,value:m,type:j,tooltip:l||""};this.filters.push(i);this.$view.trigger("filters:add",[i]);f.log("filters:added",n,m,j,k)}else{this.filters=_.without(this.filters,i);this.$view.trigger("filters:remove",[i]);f.log("filters:removed",n,m,j,k)}}else{if(i&&i.value!==m){f.log("filters:updated",n,m,j,k);this.$view.trigger("filters:update",[i]);i.value=m}else{return}}this.$view.trigger("filters:change",[this.filters.slice(0)]);f.log("filters:change",this.filters)},checkbox_changeHandler:function(m,k){var l=$(m.currentTarget);var i=l.prev("label");var o=l.attr("id");var j=i.text();var n=l.is(":checked");this.updateFilter(o,n,j,"checkbox");this.$form.trigger("submit")},select_changeHandler:function(o,m){var j=this;var l=$(o.currentTarget);var k=l.attr("name");var i=l.find("option");if(!this.filters){this.filters=[]}var n=_.filter(this.filters,function(p){return p.id.indexOf(k)===0});f.log("filters",n);$.each(n,function(p,q){j.updateFilter(q.id,false,q.value,"select")});i.each(function(q,r){var s=$(r);var p=s.text();var u=k+"_"+s.attr("value");var t=s.is(":selected");j.updateFilter(u,t,p,"select")})},inputText_changeHandler:function(i){var l=$(i.currentTarget);var k=l.attr("id");var j=l.val();this.$page.find("input#"+k).val(j);this.updateFilter(k,j!=="",j,"text");this.$form.trigger("submit")},menu_submenuOpenedHandler:function(j,i){$(i).addClass("oj-jobsmenu");this.$menubar.removeClass("is-at-root")},menu_allSubmenuClosedHandler:function(i){this.$menubar.addClass("is-at-root")},menubarRoot_clickHandler:function(i){i.preventDefault();i.stopPropagation();this.menu.closeAll()},mapMenu_label_clickHandler:function(i){i.stopPropagation()},mapMenu_inputText_changeHandler:function(i){var l=$(i.currentTarget);var k=l.attr("id");var j=l.val();this.$form.find("input#"+k).val(j).trigger("change")},mapMenu_inputText_clickHandler:function(i){i.stopPropagation()},mapMenuLink_clickHandler:function(k){k.preventDefault();k.stopPropagation();var j=$(k.currentTarget);var i=j.attr("href");if(i.match(/^#[\w]+/)){this.toggleMapSubmenu(i)}},mapMenu_clickHandler:function(j){var i=$(j.target);if(i.is("input,label,a,h4")){return}if(i.closest("input,label,a",this.$mapMenu).length){return}j.preventDefault();j.stopPropagation();this.closeAllMapSubmenus()},toggleMapSubmenu:function(o,i,l){if(!this.$mapSubmenus||!this.$mapSubmenus.length){return}if(!this._openedSubmenus){this._openedSubmenus=[]}var j=this.$mapSubmenus.filter(o);var k=j.get(0);if(l&&!j.is(":visible")){return}i=i===undefined?!j.is(":visible"):!!i;var n=Math.min(j.data("submenu-level"),1);if(this._openedSubmenus.length>=n){var m=_.rest(this._openedSubmenus,n);_.each(m,function(q){var p=$(q);p.hide()},this);this._openedSubmenus=_.first(this._openedSubmenus,n)}if(i){j.show();this._openedSubmenus.push(k)}this.$mapMenu.find("a.is-opened").removeClass("is-opened");if(this._openedSubmenus.length>0){this.selectMapSubmenuLink(this._openedSubmenus.slice(-1)[0])}this.$mapMenu.toggleClass("has-submenu-opened",!!this._openedSubmenus.length)},closeAllMapSubmenus:function(){if(!this._openedSubmenus){return}var i=_.first(this._openedSubmenus);if(i){this.toggleMapSubmenu("#"+$(i).attr("id"),false)}},selectMapSubmenuLink:function(k){var i=$(k);var l=i.attr("id");this.$mapMenu.find('a[href="#'+l+'"]:not(.less)').addClass("is-opened");var j=i.data("submenu-parent");if(j){this.selectMapSubmenuLink(j)}}});function d(){f.log("new Digital_JobsBingMap()");this.initialize.apply(this,arguments)}$.extend(d.prototype,{initialize:function(j,i){Microsoft.Maps.loadModule("Microsoft.Maps.Clustering");this.uid=_.uniqueId("digital-");this.jobsapp=i;this.$view=j;this.filterLabel=this.$view.data("filter-label")||"";this.filterTooltip=this.$view.data("filter-tooltip")||"";this.$page=this.$view.closest(".page,#head");this.$page.on("digital:dispose",$.proxy(this.dispose,this));this.$zoomButton=$('<a href="#" class="bing-zoom"></a>').appendTo(this.$view);this.$unzoomButton=$('<a href="#" class="bing-unzoom"></a>').appendTo(this.$view);this.$zoomButton.on("click",$.proxy(this.zoomButton_clickHandler,this));this.$unzoomButton.on("click",$.proxy(this.unzoomButton_clickHandler,this));this._updateMap=_.debounce(this._updateMap,20);this.loadMarkers=_.debounce(this.loadMarkers,20);this.selectedCountries=[];this.bestRectInProgress=false;this.ZOOM_CTNT=3;this.ZOOM_CTRY=5;this.ZOOM_TOWNCODE=8;this.ZOOMDIRECT=17;_.each(this.jobsapp.getFilters(),function(k){this.jobsapp_filtersAddHandler(null,k)},this);this.jobsapp.$view.on("filters:add",$.proxy(this.jobsapp_filtersAddHandler,this));this.jobsapp.$view.on("filters:remove",$.proxy(this.jobsapp_filtersRemoveHandler,this));this.mapOptions={zoom:2,center:new Microsoft.Maps.Location(0,0),credentials:window.BING_MAPS_KEY,showDashboard:false,showMapTypeSelector:false,enableSearchLogo:false,showScalebar:false,disableStreetside:true,inertiaIntensity:0.8,backgroundColor:new Microsoft.Maps.Color(255,172,199,242),mapTypeId:Microsoft.Maps.MapTypeId.road};this.map=new Microsoft.Maps.Map(this.$view.get(0),this.mapOptions);Microsoft.Maps.Events.addHandler(this.map,"viewchangeend",$.proxy(this.map_viewChangeEndHandler,this));this.areasCenters=a},zoomButton_clickHandler:function(j){j.preventDefault();var i=this.map.getZoom();this.map.setView({zoom:i+1})},unzoomButton_clickHandler:function(j){j.preventDefault();var i=this.map.getZoom();if(i>2){this.map.setView({zoom:i-1})}},boundsFilter:function(i){if(i!==undefined){i=!!i;if(this.__boundsFilter!==i){this.__boundsFilter=i;if(i){if(this.selectedCountries.length){_.each(this.selectedCountries,function(k){var j=k.length>2?"CTNT":"CTRY";this.jobsapp.removeFilter({type:"checkbox",id:j+"_"+k})},this)}}this.jobsapp.updateFilter("map",i,this.filterLabel,"map",this.filterTooltip)}}return!!this.__boundsFilter},map_viewChangeEndHandler:function(){f.log("BingMap.map_viewChangeEndHandler()",arguments);var p=this.map.getZoom();var i=this.map.getCenter();var o=this.map.getBounds();var k=false;if(this.selectedCountries.length!==1&&this.map.getZoom()>this.mapOptions.zoom){this.boundsFilter(true)}else{if(this.selectedCountries.length===1){var n=this.selectedCountries[0];var j=n.length>2?this.ZOOM_CTNT:this.ZOOM_CTRY;if(j!==p){this.boundsFilter(true)}else{var m=this.map.getCenter();var l=this.getAreaCenter(n);m.latitude=Math.round(m.latitude*10000)/10000;m.longitude=Math.round(m.longitude*10000)/10000;if(!Microsoft.Maps.Location.areEqual(m,l)){this.boundsFilter(true)}}}}this.jobsapp.$form.find("input[name=latmax]").val(o.getNorth());this.jobsapp.$form.find("input[name=lngmax]").val(o.getEast());this.jobsapp.$form.find("input[name=latmin]").val(o.getSouth());this.jobsapp.$form.find("input[name=lngmin]").val(o.getWest());if(this.boundsFilter()){if(this.bestRectInProgress===false){this.jobsapp.loadData()}else{this.bestRectInProgress=false}}else{this.loadMarkers()}},dispose:function(){f.log("BingMap.dispose()",arguments);this.map.dispose()},getAreaCenter:function(i){var j=this.areasCenters[i];return j?new Microsoft.Maps.Location(j[1],j[0]):this.mapOptions.center},zoomAll:function(){this.map.setView({zoom:this.mapOptions.zoom,center:this.mapOptions.center})},map_clickZoomHandler:function(l){var i=new Microsoft.Maps.Point(l.getX(),l.getY());var m=l.target.tryPixelToLocation(i);var j=new Microsoft.Maps.Location(m.latitude,m.longitude);var k=this.map.getZoom();f.log("zoomlevel : "+k);if(k<3){k+=3}else{if(k<6){k+=1}else{k+=2}}this.map.setView({center:j,zoom:k})},jobsapp_filtersAddHandler:function(l,j){var i=j.id.substr(0,4);var k=j.id.substr(5);if(i==="CTRY"||i==="CTNT"){this.selectedCountries.push(k);this.boundsFilter(false);this._updateMap()}},jobsapp_filtersRemoveHandler:function(l,j){var i=j.id.substr(0,4);var k=j.id.substr(5);if(i==="CTRY"||i==="CTNT"){this.selectedCountries=_.without(this.selectedCountries,k);this._updateMap()}},_updateMap:function(){this._updateBounds()},_updateBounds:function(){if(this.boundsFilter()){return}if(this.selectedCountries.length===1){var k=this.selectedCountries[0];var j=k.length>2?this.ZOOM_CTNT:this.ZOOM_CTRY;var i=this.getAreaCenter(k);this.map.setView({zoom:j,center:i})}else{this.map.setView({zoom:this.mapOptions.zoom,center:this.mapOptions.center})}},loadMarkers:function(){f.log("BingMap.loadMarkers()",arguments);if(this._jqXHR){this._jqXHR.abort()}var i=this.jobsapp.getFormUrl();var j=this.jobsapp.getFormData({nb:10000});this._jqXHR=$.ajax({url:i,type:"POST",dataType:"json",data:j,processData:false,contentType:"application/json",context:this});this._jqXHR.done(this.loadMarkers_doneHandler);this._jqXHR.always(this.loadMarkers_alwaysHandler)},loadMarkers_doneHandler:function(k,j,r){f.log("BingMap.loadMarkers_doneHandler()",arguments);var q=this;this.markers=[];var o,p,m;_.each(k.items,function(s){if(s.lat!=0&&s.lng!=0){this.addMarker(s.lat,s.lng,s.title,s.joid)}},this);var l=new Microsoft.Maps.ClusterLayer(this.markers,{clusteredPinCallback:$.proxy(this.createCustomCluster,this),gridSize:100});this.map.layers.clear();this.map.layers.insert(l);if(this._firstLoadDone!==true){this._firstLoadDone=true;this.bestRectInProgress=true;try{var i=Microsoft.Maps.LocationRect.fromLocations(this.markers)}catch(n){f.log(n)}finally{}this.map.setView({bounds:i})}},createCustomCluster:function(j){var m=this;var o=12;var l=7;var n=j.containedPushpins.length;var i=Math.log(n)/Math.log(10)*5+o;var p="rgba(255, 120, 0, 0.5)";var k=['<svg xmlns="http://www.w3.org/2000/svg" width="',(i*2),'" height="',(i*2),'">','<circle cx="',i,'" cy="',i,'" r="',i,'" fill="',p,'"/>','<circle cx="',i,'" cy="',i,'" r="',i-l,'" fill="',p,'"/>',"</svg>"];j.setOptions({icon:k.join(""),anchor:new Microsoft.Maps.Point(i,i),textOffset:new Microsoft.Maps.Point(0,i-8)});Microsoft.Maps.Events.addHandler(j,"click",function(r){if(r.target.containedPushpins){var u=[];for(var s=0,q=r.target.containedPushpins.length;s<q;s++){u.push(r.target.containedPushpins[s].getLocation())}var t=Microsoft.Maps.LocationRect.fromLocations(u);f.log("bounds:"+t);m.map.setView({bounds:t,padding:100})}})},clusterSetView:function(i){f.log("BingMap.loadMarkers_alwaysHandler()",arguments);this.map.setView({bounds:i,padding:100})},loadMarkers_alwaysHandler:function(){f.log("BingMap.clusterSetView",arguments);this._jqXHR=null},addMarker:function(m,k,n,l){var i=new Microsoft.Maps.Location(m,k);var j=new Microsoft.Maps.Pushpin(i,{color:"rgba(255, 120, 0, 0.5)"});this.markers.push(j)}});function c(){f.log("new Digital_JobsGoogleMap()");this.initialize.apply(this,arguments)}$.extend(c.prototype,{initialize:function(j,i){this.uid=_.uniqueId("digital-");this.jobsapp=i;this.$view=j;this.filterLabel=this.$view.data("filter-label")||"";this.$page=this.$view.closest(".page,#head");this.$isHorizontal=$("body").hasClass("lyt-ho");this.$page.on("digital:dispose",$.proxy(this.dispose,this));this._updateMap=_.debounce(this._updateMap,20);this.loadMarkers=_.debounce(this.loadMarkers,20);this.$usercountry=this.$view.data("country")||"";this.selectedCountries=[];this.ZOOM_CTNT=3;this.ZOOM_CTRY=5;this.ZOOM_TOWNCODE=8;this.ZOOMDIRECT=17;_.each(this.jobsapp.getFilters(),function(k){this.jobsapp_filtersAddHandler(null,k)},this);this.jobsapp.$view.on("filters:add",$.proxy(this.jobsapp_filtersAddHandler,this));this.jobsapp.$view.on("filters:remove",$.proxy(this.jobsapp_filtersRemoveHandler,this));this.mapOptions={zoom:1,minZoom:1,maxZoom:21,center:new google.maps.LatLng(0,0),mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:(this.$isHorizontal)?false:true,draggable:true,panControl:false,mapTypeControl:false,streetViewControl:false,fullscreenControl:false,backgroundColor:"#b3d1ff",styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.country",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"administrative.province",elementType:"geometry",stylers:[{visibility:"off"}]}],zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.LEFT_BOTTOM,}};this.map=new google.maps.Map(this.$view.get(0),this.mapOptions);this.clusters=new MarkerClusterer(this.map,null,{styles:[{textColor:"#FFFFFF",url:"../images2/map/cluster-simple.png",width:40,height:40},{textColor:"#FFFFFF",url:"../images2/map/cluster-simple.png",width:40,height:40},{textColor:"#FFFFFF",url:"../images2/map/cluster-simple.png",width:40,height:40}]});google.maps.event.addListener(this.clusters,"mouseover",_.bind(this.clusters_mouseoverHandler,this));this.infowindow=new google.maps.InfoWindow({maxWidth:200,pixelOffset:new google.maps.Size(0,-6)});this.areasCenters=a;google.maps.event.addListener(this.map,"idle",_.bind(this.map_idleHandler,this));this.initGeoloc()},boundsFilter:function(i){if(i!==undefined){i=!!i;if(this.__boundsFilter!==i){this.__boundsFilter=i;if(i){if(this.selectedCountries.length){_.each(this.selectedCountries,function(k){var j=k.length>2?"CTNT":"CTRY";this.jobsapp.removeFilter({type:"checkbox",id:j+"_"+k})},this)}}this.jobsapp.updateFilter("map",i,this.filterLabel,"map",this.filterTooltip)}}return!!this.__boundsFilter},map_idleHandler:function(){var r=this.map.getZoom();var j=this.map.getCenter();var i=this.map.getBounds();if(!i){return}var l=false;if(this.selectedCountries.length!==1&&this.map.getZoom()>this.mapOptions.zoom){this.boundsFilter(true)}else{if(this.selectedCountries.length===1){var k=this.selectedCountries[0];var n=k.length>2?this.ZOOM_CTNT:this.ZOOM_CTRY;if(n!==r){this.boundsFilter(true)}else{var o=this.map.getCenter();var q=this.getAreaCenter(k);if(!o.equals(q)){this.boundsFilter(true)}}}}var m=i.getNorthEast();var p=i.getSouthWest();this.jobsapp.$form.find("input[name=latmax]").val(m.lat());this.jobsapp.$form.find("input[name=lngmax]").val(m.lng());this.jobsapp.$form.find("input[name=latmin]").val(p.lat());this.jobsapp.$form.find("input[name=lngmin]").val(p.lng());if(this.boundsFilter()){this.jobsapp.loadData()}else{this.loadMarkers()}},dispose:function(){f.log("Digital_JobsGoogleMap.dispose()");this.map&&google.maps.event.clearInstanceListeners(this.map);this.myloc&&google.maps.event.clearInstanceListeners(this.myloc);this.clusters&&google.maps.event.clearInstanceListeners(this.clusters);_.each(this.markers,function(i){google.maps.event.clearInstanceListeners(i)},this)},getAreaCenter:function(i){var j=this.areasCenters[i];return j?new google.maps.LatLng(j[1],j[0]):new google.maps.LatLng(0,0)},zoomAll:function(){this.map.setZoom(this.mapOptions.zoom);this.map.setCenter(this.mapOptions.center)},jobsapp_filtersAddHandler:function(l,j){var i=j.id.substr(0,4);var k=j.id.substr(5);if(i==="CTRY"||i==="CTNT"){this.selectedCountries.push(k);this.boundsFilter(false);this._updateMap()}},jobsapp_filtersRemoveHandler:function(l,j){var i=j.id.substr(0,4);var k=j.id.substr(5);if(i==="CTRY"||i==="CTNT"){this.selectedCountries=_.without(this.selectedCountries,k);this._updateMap()}},_updateMap:function(){this._updateBounds()},_updateBounds:function(){if(this.boundsFilter()){return}if(this.selectedCountries.length===1){var k=this.selectedCountries[0];var j=k.length>2?this.ZOOM_CTNT:this.ZOOM_CTRY;var i=this.getAreaCenter(k);this.map.setZoom(j);this.map.setCenter(i)}else{this.map.setZoom(this.mapOptions.zoom);this.map.setCenter(this.mapOptions.center)}},_changeBounds:function(l,m){var k=this.map.getZoom();var i=this.map.getCenter();var j=this.map.getBounds()},loadMarkers:function(){if(this._jqXHR){this._jqXHR.abort()}var i=this.jobsapp.getFormUrl();var j=this.jobsapp.getFormData({nb:10000});this._jqXHR=$.ajax({url:i,type:"POST",dataType:"json",data:j,processData:false,contentType:"application/json",context:this});this._jqXHR.done(this.loadMarkers_doneHandler);this._jqXHR.always(this.loadMarkers_alwaysHandler)},loadMarkers_doneHandler:function(m,o,l){this.clusters.clearMarkers();this.markers&&_.each(this.markers,function(p){p.setMap(null);google.maps.event.clearInstanceListeners(p)},this);this.markers=[];var k=this.map.getBounds();if(!k){return}var n,j,i;_.each(m.items,function(p){n=p.lat;j=p.lng;if(n!=0&&j!=0){i=new google.maps.LatLng(n,j);this.addMarker(n,j,i,p.title,1,p.joid)}},this);if(this.markers.length>0){this.clusters.addMarkers(this.markers)}},loadMarkers_alwaysHandler:function(){this._jqXHR=null},clusters_mouseoverHandler:function(k){var p=k.getMarkers();var j=k.getCenter();var i=null;var q="";var n=3;for(var m=0;m<p.length&&m<n;m++){var o=p[m];q+=this.getMarkerLink(o.title,o.joid)}this.showInfoWindow(k,q,j,p.length>n)},addMarker:function(n,l,j,o,i,m){var k=new google.maps.Marker({position:j,icon:"../images2/map/marker.png",title:o,joid:m});google.maps.event.addListener(k,"click",_.bind(this.marker_clickHandler,this,k));google.maps.event.addListener(k,"mouseover",_.bind(this.marker_mouseoverHandler,this,k));this.markers.push(k)},getMarkerLink:function(j,i){return'<a href="/jobs/offer.do?joid='+i+'" data-jobid="'+i+'" data-action="jobSelect">'+j+"</a>"},marker_mouseoverHandler:function(i){this.showInfoWindow(i,i.title)},marker_clickHandler:function(i){this.zoomMarker(i)},zoomMarker:function(i){this.map.setZoom(this.ZOOMDIRECT);this.map.setCenter(i.getPosition())},showInfoWindow:function(j,k,i){if(!this.infowindow||this.clustertype!=""){return}if(i){this.infowindow.setPosition(i);this.infowindow.open(this.map)}else{this.infowindow.open(this.map,j);k=this.getMarkerLink(k,j.joid)}this.infowindow.setContent("<div class='map_tooltip'>"+k+"</div>")},initGeoloc:function(i){if(!navigator.geolocation){return}this.myloc=new google.maps.Marker({icon:new google.maps.MarkerImage("//maps.gstatic.com/mapfiles/mobile/mobileimgs2.png",new google.maps.Size(22,22),new google.maps.Point(0,18),new google.maps.Point(11,11)),shadow:null,map:null,zIndex:999});this.$geoloc=$('<div class="geoloc xl active"></div>').appendTo(this.$view);this.$geoloc.addClass("done");this.$geoloc.on("click",$.proxy(this.geoloc_clickHandler,this))},geoloc_clickHandler:function(i){i.preventDefault();i.stopPropagation();if(!this.myloc.getMap()){this.requestGeoloc()}else{this.zoomGeoloc()}},zoomGeoloc:function(){var i=10;this.map.setZoom(i);this.map.setCenter(this.myloc.getPosition())},requestGeoloc:function(){if(!navigator.geolocation||!this.myloc||this.myloc.getMap()){return}this.$geoloc.addClass("loading");navigator.geolocation.getCurrentPosition(_.bind(this.requestGeoloc_doneHandler,this),_.bind(this.requestGeoloc_failHandler,this))},requestGeoloc_doneHandler:function(i){var k=i.coords.latitude;var j=i.coords.longitude;this.myloc.setPosition(new google.maps.LatLng(k,j));this.myloc.setMap(this.map);google.maps.event.addListener(this.myloc,"click",_.bind(this.zoomGeoloc,this));this.zoomGeoloc();this.$geoloc.removeClass("loading").addClass("active done")},requestGeoloc_failHandler:function(i){this.$geoloc.removeClass("loading").addClass("done")}});function b(){f.log("new Digital_JobsOpenMap()");this.initialize.apply(this,arguments)}$.extend(b.prototype,{initialize:function(j,i){this.uid=_.uniqueId("digital-");this.jobsapp=i;this.$view=j;this.filterLabel=this.$view.data("filter-label")||"";this.$page=this.$view.closest(".page,#head");this.$isHorizontal=$("body").hasClass("lyt-ho");this.$page.on("digital:dispose",$.proxy(this.dispose,this));this._updateMap=_.debounce(this._updateMap,20);this.loadMarkers=_.debounce(this.loadMarkers,20);this.$usercountry=this.$view.data("country")||"";this.selectedCountries=[];this.ZOOM_CTNT=1;this.ZOOM_CTRY=4;this.ZOOM_TOWNCODE=8;this.ZOOMDIRECT=16;_.each(this.jobsapp.getFilters(),function(k){this.jobsapp_filtersAddHandler(null,k)},this);this.jobsapp.$view.on("filters:add",$.proxy(this.jobsapp_filtersAddHandler,this));this.jobsapp.$view.on("filters:remove",$.proxy(this.jobsapp_filtersRemoveHandler,this));if(!this.$isHorizontal){this.mapOptions={zoom:1,minZoom:1,maxZoom:16,zoomControl:false,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',center:new L.LatLng(0,15)}}else{this.mapOptions={zoom:1,minZoom:1,maxZoom:16,zoomControl:false,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',center:new L.LatLng(0,15)}}this.map=new L.Map(this.$view.get(0),this.mapOptions);L.tileLayer(window.MAPSTILEURL,{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map);new L.Control.ZoomMin({position:"bottomleft"}).addTo(this.map);this.markers=[];this.areasCenters=a;this.map.on("moveend",_.bind(this.map_idleHandler,this))},boundsFilter:function(i){if(i!==undefined){i=!!i;if(this.__boundsFilter!==i){this.__boundsFilter=i;if(i){if(this.selectedCountries.length){_.each(this.selectedCountries,function(k){var j=k.length>2?"CTNT":"CTRY";this.jobsapp.removeFilter({type:"checkbox",id:j+"_"+k})},this)}}this.jobsapp.updateFilter("map",i,this.filterLabel,"map",this.filterTooltip)}}return!!this.__boundsFilter},map_idleHandler:function(){var q=this.map.getZoom();var j=this.map.getCenter();var i=this.map.getBounds();if((this.$isHorizontal)&&($(window).scrollTop()!=0)){window.scrollTo(0,0)}if(!i){return}var l=false;if(this.selectedCountries.length!==1&&this.map.getZoom()>this.mapOptions.zoom){this.boundsFilter(true)}else{if(this.selectedCountries.length===1){var k=this.selectedCountries[0];var m=k.length>2?this.ZOOM_CTNT:this.ZOOM_CTRY;if(m!==q){this.boundsFilter(true)}else{var o=this.map.getCenter();var p=this.getAreaCenter(k);if(!o.equals(p)){this.boundsFilter(false)}}}}if((q==this.mapOptions.zoom)){var n=this.mapOptions.center.distanceTo(j);if(n>600000){this.map.panTo(this.mapOptions.center);this.boundsFilter(false)}}this.jobsapp.$form.find("input[name=latmax]").val(i.getNorth());this.jobsapp.$form.find("input[name=lngmax]").val(i.getEast());this.jobsapp.$form.find("input[name=latmin]").val(i.getSouth());this.jobsapp.$form.find("input[name=lngmin]").val(i.getWest());if(this.boundsFilter()){this.jobsapp.loadData()}else{this.loadMarkers()}},dispose:function(){f.log("Digital_JobsOpenMap.dispose()");this.map&&this.map.remove()},getAreaCenter:function(i){var j=this.areasCenters[i];return j?new L.LatLng(j[1],j[0]):new L.LatLng(0,15)},zoomAll:function(){this.map.setZoom(this.mapOptions.zoom);this.map.panTo(this.mapOptions.center)},jobsapp_filtersAddHandler:function(l,j){var i=j.id.substr(0,4);var k=j.id.substr(5);if(i==="CTRY"||i==="CTNT"){this.selectedCountries.push(k);this.boundsFilter(false);this._updateMap()}},jobsapp_filtersRemoveHandler:function(l,j){var i=j.id.substr(0,4);var k=j.id.substr(5);if(i==="CTRY"||i==="CTNT"){this.selectedCountries=_.without(this.selectedCountries,k);this._updateMap()}},_updateMap:function(){this._updateBounds()},_updateBounds:function(){if(this.boundsFilter()){return}if(this.selectedCountries.length===1){var k=this.selectedCountries[0];var j=k.length>2?this.ZOOM_CTNT:this.ZOOM_CTRY;var i=this.getAreaCenter(k);this.map.setView(i,j)}else{f.log("this.markers:"+this.markers.length);this.map.setZoom(this.mapOptions.zoom)}},_changeBounds:function(l,m){var k=this.map.getZoom();var i=this.map.getCenter();var j=this.map.getBounds()},loadMarkers:function(){if(this._jqXHR){this._jqXHR.abort()}var i=this.jobsapp.getFormUrl();var j=this.jobsapp.getFormData({nb:10000});this._jqXHR=$.ajax({url:i,type:"POST",dataType:"json",data:j,processData:false,contentType:"application/json",context:this});this._jqXHR.done(this.loadMarkers_doneHandler);this._jqXHR.always(this.loadMarkers_alwaysHandler)},loadMarkers_doneHandler:function(n,p,m){if(this.markers){this.map.removeLayer(this.markers)}this.markers=[];this.markers=L.markerClusterGroup({spiderfyOnMaxZoom:false,showCoverageOnHover:false});var l=this.map.getBounds();if(!l){return}var j=this.map;var o,k,i;_.each(n.items,function(r){if(r.lat!=null&&r.lng!=null){var q=L.marker(new L.LatLng(r.lat,r.lng),{icon:L.divIcon({className:"orange-jobs-marker",iconAnchor:[13,13],iconSize:[26,26]}),opacity:1,title:r.title});q.bindTooltip(r.title).openTooltip();q.on("click",function(s){j.setView(q.getLatLng(),15)},q);this.markers.addLayer(q)}},this);this.map.addLayer(this.markers)},loadMarkers_alwaysHandler:function(){this._jqXHR=null},clusters_mouseoverHandler:function(k){var p=k.getMarkers();var j=k.getCenter();var i=null;var q="";var n=3;for(var m=0;m<p.length&&m<n;m++){var o=p[m];q+=this.getMarkerLink(o.title,o.joid)}this.showInfoWindow(k,q,j,p.length>n)},addMarker:function(n,l,j,o,i,m){var k=new L.Marker({position:j,icon:"../images2/map/marker.png",title:o,joid:m});this.markers.push(k)},getMarkerLink:function(j,i){return'<a href="/jobs/offer.do?joid='+i+'" data-jobid="'+i+'" data-action="jobSelect" data-target="after">'+j+"</a>"},marker_mouseoverHandler:function(i){this.showInfoWindow(i,i.title)},marker_clickHandler:function(i){this.zoomMarker(i)},zoomMarker:function(i){this.map.setZoom(this.ZOOMDIRECT);this.map.setCenter(i.getPosition())},showInfoWindow:function(j,k,i){if(!this.infowindow||this.clustertype!=""){return}if(i){this.infowindow.setPosition(i);this.infowindow.open(this.map)}else{this.infowindow.open(this.map,j);k=this.getMarkerLink(k,j.joid)}this.infowindow.setContent("<div class='map_tooltip'>"+k+"</div>")},});var a={AMERICA:[-85.78125,12.897489],AFRICA:[23.90625,0],ASIA:[83.320313,55.578345],"1EUROPE":[8.789063,46.800059],OCEANIA:[129.023438,14.264383],AW:[-70.0167,12.5167],AF:[69.1761,34.5228],AO:[13.242,-8.81155],AL:[19.8172,41.3317],AD:[1.5218,42.5075],AE:[54.3705,24.4764],AR:[-58.4173,-34.6118],AM:[44.509,40.1596],AS:[-170.691,-14.2846],AG:[-61.8456,17.1175],AU:[149.129,-35.282],AT:[16.3798,48.2201],AZ:[49.8932,40.3834],BI:[29.3639,-3.3784],BE:[4.36761,50.8371],BJ:[2.6323,6.4779],BF:[-1.53395,12.3605],BD:[90.4113,23.7055],BG:[23.3238,42.7105],BH:[50.5354,26.1921],BS:[-77.339,25.0661],BA:[18.4214,43.8607],BY:[27.5766,53.9678],BZ:[-88.7713,17.2534],BM:[-64.706,32.3293],BO:[-66.1936,-13.9908],BR:[-47.9292,-15.7801],BB:[-59.6105,13.0935],BN:[114.946,4.94199],BT:[89.6177,27.5768],BW:[25.9201,-24.6544],CF:[21.6407,5.63056],CA:[-75.6919,45.4215],CH:[7.44821,46.948],CL:[-70.6475,-33.475],CN:[116.286,40.0495],CI:[-4.0305,5.332],CM:[11.5174,3.8721],CD:[15.3222,-4.325],CG:[15.2662,-4.2767],CO:[-74.082,4.60987],KM:[43.2418,-11.6986],CV:[-23.5087,14.9218],CR:[-84.0089,9.63701],CU:[-82.3667,23.1333],KY:[-81.3857,19.3022],CY:[33.3736,35.1676],CZ:[14.4205,50.0878],DE:[13.4115,52.5235],DJ:[43.1425,11.5806],DM:[-61.39,15.2976],DK:[12.5681,55.6763],DO:[-69.8908,18.479],DZ:[3.05097,36.7397],EC:[-78.5243,-0.229498],EG:[31.2461,30.0982],ER:[38.9183,15.3315],ES:[-3.70327,40.4167],EE:[24.7586,59.4392],ET:[38.7468,9.02274],FI:[24.9525,60.1608],FJ:[178.399,-18.1149],FR:[2.35097,48.8566],FO:[-6.91181,61.8926],FM:[158.185,6.91771],GA:[9.45162,0.38832],GB:[-0.126236,51.5002],GE:[44.793,41.71],GH:[-0.20795,5.57045],GN:[-13.7,9.51667],GM:[-16.5885,13.4495],GW:[-15.1804,11.8037],GQ:[8.7741,3.7523],GR:[23.7166,37.9792],GD:[-61.7449,12.0653],GL:[-51.7214,64.1836],GT:[-90.5328,14.6248],GU:[144.794,13.4443],GY:[-58.1548,6.80461],HK:[114.109,22.3964],HN:[-87.4667,15.1333],HR:[15.9614,45.8069],HT:[-72.3288,18.5392],HU:[19.0408,47.4984],ID:[106.83,-6.19752],IM:[-4.47928,54.1509],IN:[77.225,28.6353],IE:[-6.26749,53.3441],IR:[51.4447,35.6878],IQ:[44.394,33.3302],IS:[-21.8952,64.1353],IL:[35.2035,31.7717],IT:[12.4823,41.8955],JM:[-76.792,17.9927],JO:[35.9263,31.9497],JP:[139.77,35.67],KZ:[71.4382,51.1879],KE:[36.8126,-1.27975],KG:[74.6057,42.8851],KH:[104.874,11.5556],KI:[172.979,1.32905],KN:[-62.7309,17.3],KR:[126.957,37.5323],KV:[20.926,42.565],KW:[47.9824,29.3721],LA:[102.177,18.5826],LB:[35.5134,33.8872],LR:[-10.7957,6.30039],LY:[13.1072,32.8578],LC:[-60.9832,14],LI:[9.52148,47.1411],LK:[79.8528,6.92148],LS:[27.7167,-29.5208],LT:[25.2799,54.6896],LU:[6.1296,49.61],LV:[24.1048,56.9465],MO:[113.55,22.1667],MA:[-6.8704,33.9905],MC:[7.41891,43.7325],MD:[28.8497,47.0167],MG:[45.7167,-20.4667],MV:[73.5109,4.1742],MX:[-99.1276,19.427],MH:[171.135,7.11046],MK:[21.4361,42.0024],ML:[-7.50034,13.5667],MT:[14.5189,35.9042],MM:[95.9562,21.914],ME:[19.2595,42.4602],MN:[106.937,47.9129],MP:[145.765,15.1935],MZ:[32.5713,-25.9664],MR:[-15.9824,18.2367],MU:[57.4977,-20.1605],MW:[33.7703,-13.9899],MY:[101.684,3.12433],NA:[17.0931,-22.5648],NC:[166.464,-22.2677],NE:[2.1073,13.514],NG:[7.48906,9.05804],NI:[-86.2734,12.1475],NL:[4.89095,52.3738],NO:[10.7387,59.9138],NP:[85.3157,27.6939],NZ:[174.776,-41.2865],OM:[-77.0465,-12.0931],PH:[121.035,14.5515],PW:[134.479,7.34194],PG:[147.194,-9.47357],PL:[21.02,52.26],PR:[-66,18.23],KP:[125.754,39.0319],PT:[-9.13552,38.7072],PY:[-57.6362,-25.3005],PF:[-149.57,-17.535],QA:[51.5082,25.2948],RO:[26.0979,44.4479],RU:[37.6176,55.7558],RW:[30.0587,-1.95325],SA:[46.6977,24.6748],SD:[32.5363,15.5932],SN:[-17.4734,14.7247],SG:[103.85,1.28941],SB:[159.949,-9.42676],SL:[-13.2134,8.4821],SV:[-89.2073,13.7034],SM:[12.4486,43.9322],SO:[45.3254,2.07515],RS:[20.4656,44.8024],SS:[31.6,4.85],ST:[6.6071,0.20618],SR:[-55.1679,5.8232],SK:[17.1073,48.1484],SI:[14.5044,46.0546],SE:[18.0645,59.3327],SZ:[31.4659,-26.5225],SC:[55.4466,-4.6309],SY:[36.3119,33.5146],TC:[-71.141389,21.4602778],TD:[15.0445,12.1048],TG:[1.2255,6.1228],TH:[100.521,13.7308],TJ:[68.7864,38.5878],TM:[58.3794,37.9509],TL:[125.567,-8.56667],TO:[-175.216,-21.136],TT:[-61.4789,10.6596],TN:[10.2,36.84],TR:[32.3606,39.7153],TV:[179.089567,-8.6314877],TZ:[35.7382,-6.17486],UG:[32.5729,0.314269],UA:[30.5038,50.4536],UY:[-56.0675,-34.8941],US:[-77.032,38.8895],UZ:[69.269,41.3052],VC:[-61.2653,13.2035],VE:[-69.8371,9.08165],VI:[-64.8963,18.3358],VN:[105.825,21.0069],VU:[168.321,-17.7404],WS:[-171.752,-13.8314],YE:[44.2075,15.352],ZA:[28.1871,-25.746],ZM:[28.2937,-15.3982],ZW:[31.0672,-17.8312]}})();function BkTextOnly(a){console.log("simple before s="+a);if(typeof a==="string"){return a.replace(/[^a-zA-Z0-9\u00C0-\u017F_\'\"\&\-\/\:\ ]/gi," ")}else{return""}}function BkTextOnlyDouble(b){if(typeof b==="string"){var a=b.replace(/[^a-zA-Z0-9\u00C0-\u017F_\'\"\&\-\/\:\ ]/gi," ");return a}else{return""}}(function(){$(window).on("digital:contentReady",function(b,a){$(a).find(".js-oj-chatbot").each(function(d,e){var c=new OJChatbot(e);$(e).data("chatbot",c)})})})();var OJChatbot=function(){this.init.apply(this,arguments)};OJChatbot.prototype.init=function(b){var a=this;a.$el=$(b);a.layout=a.$el.attr("data-layout");a.$footer=a.$el.find(".js-oj-chatbot__footer").first();a.$footerForm=a.$footer.find(".js-oj-chatbot__footer__form").first();a.$scroller=a.$el.find(".js-oj-chatbot__scroller").first();a.$form=a.$el.find(".js-oj-chatbot__form").first();a.$formQuestions=a.$form.find(".js-oj-chatbot__form__question");a.$formWidgets=a.$form.find(".js-oj-chatbot__form__widget");a.$inputs=a.$form.find(".js-oj-chatbot__form__question__input");a.$content=a.$el.find(".js-oj-chatbot__content").first();a.$token=$("meta[name=JOBS_TOKEN]").attr("content");a.$ends=a.$el.find(".js-oj-chatbot__ends").first();a.state={step:0,length:a.$formQuestions.length,xhr:{}};a.initEvents();if(a.layout==="chat"){a.goToCurrentStep()}else{a.generateList();a.generateWidgets();a.verifyDisabled()}};OJChatbot.prototype.initEvents=function(){var a=this;a.$el.on("click",".js-oj-chatbot__checkbox",function(b){b.preventDefault();if($(this).hasClass("js-oj-chatbot__radio")){$(this).parent().find(".is-checked").removeClass("is-checked");$(this).addClass("is-checked");a.$el.find('.js-oj-chatbot__form__question__input[name="'+$(this).attr("data-name")+'"], .js-oj-chatbot__form__widget__template__input[name="'+$(this).attr("data-name")+'"]').val($(this).attr("data-value"))}else{$(this).toggleClass("is-checked");var c=a.$el.find('.js-oj-chatbot__form__question__input[name="'+$(this).attr("data-name")+'"], .js-oj-chatbot__form__widget__template__input[name="'+$(this).attr("data-name")+'"]').find('option[value="'+$(this).attr("data-value")+'"]');c.prop("selected",!c.prop("selected"))}if($(this).hasClass("oj-chatbot__checkbox--image")){a.avatar=$(this).find("img").attr("src")}if($(this).parent().find(".is-checked").length){if(a.layout==="chat"){a.preshout("right")}a.$el.addClass("is-ready-to-send")}else{if(a.layout==="chat"){a.$content.find(".js-oj-chatbot__preshout.oj-chatbot__content__question--right").remove()}a.$el.removeClass("is-ready-to-send")}});a.$el.on("click",".js-oj-chatbot__footer__close",function(b){b.preventDefault();a.$footerForm.empty();a.$el.find(".oj-chatbot__list-element.is-active").removeClass("is-active");a.$el.removeClass("is-ready-to-send");a.$footer.hide()});a.$el.on("click",".js-oj-chatbot__submit",function(b){b.preventDefault();$.proxy(a.submit,a)()})};OJChatbot.prototype.goToCurrentStep=function(){var b=this;b.$el.removeClass("is-ready-to-send");var c=b.$formQuestions.not(".is-disabled");if(b.state.step===c.length){b.shout(b.$el.attr("data-thankyou"),"left","",function(){b.$footer.removeClass("has-submit-button");setTimeout(function(){document.location.href=b.$el.attr("data-redirect")},500)});b.scrollToBottom(300);b.$footerForm.empty();return false}var d=c.eq(b.state.step);var e=d.find(".js-oj-chatbot__form__question__input");var a=d.find(".js-oj-chatbot__form__question__label").text();b.state.$currentInput=e;b.shout(a);b.generateUi(e)};OJChatbot.prototype.shout=function(d,g,b,a){var c=this;if(c.layout==="chat"){g=g||"left";b=b?(" "+b):"";var f=1;var e=(g==="right")?c.avatar:c.$el.attr("data-admin-avatar");if(g==="left"&&b!==" js-oj-chatbot__preshout"){c.preshout();f=1000}setTimeout(function(){var h=c.$content.find(".js-oj-chatbot__preshout.oj-chatbot__content__question--"+g);if(h.length){h.removeClass("js-oj-chatbot__preshout").find(".oj-chatbot__content__question__content").html(d)}else{c.$content.append('<div class="oj-chatbot__content__question oj-chatbot__content__question--'+g+b+'"><img class="oj-chatbot__content__question__avatar" alt="avatar" src="'+e+'"/><div class="oj-chatbot__content__question__content">'+d+"</div></div>")}c.scrollToBottom();if(typeof a!=="undefined"){a()}},f)}};OJChatbot.prototype.preshout=function(b){var a=this;b=b||"left";a.$content.find(".js-oj-chatbot__preshout.oj-chatbot__content__question--"+b).remove();a.shout('<div class="oj-chatbot__content__question__dot"></div><div class="oj-chatbot__content__question__dot"></div><div class="oj-chatbot__content__question__dot"></div>',b,"js-oj-chatbot__preshout")};OJChatbot.prototype.generateUi=function(e,b){var a=this;var d="";if(e.is("select")){var c=typeof e.attr("data-images")!=="undefined";if(typeof e.attr("data-autocomplete")!=="undefined"){if(!b){a.$footer.addClass("has-submit-button")}d+='<div class="oj-chatbot__autocomplete js-oj-chatbot__autocomplete" data-url="'+e.attr("data-url")+'" data-name="'+e.attr("name")+'">';d+='<div class="oj-chatbot__autocomplete__tags js-oj-chatbot__autocomplete__tags">';e.find("option").each(function(f,g){var h=$(g);d+='<div href="#" class="oj-chatbot__autocomplete__tag js-oj-chatbot__autocomplete__tag" data-value="'+h.attr("value")+'" data-name="'+e.attr("name")+'"><span>'+h.text()+'</span><a href="#" class="oj-chatbot__autocomplete__tag__delete js-oj-chatbot__autocomplete__tag__delete">x</a></div>'});d+='<input type="text" class="oj-chatbot__autocomplete__input oj-chatbot__footer__form__input js-oj-chatbot__autocomplete__input" placeholder="'+e.attr("data-placeholder")+'"/>';d+="</div>";d+='<div class="oj-chatbot__autocomplete__dropdown js-oj-chatbot__autocomplete__dropdown">';d+="</div>";d+="</div>"}else{if(e.attr("multiple")){if(!b){a.$footer.addClass("has-submit-button")}d+='<div class="oj-chatbot__checkboxes">';e.find("option").each(function(f,g){var h=$(g);d+='<a href="#" class="oj-chatbot__checkbox js-oj-chatbot__checkbox js-oj-chatbot__checkbox'+(h.is(":selected")?" is-checked":"")+'" data-value="'+g.value+'" data-name="'+e.attr("name")+'">'+h.text()+"</a>"});d+="</div>"}else{if(!b){a.$footer.addClass("has-submit-button")}d+='<div class="oj-chatbot__checkboxes">';e.find("option").each(function(f,g){var h=$(g);var i=c?'<img src="'+h.text()+'"/>':h.text();d+='<a href="#" class="oj-chatbot__checkbox oj-chatbot__checkbox--radio js-oj-chatbot__radio js-oj-chatbot__checkbox'+(h.is(":selected")?" is-checked":"")+(c?" oj-chatbot__checkbox--image":"")+'" data-value="'+g.value+'" data-name="'+e.attr("name")+'">'+i+"</a>"});d+="</div>"}}}else{if(e.is("input")){d=e.prop("outerHTML")}}if(!b){a.$footerForm.html(d);a.$el.addClass("has-footer");a.$footerForm.find(".js-oj-chatbot__autocomplete").each(function(f,g){new OJProfileAutocomplete(g,a,e)})}else{return d}};OJChatbot.prototype.generateList=function(){var a=this;a.$formQuestions.each(function(c,e){var h=$(e).find(".js-oj-chatbot__form__question__input");var g=$('<div class="oj-chatbot__list-element js-oj-chatbot__list-element" data-name="'+h.attr("name")+'"/>');var b=h.is("select")&&typeof h.attr("data-images")!=="undefined";var f=a.generateAnswer(h);g.html('<div class="oj-chatbot__list-element__wrapper js-oj-chatbot__list-element__wrapper">'+(b?"":'<h2 class="oj-chatbot__list-element__title">'+$(e).find(".js-oj-chatbot__form__question__label").text()+"</h2>")+'<div class="oj-chatbot__list-element__value">'+f+"</div></div>");var d=a.$content.find('[data-name="'+h.attr("name")+'"]');if(d.length){d.replaceWith(g)}else{g.appendTo(a.$content)}g.on("click",".js-oj-chatbot__list-element__wrapper",function(i){if(h.is('[type="checkbox"]')){a.$footerForm.empty();a.$footer.hide();h.prop("checked",!h.prop("checked"));a.$content.find(".oj-chatbot__content__question__checkbox").toggleClass("is-active",h.is(":checked"));a.state.$currentInput=h;a.state.$currentFormElement=g;$.proxy(a.submit,a)()}else{if(g.hasClass("is-active")){a.$footerForm.empty();a.$el.find(".js-oj-chatbot__widget.has-visible-template").removeClass("has-visible-template");a.$el.find(".oj-chatbot__list-element.is-active").removeClass("is-active");a.$el.removeClass("is-ready-to-send");a.$footer.hide()}else{a.generateUi(h);g.append(a.$footer);a.$footer.css("display",(a.layout==="chat"?"flex":"block"));a.$el.find(".js-oj-chatbot__widget.has-visible-template").removeClass("has-visible-template");a.$el.find(".oj-chatbot__list-element.is-active").removeClass("is-active");a.$el.removeClass("is-ready-to-send");g.addClass("is-active");a.state.$currentInput=h;a.state.$currentFormElement=g}}})})};OJChatbot.prototype.generateWidgets=function(){var a=this;a.$formWidgets.each(function(c,d){var b=$(d).find(".js-oj-chatbot__form__widget__template");var f=$('<div class="oj-chatbot__widget js-oj-chatbot__widget" data-name="'+$(d).attr("data-name")+'"/>');var e="";b.find(".js-oj-chatbot__form__widget__template__input, label").each(function(h,g){if($(g).is("label")){e+='<div class="oj-chatbot__widget__template__content__row'+($(g).hasClass("is-half")?" oj-chatbot__widget__template__content__row--half":"")+'">';e+="<label>"+$(g).text()+"</label>"}else{e+=a.generateUi($(g),true);e+="</div>"}});f.html('<div class="oj-chatbot__widget__wrapper js-oj-chatbot__widget__wrapper"><h2 class="oj-chatbot__widget__title">'+$(d).find(".js-oj-chatbot__form__widget__label").text()+'</h2><div class="oj-chatbot__widget__value js-oj-chatbot__widget__value">'+$(d).find(".js-oj-chatbot__form__widget__items").html()+'</div><div class="oj-chatbot__widget__template js-oj-chatbot__widget__template"><a href="#" class="oj-chatbot__widget__add js-oj-chatbot__widget__add">'+$(d).attr("data-add")+'</a><form class="oj-chatbot__widget__template__content js-oj-chatbot__widget__template__content"><div style="display:none;">'+b.html()+"</div>"+e+'<a href="#" class="oj-chatbot__footer__submit js-oj-chatbot__widget__template__submit">'+$(d).attr("data-add-button")+'</a><a href="#" class="js-oj-chatbot__widget__close">'+$(d).attr("data-abort-button")+"</a></form></div></div>");f.appendTo(a.$content);f.find(".js-oj-chatbot__widget__template__content").find("select, input").each(function(h,g){$(g).data("default",$(g).val())});f.find(".js-oj-chatbot__autocomplete").each(function(g,h){new OJProfileAutocomplete(h,a,$('.js-oj-chatbot__form__widget__template__input[name="'+$(h).attr("data-name")+'"]'))});f.on("click",".js-oj-chatbot__widget__template",function(g){if(!f.hasClass("has-visible-template")){a.$el.find(".js-oj-chatbot__widget.has-visible-template").removeClass("has-visible-template");f.find(".js-oj-chatbot__widget__template__content").find("select, input").each(function(i,h){$(h).val($(h).data("default"))});f.addClass("has-visible-template");a.$footerForm.empty();a.$footer.hide();a.$el.find(".oj-chatbot__list-element.is-active").removeClass("is-active");a.$el.removeClass("is-ready-to-send");g.preventDefault()}});f.on("click",".js-oj-chatbot__widget__close",function(g){f.removeClass("has-visible-template");g.preventDefault();g.stopPropagation()});f.on("click",".js-oj-chatbot__widget__template__submit",function(i){var k=$(this);var g=k.closest(".js-oj-chatbot__widget__template__content");var j={};var h=[];j[$(d).attr("data-name")]={};g.find(".js-oj-chatbot__form__widget__template__input").each(function(m,l){j[$(d).attr("data-name")][$(l).attr("name")]=BkTextOnly($(l).val());var n="";if($(l).is("select")){n=$(l).find("option:selected").first().text()}else{n=BkTextOnly($(l).val())}if(n!==""){h.push(n)}});if(a.state.xhr[$(d).attr("data-name")]){a.state.xhr[$(d).attr("data-name")].abort()}g.find(".js-oj-chatbot__form__widget__error").remove();g.find(".is-error").removeClass("is-error");a.state.xhr[$(d).attr("data-name")]=$.ajax({url:a.$form.attr("action"),type:"POST",headers:{JOBS_TOKEN:a.$token},data:JSON.stringify(j),dataType:"json",processData:false,contentType:"application/json",success:function(l){if(l.status==="OK"){$('<div class="oj-chatbot__form__widget__item js-oj-chatbot__form__widget__item" data-id="'+l.items[0].id+'"><div class="oj-chatbot__form__widget__item__content"><span>'+h.join("</span><span>")+'</span></div><a class="oj-chatbot__form__widget__item__delete js-oj-chatbot__form__widget__item__delete" href="#">supprimer</a></div>').appendTo(f.find(".js-oj-chatbot__widget__value").first());k.closest(".js-oj-chatbot__widget").removeClass("has-visible-template")}else{$.each(l.items,function(m,n){var o=g.find('[name="'+n.field+'"], [data-name="'+n.field+'"]');if(o.length){o.addClass("is-error");$('<span class="oj-chatbot__form__widget__error js-oj-chatbot__form__widget__error">'+n.msg+"</span>").appendTo(o.prev())}})}}})});f.on("click",".js-oj-chatbot__form__widget__item__delete",function(h){var g=$(this);var j=g.closest(".js-oj-chatbot__form__widget__item");var i={};i[$(d).attr("data-name")]={id:j.attr("data-id")};if(a.state.xhr[$(d).attr("data-name")]){a.state.xhr[$(d).attr("data-name")].abort()}a.state.xhr[$(d).attr("data-name")]=$.ajax({url:a.$form.attr("action"),type:"DELETE",headers:{JOBS_TOKEN:a.$token},data:JSON.stringify(i),dataType:"json",processData:false,contentType:"application/json",success:function(k){j.remove()}})})})};OJChatbot.prototype.generateAnswer=function(f){var b=this;var c="";if(f.is("select")){var e=typeof f.attr("data-images")!=="undefined";if(f.attr("multiple")){var d=[];f.find("option:selected").each(function(g,h){var i=$(h);d.push(i.text())});c=d.join('<span class="oj-chatbot__content__question__or">'+f.attr("data-separator")+"</span>")}else{c=e?'<img src="'+f.find("option:selected").first().text()+'"/>':f.find("option:selected").first().text()}}else{if(f.is('[type="checkbox"]')){c=f.is(":checked")?'<span class="oj-chatbot__content__question__checkbox is-active"></span>':'<span class="oj-chatbot__content__question__checkbox"></span>';if(f.data("image")){c='<div class="oj-chatbot__content__question__checkbox-and-image">'+c+'<img class="oj-chatbot__content__question__image" alt="avatar"  src="'+f.data("image")+'"/></div>'}}else{if(f.is("input")){c=BkTextOnly(f.val())}}}var a=b.$el.attr("data-fillhere")!==undefined?b.$el.attr("data-fillhere"):"...";c=c===""?'<span class="oj-chatbot__list-element__value__placeholder">'+a+"</span>":c;return c};OJChatbot.prototype.submit=function(){var a=this;var e=a.state.$currentInput;var d=a.$formQuestions.not(".is-disabled").eq(a.state.step);if(!a.$el.closest(".oj-jobsapp").length){var c={};c[e.attr("name")]=e.val();if(a.state.xhr[e.attr("name")]){a.state.xhr[e.attr("name")].abort()}a.state.xhr[e.attr("name")]=$.ajax({url:a.$form.attr("action"),type:a.$form.attr("method"),headers:{JOBS_TOKEN:a.$token},data:JSON.stringify(c),dataType:"json",processData:false,contentType:"application/json"});a.verifyDisabled()}else{if(e){e.trigger("change")}a.$form.submit()}if(a.layout==="chat"){var b=a.generateAnswer(e);b=b.length?b:a.$el.attr("data-nopref");if(e.attr("name")==="avatar"){a.avatar=e.find("option:selected").first().text();b=a.$el.attr("data-hello")}a.shout(b,"right");a.state.step=d.index(".js-oj-chatbot__form__question:not(.is-disabled)")+1;a.goToCurrentStep();a.scrollToBottom(300)}else{if(typeof a.state.$currentFormElement!=="undefined"){a.state.$currentFormElement.find(".oj-chatbot__list-element__value").html(a.generateAnswer(e))}a.$el.removeClass("has-footer");a.$el.removeClass("is-ready-to-send");a.$footerForm.empty();a.$el.find(".oj-chatbot__list-element.is-active").removeClass("is-active");a.$el.removeClass("is-ready-to-send");a.$el.removeClass("is-ready-to-send");a.$footer.hide()}};OJChatbot.prototype.verifyDisabled=function(){var a=this;a.$formQuestions.filter("[data-if-name]").each(function(f,d){var b=$(d);var e=b.attr("data-if-name");var g=b.attr("data-if-value");var h=a.$form.find('.js-oj-chatbot__form__question__input[name="'+e+'"]');var c=b.find(".js-oj-chatbot__form__question__input").attr("name");if(!a.hasValue(h,g)){b.addClass("is-disabled");a.$el.find('.js-oj-chatbot__list-element[data-name="'+c+'"]').addClass("is-disabled")}else{b.removeClass("is-disabled");a.$el.find('.js-oj-chatbot__list-element[data-name="'+c+'"]').removeClass("is-disabled")}})};OJChatbot.prototype.hasValue=function(e,d){var a=e.val();var b=d.split("|");var c=false;$.each(b,function(f,g){if(Array.isArray(a)){if($.inArray(g,e.val())>-1){c=true;return false}}else{if(g===a){c=true;return false}}});return c};OJChatbot.prototype.scrollToBottom=function(b){var a=this;if(a.layout==="chat"){var c=$("body").hasClass("lyt-mo")?$("html, body"):a.$el.closest(".dgt-content");if(!b){c.scrollTop(c.get(0).scrollHeight)}else{c.animate({scrollTop:c.get(0).scrollHeight},b)}}};var KEYS={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};var OJProfileAutocomplete=function(){this.init.apply(this,arguments)};OJProfileAutocomplete.prototype.init=function(b,c,d){var a=this;a.$el=$(b);a.ojChatbot=c;a.$realnput=d;a.$parentSection=a.$el.closest(".js-oj-chatbot__section");a.$tags=a.$el.find(".js-oj-chatbot__autocomplete__tags").first();a.$input=a.$el.find(".js-oj-chatbot__autocomplete__input").first();a.$dropdown=a.$el.find(".js-oj-chatbot__autocomplete__dropdown").first();a.multiple=!!d.attr("multiple");a.state={request:null,url:a.$el.data("url"),name:a.$el.data("name"),firstTime:true,oldVal:null};a.$input.attr("size",a.$input.attr("placeholder").length);a.initEvents()};OJProfileAutocomplete.prototype.initEvents=function(){var a=this;a.$parentSection.on("ojprofilecollapse",function(){a.$input.val("");a.$dropdown.empty();a.$el.removeClass("has-open-dropdown")});a.$dropdown.on("click",".js-oj-chatbot__autocomplete__dropdown__choice",function(b){a.choose(this);if(a.multiple){a.$input.focus()}b.preventDefault()});a.$tags.on("click",".js-oj-chatbot__autocomplete__tag__delete",function(b){a.choose(this.parentNode);a.$input.focus();b.preventDefault()});a.$tags.on("ojprofilechange",".js-oj-chatbot__autocomplete__tag",function(b){a.refreshChosenSuggestions()});$(document).on("click",function(b){a.$el.removeClass("has-open-dropdown")});a.$el.on("click",function(b){b.stopPropagation()});a.$tags.on("click",function(b){a.$input.focus()});a.$input.on("focus",function(b){if(a.$dropdown.children().length){a.$el.addClass("has-open-dropdown")}});a.$input.on("keydown",function(b){if(b.keyCode===KEYS.UP||b.keyCode===KEYS.PAGE_UP){a.highlightPrevious();b.preventDefault()}else{if(b.keyCode===KEYS.DOWN||b.keyCode===KEYS.TAB||b.keyCode===KEYS.PAGE_DOWN){a.highlightNext();b.preventDefault()}else{if(b.keyCode===KEYS.ENTER){a.chooseHighlighted();b.preventDefault()}else{if(b.keyCode===KEYS.ESC){a.$input.val("");a.$dropdown.empty();b.preventDefault()}}}}}).on("keyup change focus",function(c){var b=a.getSanitizedValue();a.query(b);if(!a.multiple){a.$realnput.empty();a.$realnput.append('<option value="'+b+'" selected>'+b+"</option>")}})};OJProfileAutocomplete.prototype.getSanitizedValue=function(){var a=this;return BkTextOnlyDouble(a.$input.val())};OJProfileAutocomplete.prototype.highlight=function(b){var a=this;a.$dropdown.find(".is-highlighted").removeClass("is-highlighted");$(b).addClass("is-highlighted")};OJProfileAutocomplete.prototype.highlightPrevious=function(){var c=this;var a=c.$dropdown.find(".is-highlighted"),b=a.prev();c.highlight(b.length?b.get(0):c.$dropdown.children(".js-oj-chatbot__autocomplete__dropdown__choice").first().get(0))};OJProfileAutocomplete.prototype.highlightNext=function(){var c=this;var a=c.$dropdown.find(".is-highlighted"),b=a.next();c.highlight(b.length?b.get(0):c.$dropdown.children(".js-oj-chatbot__autocomplete__dropdown__choice").first().get(0))};OJProfileAutocomplete.prototype.chooseHighlighted=function(){var b=this;var a=b.$dropdown.find(".is-highlighted");if(a.length){b.choose(a.get(0))}};OJProfileAutocomplete.prototype.query=function(c){var a=this;if(a.state.oldVal!==null&&a.state.oldVal===c){return false}a.state.oldVal=c;if(a.stopRequests){a.stopRequests=false;a.$el.removeClass("has-open-dropdown");return false}if(a.state.request!==null){a.state.request.abort()}var b={fulltext:c,nb:10};a.$dropdown.empty();if(c.length){a.$dropdown.html('<a href="#" class="oj-chatbot__autocomplete__dropdown__choice js-oj-chatbot__autocomplete__dropdown__choice" data-value="'+c+'" data-name="'+a.state.name+'">'+c+"</a>")}a.state.request=$.get(a.state.url,b,function(d){if(d.status==="OK"){suggestions="";$.each(d.items,function(f,e){suggestions+='<a href="#" class="oj-chatbot__autocomplete__dropdown__choice js-oj-chatbot__autocomplete__dropdown__choice" data-value="'+e.id+'" data-name="'+a.state.name+'">'+e.value+"</a>"});a.$el.addClass("has-open-dropdown");a.$dropdown.append(suggestions);a.refreshChosenSuggestions();a.highlight(a.$dropdown.children(".js-oj-chatbot__autocomplete__dropdown__choice").first().get(0));if(a.state.firstTime){a.ojChatbot.scrollToBottom();a.state.firstTime=false}}})};OJProfileAutocomplete.prototype.choose=function(c){var b=this;var a=c?{text:$(c).text(),value:$(c).data("value")}:{text:b.getSanitizedValue(),value:b.getSanitizedValue()};if(!b.addedOneAlready){b.ojChatbot.shout(b.ojChatbot.$el.attr("data-moretags"));b.addedOneAlready=true}if(b.multiple&&b.$realnput.find("option[value='"+a.value.toString().replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1")+"']").length){b.$realnput.find("option[value='"+a.value.toString().replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1")+"']").remove();if(b.$tags.find("[data-value='"+a.value.toString().replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1")+"']").length){b.$tags.find("[data-value='"+a.value.toString().replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1")+"']").remove()}}else{if(b.multiple){$('<div href="#" class="oj-chatbot__autocomplete__tag js-oj-chatbot__autocomplete__tag" data-value="'+a.value+'" data-name="'+b.state.name+'"><span>'+a.text+'</span><a href="#" class="oj-chatbot__autocomplete__tag__delete js-oj-chatbot__autocomplete__tag__delete">x</a></div>').insertBefore(b.$input)}else{b.$realnput.empty();b.stopRequests=true;b.$input.val(a.text)}b.$realnput.append('<option value="'+a.value+'" selected>'+a.text+"</option>");b.ojChatbot.$el.addClass("is-ready-to-send")}b.refreshChosenSuggestions();b.ojChatbot.scrollToBottom(300);if(b.multiple){b.$input.val("");b.query("");b.$input.focus()}else{b.$el.removeClass("has-open-dropdown");b.$input.blur()}};OJProfileAutocomplete.prototype.refreshChosenSuggestions=function(){var b=this;b.$dropdown.find(".is-selected").removeClass("is-selected");if(b.multiple){b.$tags.find(".js-oj-chatbot__autocomplete__tag").each(function(f,d){var e=$(d);var g=e.attr("data-value").replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1");b.$dropdown.find("[data-value='"+g+"']").addClass("is-selected")})}else{var a=b.$realnput.find("option");if(a.length){var c=a.first().attr("value").replace(/([ #;&,.+*~\':"!^$[\]()=>|\/@])/g,"\\$1");b.$dropdown.find("[data-value='"+c+"']").addClass("is-selected")}}};